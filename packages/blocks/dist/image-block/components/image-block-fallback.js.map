{"version":3,"file":"image-block-fallback.js","sourceRoot":"","sources":["../../../src/image-block/components/image-block-fallback.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,OAAO,EAAE,aAAa,EAAE,MAAM,iCAAiC,CAAC;AAChE,OAAO,EACL,YAAY,EACZ,iBAAiB,EACjB,cAAc,GACf,MAAM,uBAAuB,CAAC;AAC/B,OAAO,EAAE,OAAO,EAAE,MAAM,cAAc,CAAC;AACvC,OAAO,EAAE,GAAG,EAAE,IAAI,EAAE,MAAM,KAAK,CAAC;AAChC,OAAO,EAAE,aAAa,EAAE,QAAQ,EAAE,MAAM,mBAAmB,CAAC;AAC5D,OAAO,EAAE,QAAQ,EAAE,MAAM,6BAA6B,CAAC;AAEvD,OAAO,EAAE,eAAe,EAAE,SAAS,EAAE,WAAW,EAAE,MAAM,cAAc,CAAC;AAEvE,MAAM,CAAC,MAAM,wBAAwB,GAAG,GAAG,CAAC;AAC5C,MAAM,CAAC,MAAM,yBAAyB,GAAG,GAAG,CAAC;AAC7C,MAAM,CAAC,MAAM,qBAAqB,GAAG,GAAG,CAAC;AACzC,MAAM,CAAC,MAAM,sBAAsB,GAAG,EAAE,CAAC;IAG5B,sBAAsB;4BADlC,aAAa,CAAC,4BAA4B,CAAC;;;;sBACA,cAAc,CAAC,iBAAiB,CAAC;;;;;;;;;;;;;sCAAzC,SAAQ,WAAiC;;;;iCAsG1E,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;mCAG9B,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;gCAG9B,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;iCAG9B,OAAO,CAAC,EAAE,OAAO,EAAE,YAAY,EAAE,CAAC;YARnC,oKAAS,KAAK,6BAAL,KAAK,qFAAW;YAGzB,0KAAS,OAAO,6BAAP,OAAO,yFAAW;YAG3B,iKAAS,IAAI,6BAAJ,IAAI,mFAAuB;YAGpC,oKAAS,KAAK,6BAAL,KAAK,qFAAmB;YAhHnC,6KAiHC;;;;iBAhHiB,WAAM,GAAG,GAAG,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GA4C3B,AA5CqB,CA4CpB;QAEO,MAAM;YACb,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,IAAI,CAAC;YAE7C,MAAM,UAAU,GAAG,IAAI,KAAK,UAAU,CAAC;YACvC,MAAM,KAAK,GAAG,UAAU;gBACtB,CAAC,CAAC,GAAG,wBAAwB,IAAI;gBACjC,CAAC,CAAC,GAAG,qBAAqB,IAAI,CAAC;YACjC,MAAM,MAAM,GAAG,UAAU;gBACvB,CAAC,CAAC,GAAG,yBAAyB,IAAI;gBAClC,CAAC,CAAC,GAAG,sBAAsB,IAAI,CAAC;YAElC,MAAM,MAAM,GAAG,UAAU,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;YAE7C,MAAM,YAAY,GAAG,QAAQ,CAAC;gBAC5B,SAAS,EAAE,UAAU,MAAM,MAAM;gBACjC,eAAe,EAAE,QAAQ;gBACzB,KAAK;gBACL,MAAM;aACP,CAAC,CAAC;YAEH,MAAM,SAAS,GAAG,OAAO;gBACvB,CAAC,CAAC,WAAW;gBACb,CAAC,CAAC,KAAK;oBACL,CAAC,CAAC,eAAe;oBACjB,CAAC,CAAC,SAAS,CAAC;YAEhB,MAAM,SAAS,GAAG,OAAO;gBACvB,CAAC,CAAC,kBAAkB;gBACpB,CAAC,CAAC,KAAK;oBACL,CAAC,CAAC,uBAAuB;oBACzB,CAAC,CAAC,OAAO,CAAC;YAEd,MAAM,IAAI,GACR,CAAC,CAAC,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC,IAAI,GAAG,CAAC;gBAC5B,CAAC,CAAC,aAAa,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;gBACpC,CAAC,CAAC,IAAI,CAAC;YAEX,OAAO,IAAI,CAAA;;;;kBAIG,YAAY;;;cAGhB,SAAS;;iBAEN,SAAS;;;gDAGsB,IAAI;;;KAG/C,CAAC;QACJ,CAAC;QAGD,+EAAyB;QAAzB,IAAS,KAAK,2CAAW;QAAzB,IAAS,KAAK,iDAAW;QAGzB,wIAA2B;QAA3B,IAAS,OAAO,6CAAW;QAA3B,IAAS,OAAO,mDAAW;QAG3B,oIAAoC;QAApC,IAAS,IAAI,0CAAuB;QAApC,IAAS,IAAI,gDAAuB;QAGpC,mIAAiC;QAAjC,IAAS,KAAK,2CAAmB;QAAjC,IAAS,KAAK,iDAAmB;;;;;;YAhHtB,uDAAsB;;;;;SAAtB,sBAAsB","sourcesContent":["import type { ImageBlockModel } from '@lumensuite/affine-model';\n\nimport { humanFileSize } from '@lumensuite/affine-shared/utils';\nimport {\n  modelContext,\n  ShadowlessElement,\n  WithDisposable,\n} from '@lumensuite/block-std';\nimport { consume } from '@lit/context';\nimport { css, html } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\nimport { styleMap } from 'lit/directives/style-map.js';\n\nimport { FailedImageIcon, ImageIcon, LoadingIcon } from '../styles.js';\n\nexport const SURFACE_IMAGE_CARD_WIDTH = 220;\nexport const SURFACE_IMAGE_CARD_HEIGHT = 122;\nexport const NOTE_IMAGE_CARD_WIDTH = 752;\nexport const NOTE_IMAGE_CARD_HEIGHT = 78;\n\n@customElement('affine-image-fallback-card')\nexport class ImageBlockFallbackCard extends WithDisposable(ShadowlessElement) {\n  static override styles = css`\n    .affine-image-fallback-card-container {\n      width: 100%;\n      height: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n\n    .affine-image-fallback-card {\n      display: flex;\n      flex-direction: column;\n      justify-content: space-between;\n      background-color: var(--affine-background-secondary-color, #f4f4f5);\n      border-radius: 8px;\n      border: 1px solid var(--affine-background-tertiary-color, #eee);\n      padding: 12px;\n    }\n\n    .affine-image-fallback-card-content {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      color: var(--affine-placeholder-color);\n      text-align: justify;\n      font-family: var(--affine-font-family);\n      font-size: var(--affine-font-sm);\n      font-style: normal;\n      font-weight: 600;\n      line-height: var(--affine-line-height);\n      user-select: none;\n    }\n\n    .affine-image-card-size {\n      overflow: hidden;\n      padding-top: 12px;\n      color: var(--affine-text-secondary-color);\n      text-overflow: ellipsis;\n      font-size: 10px;\n      font-style: normal;\n      font-weight: 400;\n      line-height: 20px;\n      user-select: none;\n    }\n  `;\n\n  override render() {\n    const { mode, loading, error, model } = this;\n\n    const isEdgeless = mode === 'edgeless';\n    const width = isEdgeless\n      ? `${SURFACE_IMAGE_CARD_WIDTH}px`\n      : `${NOTE_IMAGE_CARD_WIDTH}px`;\n    const height = isEdgeless\n      ? `${SURFACE_IMAGE_CARD_HEIGHT}px`\n      : `${NOTE_IMAGE_CARD_HEIGHT}px`;\n\n    const rotate = isEdgeless ? model.rotate : 0;\n\n    const cardStyleMap = styleMap({\n      transform: `rotate(${rotate}deg)`,\n      transformOrigin: 'center',\n      width,\n      height,\n    });\n\n    const titleIcon = loading\n      ? LoadingIcon\n      : error\n        ? FailedImageIcon\n        : ImageIcon;\n\n    const titleText = loading\n      ? 'Loading image...'\n      : error\n        ? 'Image loading failed.'\n        : 'Image';\n\n    const size =\n      !!model.size && model.size > 0\n        ? humanFileSize(model.size, true, 0)\n        : null;\n\n    return html`\n      <div class=\"affine-image-fallback-card-container\">\n        <div\n          class=\"affine-image-fallback-card drag-target\"\n          style=${cardStyleMap}\n        >\n          <div class=\"affine-image-fallback-card-content\">\n            ${titleIcon}\n            <span class=\"affine-image-fallback-card-title-text\"\n              >${titleText}</span\n            >\n          </div>\n          <div class=\"affine-image-card-size\">${size}</div>\n        </div>\n      </div>\n    `;\n  }\n\n  @property({ attribute: false })\n  accessor error!: boolean;\n\n  @property({ attribute: false })\n  accessor loading!: boolean;\n\n  @property({ attribute: false })\n  accessor mode!: 'page' | 'edgeless';\n\n  @consume({ context: modelContext })\n  accessor model!: ImageBlockModel;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'affine-image-fallback-card': ImageBlockFallbackCard;\n  }\n}\n"]}