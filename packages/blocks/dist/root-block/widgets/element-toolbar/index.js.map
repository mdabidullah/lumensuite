{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../src/root-block/widgets/element-toolbar/index.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqBA,OAAO,EAAE,WAAW,EAAE,MAAM,kCAAkC,CAAC;AAC/D,OAAO,EAAE,uBAAuB,EAAE,MAAM,qCAAqC,CAAC;AAC9E,OAAO,EACL,WAAW,EAEX,sBAAsB,GACvB,MAAM,uCAAuC,CAAC;AAC/C,OAAO,EACL,aAAa,EACb,iBAAiB,EACjB,iBAAiB,GAClB,MAAM,0BAA0B,CAAC;AAClC,OAAO,EAAE,aAAa,EAAE,MAAM,iCAAiC,CAAC;AAChE,OAAO,EAAE,qBAAqB,EAAE,MAAM,iCAAiC,CAAC;AACxE,OAAO,EAAE,eAAe,EAAE,MAAM,uBAAuB,CAAC;AACxD,OAAO,EAAE,eAAe,EAAE,OAAO,EAAE,UAAU,EAAE,MAAM,0BAA0B,CAAC;AAChF,OAAO,EAAE,GAAG,EAAE,IAAI,EAAE,OAAO,EAAuB,MAAM,KAAK,CAAC;AAC9D,OAAO,EAAE,aAAa,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,mBAAmB,CAAC;AACnE,OAAO,EAAE,IAAI,EAAE,MAAM,wBAAwB,CAAC;AAM9C,OAAO,EAAE,iBAAiB,EAAE,MAAM,0BAA0B,CAAC;AAC7D,OAAO,EAAE,qBAAqB,EAAE,MAAM,qCAAqC,CAAC;AAC5E,OAAO,EACL,iBAAiB,EACjB,eAAe,EACf,mBAAmB,EACnB,eAAe,EACf,YAAY,EACZ,YAAY,EACZ,WAAW,GACZ,MAAM,+BAA+B,CAAC;AACvC,OAAO,EAAE,oBAAoB,EAAE,MAAM,uBAAuB,CAAC;AAC7D,OAAO,EAAE,oBAAoB,EAAE,MAAM,uBAAuB,CAAC;AAC7D,OAAO,EAAE,iBAAiB,EAAE,MAAM,mBAAmB,CAAC;AACtD,OAAO,EAAE,sBAAsB,EAAE,MAAM,+BAA+B,CAAC;AACvE,OAAO,EAAE,uBAAuB,EAAE,MAAM,0BAA0B,CAAC;AACnE,OAAO,EAAE,qBAAqB,EAAE,MAAM,8BAA8B,CAAC;AACrE,OAAO,EAAE,8BAA8B,EAAE,MAAM,kCAAkC,CAAC;AAClF,OAAO,EAAE,iBAAiB,EAAE,MAAM,+BAA+B,CAAC;AAClE,OAAO,EAAE,iBAAiB,EAAE,MAAM,0BAA0B,CAAC;AAC7D,OAAO,EAAE,iBAAiB,EAAE,MAAM,0BAA0B,CAAC;AAC7D,OAAO,EAAE,uBAAuB,EAAE,MAAM,0BAA0B,CAAC;AACnE,OAAO,EAAE,mBAAmB,EAAE,MAAM,4BAA4B,CAAC;AACjE,OAAO,EAAE,gBAAgB,EAAE,MAAM,yBAAyB,CAAC;AAC3D,OAAO,EAAE,uBAAuB,EAAE,MAAM,0BAA0B,CAAC;AACnE,OAAO,EAAE,sBAAsB,EAAE,MAAM,yBAAyB,CAAC;AACjE,OAAO,uBAAuB,CAAC;AAC/B,OAAO,EAAE,eAAe,EAAE,MAAM,uBAAuB,CAAC;AACxD,OAAO,EAAE,4BAA4B,EAAE,MAAM,gCAAgC,CAAC;AA6B9E,MAAM,CAAC,MAAM,+BAA+B,GAC1C,iCAAiC,CAAC;IAGvB,4BAA4B;4BADxC,aAAa,CAAC,+BAA+B,CAAC;;;;sBACG,eAAe;;;;;;;;;;;;;;;;4CAAvB,SAAQ,WAGjD;;;;qCAqUE,KAAK,EAAE;8CAGP,KAAK,EAAE;4CAMP,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;uCAG9B,KAAK,CAAC;oBACL,UAAU,EAAE,CAAC,KAAe,EAAE,QAAkB,EAAE,EAAE;wBAClD,IAAI,KAAK,CAAC,MAAM,KAAK,QAAQ,EAAE,MAAM,EAAE,CAAC;4BACtC,OAAO,IAAI,CAAC;wBACd,CAAC;wBAED,OAAO,KAAK,CAAC,IAAI,CAAC,CAAC,EAAE,EAAE,KAAK,EAAE,EAAE,CAAC,EAAE,KAAK,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;oBAC3D,CAAC;iBACF,CAAC;0CAGD,KAAK,EAAE;YAtBR,gLAAiB,SAAS,6BAAT,SAAS,6FAAS;YAGnC,2MAAiB,kBAAkB,6BAAlB,kBAAkB,+GAG1B;YAGT,qMAAS,gBAAgB,6BAAhB,gBAAgB,2GAAW;YAWpC,sLAAS,WAAW,6BAAX,WAAW,iGAAgB;YAGpC,+LAAS,cAAc,6BAAd,cAAc,uGAAS;YAhWlC,6KAiWC;;;;iBA7ViB,WAAM,GAAG,GAAG,CAAA;;;;;;;;;GAS3B,AATqB,CASpB;QAoCF,IAAI,QAAQ;YACV,OAAO,IAAI,CAAC,KAAmC,CAAC;QAClD,CAAC;QAED,IAAI,SAAS;YACX,OAAO,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,SAAS,CAAC;QACzC,CAAC;QAED,IAAI,KAAK;YACP,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC;QAC7B,CAAC;QAED,IAAI,OAAO;YACT,OAAO,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC;QAC/B,CAAC;QAEO,cAAc;YACpB,MAAM,MAAM,GAAG,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC,gBAAgB,EAAE,KAAK,CAAC,EAAE;gBAC9D,IAAI,WAAW,CAAC,KAAK,CAAC,EAAE,CAAC;oBACvB,OAAO,MAAM,CAAC;gBAChB,CAAC;qBAAM,IAAI,YAAY,CAAC,KAAK,CAAC,EAAE,CAAC;oBAC/B,OAAO,OAAO,CAAC;gBACjB,CAAC;qBAAM,IAAI,YAAY,CAAC,KAAK,CAAC,EAAE,CAAC;oBAC/B,OAAO,OAAO,CAAC;gBACjB,CAAC;qBAAM,IAAI,iBAAiB,CAAC,KAAK,CAAC,EAAE,CAAC;oBACpC,OAAO,YAAY,CAAC;gBACtB,CAAC;qBAAM,IAAI,eAAe,CAAC,KAAK,CAAC,IAAI,eAAe,CAAC,KAAK,CAAC,EAAE,CAAC;oBAC5D,OAAO,WAAW,CAAC;gBACrB,CAAC;qBAAM,IAAI,mBAAmB,CAAC,KAAK,CAAC,EAAE,CAAC;oBACtC,OAAO,cAAc,CAAC;gBACxB,CAAC;gBAED,OAAQ,KAAwC,CAAC,IAAI,CAAC;YACxD,CAAC,CAAC,CAAC;YACH,OAAO,MAA6B,CAAC;QACvC,CAAC;QAEO,oBAAoB;YAC1B,MAAM,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC;YACtD,MAAM,QAAQ,GAAG,SAAS,CAAC,gBAAgB,CAAC;YAE5C,IAAI,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;gBAC1B,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,sBAAsB,CAAC;gBAC9C,OAAO;YACT,CAAC;YAED,MAAM,KAAK,GAAG,qBAAqB,CAAC,QAAQ,CAAC,CAAC;YAE9C,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,QAAQ,CAAC;YACnC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,QAAQ,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;YAEtD,IAAI,IAAI,GAAG,CAAC,CAAC;YACb,IAAI,GAAG,GAAG,CAAC,CAAC;YAEZ,IAAI,MAAM,GAAG,EAAE,GAAG,EAAE,CAAC;YACrB,sBAAsB;YACtB,IAAI,QAAQ,GAAG,KAAK,CAAC;YACrB,IAAI,QAAQ,GAAG,KAAK,CAAC;YACrB,IACE,CAAC,QAAQ,GAAG,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC,CAAC;gBACpD,CAAC,QAAQ,GAAG,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,YAAY,iBAAiB,CAAC,CAAC,EACnE,CAAC;gBACD,MAAM,IAAI,EAAE,GAAG,CAAC,CAAC;gBACjB,IAAI,QAAQ,EAAE,CAAC;oBACb,MAAM,IAAI,CAAC,CAAC;gBACd,CAAC;YACH,CAAC;iBAAM,IACL,QAAQ,CAAC,MAAM,KAAK,CAAC;gBACrB,QAAQ,CAAC,CAAC,CAAC,YAAY,iBAAiB,EACxC,CAAC;gBACD,MAAM,IAAI,EAAE,GAAG,CAAC,CAAC;YACnB,CAAC;YAED,GAAG,GAAG,CAAC,GAAG,MAAM,CAAC;YACjB,IAAI,GAAG,GAAG,CAAC,EAAE,CAAC;gBACZ,GAAG,GAAG,CAAC,GAAG,KAAK,CAAC,CAAC,GAAG,QAAQ,CAAC,IAAI,GAAG,MAAM,GAAG,EAAE,CAAC;gBAChD,IAAI,QAAQ,IAAI,QAAQ,EAAE,CAAC;oBACzB,GAAG,IAAI,EAAE,GAAG,CAAC,CAAC;oBACd,IAAI,QAAQ,EAAE,CAAC;wBACb,GAAG,IAAI,CAAC,CAAC;oBACX,CAAC;gBACH,CAAC;YACH,CAAC;YAED,qBAAqB,CAAC,GAAG,EAAE;gBACzB,MAAM,IAAI,GAAG,IAAI,CAAC,qBAAqB,EAAE,CAAC;gBAE1C,IAAI,GAAG,WAAW,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,EAAE,KAAK,GAAG,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC,CAAC;gBACzD,GAAG,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,EAAE,EAAE,EAAE,MAAM,GAAG,IAAI,CAAC,MAAM,GAAG,GAAG,CAAC,CAAC;gBAE7D,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,eAAe,IAAI,OAAO,GAAG,QAAQ,CAAC;YAC/D,CAAC,EAAE,IAAI,CAAC,CAAC;QACX,CAAC;QAEO,yBAAyB;YAC/B,OAAO;gBACL,IAAI,CAAA;;;qBAGW,gBAAgB;wBACb,YAAY;mBACjB,IAAI,CAAC,aAAa;;YAEzB,uBAAuB;;OAE5B;aACF,CAAC;QACJ,CAAC;QAEkB,YAAY;YAC7B,MAAM,EAAE,YAAY,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC;YAExC,IAAI,CAAC,UAAU,GAAG,iBAAiB,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAEzE,YAAY,CAAC,GAAG,CACd,QAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,eAAe,CAAC,EAAE,CAAC,GAAG,EAAE;gBAChD,IAAI,CAAC,oBAAoB,EAAE,CAAC;YAC9B,CAAC,CAAC,CACH,CAAC;YAEF,YAAY,CAAC,GAAG,CACd,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,CAAC,GAAG,EAAE;gBACnC,IACE,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,MAAM,KAAK,CAAC;oBACvC,IAAI,CAAC,SAAS,CAAC,OAAO;oBACtB,IAAI,CAAC,SAAS,CAAC,UAAU,EACzB,CAAC;oBACD,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;gBAC9B,CAAC;qBAAM,CAAC;oBACN,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;oBAC9C,IAAI,CAAC,oBAAoB,EAAE,CAAC;oBAC5B,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;gBAC7B,CAAC;YACH,CAAC,CAAC,CACH,CAAC;YAEF,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,OAAO,EAAE;gBACxC,cAAc;gBACd,gBAAgB;aACjB,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAC,CAAC,CAAC;YAE5E,YAAY,CAAC,GAAG,CACd,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,YAAY,CAAC,EAAE,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAC7D,CAAC;YAEF,YAAY,CAAC,GAAG,CACd,QAAQ,CAAC,UAAU,CAAC,GAAG,CAAC,WAAW,EAAE,GAAG,EAAE;gBACxC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YACxB,CAAC,CAAC,CACH,CAAC;YACF,YAAY,CAAC,GAAG,CACd,QAAQ,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,EAAE,GAAG,EAAE;gBACtC,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;gBACvB,IAAI,CAAC,oBAAoB,EAAE,CAAC;YAC9B,CAAC,CAAC,CACH,CAAC;YAEF,YAAY,CAAC,GAAG,CACd,QAAQ,CAAC,KAAK,CAAC,kBAAkB,CAAC,EAAE,CAAC,GAAG,EAAE;gBACxC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YACxB,CAAC,CAAC,CACH,CAAC;YACF,YAAY,CAAC,GAAG,CACd,QAAQ,CAAC,KAAK,CAAC,gBAAgB,CAAC,EAAE,CAAC,GAAG,EAAE;gBACtC,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;gBACvB,IAAI,CAAC,oBAAoB,EAAE,CAAC;YAC9B,CAAC,CAAC,CACH,CAAC;YAEF,YAAY,CAAC,GAAG,CACd,QAAQ,CAAC,KAAK,CAAC,eAAe,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,CAC9D,CAAC;YAEF,IAAI,CAAC,cAAc;iBAChB,IAAI,CAAC,GAAG,EAAE;gBACT,YAAY,CAAC,GAAG,CAAC,aAAa,CAAC,SAAS,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC;YACxE,CAAC,CAAC;iBACD,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;QAC1B,CAAC;QAED,aAAa,CAAC,KAAkB;YAC9B,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACtC,CAAC;QAEQ,MAAM;YACb,IAAI,IAAI,CAAC,GAAG,CAAC,QAAQ,IAAI,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC;gBAChE,OAAO,OAAO,CAAC;YACjB,CAAC;YAED,MAAM,eAAe,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;YAC9C,MAAM,EAAE,QAAQ,EAAE,SAAS,EAAE,GAAG,IAAI,CAAC;YACrC,MAAM,EACJ,KAAK,EACL,KAAK,EACL,SAAS,EACT,IAAI,EACJ,IAAI,EACJ,KAAK,EACL,KAAK,EACL,SAAS,EACT,UAAU,EACV,KAAK,EACL,YAAY,EACZ,OAAO,EAAE,QAAQ,GAClB,GAAG,eAAe,CAAC;YACpB,MAAM,EAAE,gBAAgB,EAAE,GAAG,IAAI,CAAC,SAAS,CAAC;YAC5C,MAAM,uBAAuB,GAAG,eAAe,CAC7C,MAAM,CAAC,MAAM,CAAC,eAAe,CAAC,EAC9B,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,EACf,CAAC,CACF,CAAC;YAEF,MAAM,kBAAkB,GACtB,gBAAgB,CAAC,MAAM,KAAK,CAAC,IAAI,CAAC,SAAS,EAAE,MAAM;gBACjD,CAAC,CAAC,IAAI,CAAC,yBAAyB,EAAE;gBAClC,CAAC,CAAC,SAAS,CAAC;YAEhB,MAAM,cAAc,GAClB,gBAAgB,CAAC,MAAM,KAAK,SAAS,EAAE,MAAM;gBAC3C,CAAC,CAAC;oBACE,oBAAoB,CAAC,QAAQ,EAAE,gBAAgB,CAAC;oBAChD,oBAAoB,CAAC,QAAQ,EAAE,gBAAgB,CAAC;oBAChD,iBAAiB,CAAC,QAAQ,EAAE,gBAAgB,CAAC;iBAC9C;gBACH,CAAC,CAAC,EAAE,CAAC;YAET,MAAM,OAAO,GAAgC,uBAAuB;gBAClE,CAAC,CAAC,cAAc;gBAChB,CAAC,CAAC;oBACE,GAAG,cAAc;oBACjB,mBAAmB,CAAC,QAAQ,EAAE,QAAQ,CAAC;oBACvC,mBAAmB,CAAC,QAAQ,EAAE,KAAK,CAAC;oBACpC,uBAAuB,CAAC,QAAQ,EAAE,KAAK,CAAC;oBACxC,uBAAuB,CAAC,QAAQ,EAAE,KAAK,CAAC;oBACxC,qBAAqB,CAAC,QAAQ,EAAE,SAAS,CAAC;oBAC1C,gBAAgB,CAAC,QAAQ,EAAE,IAAI,EAAE,kBAAkB,CAAC;oBACpD,sBAAsB,CAAC,QAAQ,EAAE,IAAI,CAAC;oBACtC,8BAA8B,CAAC,QAAQ,EAAE,YAAY,CAAC;oBACtD,iBAAiB,CAAC,QAAQ,EAAE,KAAK,CAAC;oBAClC,iBAAiB,CAAC,QAAQ,EAAE,KAAK,CAAC;oBAClC,iBAAiB,CAAC,QAAQ,EAAE,SAAS,EAAE,kBAAkB,CAAC;oBAC1D,sBAAsB,CAAC,QAAQ,EAAE,UAAU,CAAC;oBAC5C,uBAAuB,CAAC,QAAQ,EAAE,KAAK,CAAC;iBACzC,CAAC;YAEN,IAAI,gBAAgB,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;gBAClC,IAAI,SAAS,CAAC,YAAY,CAAC,KAAK,YAAY,iBAAiB,EAAE,CAAC;oBAC9D,OAAO,CAAC,OAAO,CAAC,4BAA4B,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;gBAC/D,CAAC;gBAED,IAAI,CAAC,SAAS,EAAE,MAAM,EAAE,CAAC;oBACvB,OAAO,CAAC,IAAI,CAAC,kBAAkB,EAAE,GAAG,EAAE,IAAI,OAAO,CAAC,CAAC;gBACrD,CAAC;YACH,CAAC;YAED,IAAI,CAAC,kBAAkB;iBACpB,MAAM,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;iBAC7C,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;iBACzC,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,IAAI,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC;YAErD,OAAO,CAAC,IAAI,CAAC,IAAI,CAAA;;oBAED,gBAAgB;oBAChB,QAAQ;kBACV,IAAI,CAAC,UAAU;oBACb,IAAI;;KAEnB,CAAC,CAAC;YAEH,OAAO,IAAI,CAAA;;UAEL,IAAI,CACJ,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,OAAO,CAAC,EAClC,sBAAsB,CACvB;;KAEJ,CAAC;QACJ,CAAC;QAGD,4BAAmC;QAAnC,IAAiB,SAAS,+CAAS;QAAnC,IAAiB,SAAS,qDAAS;QAGnC,qCAGS;QAHT,IAAiB,kBAAkB,wDAG1B;QAHT,IAAiB,kBAAkB,8DAG1B;QAGT,mCAAoC;QAApC,IAAS,gBAAgB,sDAAW;QAApC,IAAS,gBAAgB,4DAAW;QAWpC,8BAAoC;QAApC,IAAS,WAAW,iDAAgB;QAApC,IAAS,WAAW,uDAAgB;QAGpC,iCAAgC;QAAhC,IAAS,cAAc,oDAAS;QAAhC,IAAS,cAAc,0DAAS;;;YAjVxB,kBAAa,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,EAAc,EAAE,EAAE;gBAC/C,MAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC;gBACnD,MAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,0BAA0B,CAAC;oBACtE,CAAC;oBACD,CAAC;iBACF,CAAC,CAAC;gBACH,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,WAAW,EAAE,CAAC;gBAChC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,eAAe,CAAC;oBAClC,IAAI,EAAE,WAAW;oBACjB,IAAI,EAAE,aAAa,CAAC,KAAK;iBAC1B,CAAC,CAAC;gBAEH,MAAM,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,WAAW,CACzC,WAAW,CACe,CAAC;gBAC7B,GAAG,CAAC,YAAY,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;YACnC,CAAC,CAAC;YAEM,4BAAuB,GAAG,CAAC,OAAgC,EAAE,EAAE;gBACrE,MAAM,EAAE,GAAG,OAAO,OAAO,KAAK,QAAQ,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC;gBAE9D,IAAI,IAAI,CAAC,WAAW,IAAI,CAAC,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC;oBAClE,IAAI,CAAC,oBAAoB,EAAE,CAAC;oBAC5B,IAAI,CAAC,aAAa,EAAE,CAAC;gBACvB,CAAC;YACH,CAAC,CAAC;YAEF;;;eAGG;YACH,eAAU,GACR,WAAW,CAAC,eAAe,CAAC,CAAC;YA0Rd,oFAAY,KAAK,EAAC;YAGlB,8JAGX,EAAE,GAAC;YAGA,4KAA2B;YAW3B,uJAAwB,EAAE,GAAC;YAG3B,wJAAiB,KAAK,GAAC;;;;YAhWrB,uDAA4B;;;;;SAA5B,4BAA4B","sourcesContent":["import type { MindmapElementModel } from '@lumensuite/affine-block-surface';\nimport type {\n  AttachmentBlockModel,\n  BookmarkBlockModel,\n  BrushElementModel,\n  ConnectorElementModel,\n  EdgelessTextBlockModel,\n  EmbedFigmaModel,\n  EmbedGithubModel,\n  EmbedHtmlModel,\n  EmbedLinkedDocModel,\n  EmbedLoomModel,\n  EmbedSyncedDocModel,\n  EmbedYoutubeModel,\n  FrameBlockModel,\n  ImageBlockModel,\n  NoteBlockModel,\n  RootBlockModel,\n  TextElementModel,\n} from '@lumensuite/affine-model';\n\nimport { CommonUtils } from '@lumensuite/affine-block-surface';\nimport { ConnectorCWithArrowIcon } from '@lumensuite/affine-components/icons';\nimport {\n  cloneGroups,\n  type MenuItemGroup,\n  renderToolbarSeparator,\n} from '@lumensuite/affine-components/toolbar';\nimport {\n  ConnectorMode,\n  GroupElementModel,\n  ShapeElementModel,\n} from '@lumensuite/affine-model';\nimport { ThemeObserver } from '@lumensuite/affine-shared/theme';\nimport { requestConnectedFrame } from '@lumensuite/affine-shared/utils';\nimport { WidgetComponent } from '@lumensuite/block-std';\nimport { atLeastNMatches, groupBy, pickValues } from '@lumensuite/global/utils';\nimport { css, html, nothing, type TemplateResult } from 'lit';\nimport { customElement, property, state } from 'lit/decorators.js';\nimport { join } from 'lit/directives/join.js';\n\nimport type { EdgelessRootBlockComponent } from '../../edgeless/edgeless-root-block.js';\nimport type { ConnectorToolController } from '../../edgeless/tools/connector-tool.js';\nimport type { ElementToolbarMoreMenuContext } from './more-menu/context.js';\n\nimport { getMoreMenuConfig } from '../../configs/toolbar.js';\nimport { edgelessElementsBound } from '../../edgeless/utils/bound-utils.js';\nimport {\n  isAttachmentBlock,\n  isBookmarkBlock,\n  isEdgelessTextBlock,\n  isEmbeddedBlock,\n  isFrameBlock,\n  isImageBlock,\n  isNoteBlock,\n} from '../../edgeless/utils/query.js';\nimport { renderAddFrameButton } from './add-frame-button.js';\nimport { renderAddGroupButton } from './add-group-button.js';\nimport { renderAlignButton } from './align-button.js';\nimport { renderAttachmentButton } from './change-attachment-button.js';\nimport { renderChangeBrushButton } from './change-brush-button.js';\nimport { renderConnectorButton } from './change-connector-button.js';\nimport { renderChangeEdgelessTextButton } from './change-edgeless-text-button.js';\nimport { renderEmbedButton } from './change-embed-card-button.js';\nimport { renderFrameButton } from './change-frame-button.js';\nimport { renderGroupButton } from './change-group-button.js';\nimport { renderChangeImageButton } from './change-image-button.js';\nimport { renderMindmapButton } from './change-mindmap-button.js';\nimport { renderNoteButton } from './change-note-button.js';\nimport { renderChangeShapeButton } from './change-shape-button.js';\nimport { renderChangeTextButton } from './change-text-button.js';\nimport './more-menu/button.js';\nimport { BUILT_IN_GROUPS } from './more-menu/config.js';\nimport { renderReleaseFromGroupButton } from './release-from-group-button.js';\n\ntype CategorizedElements = {\n  shape?: ShapeElementModel[];\n  brush?: BrushElementModel[];\n  text?: TextElementModel[];\n  group?: GroupElementModel[];\n  connector?: ConnectorElementModel[];\n  note?: NoteBlockModel[];\n  frame?: FrameBlockModel[];\n  image?: ImageBlockModel[];\n  attachment?: AttachmentBlockModel[];\n  mindmap?: MindmapElementModel[];\n  embedCard?: BookmarkBlockModel[] &\n    EmbedGithubModel[] &\n    EmbedYoutubeModel[] &\n    EmbedFigmaModel[] &\n    EmbedLinkedDocModel[] &\n    EmbedSyncedDocModel[] &\n    EmbedHtmlModel[] &\n    EmbedLoomModel[];\n  edgelessText?: EdgelessTextBlockModel[];\n};\n\ntype CustomEntry = {\n  render: (edgeless: EdgelessRootBlockComponent) => TemplateResult | null;\n  when: (model: LumenSuite.EdgelessModel[]) => boolean;\n};\n\nexport const EDGELESS_ELEMENT_TOOLBAR_WIDGET =\n  'edgeless-element-toolbar-widget';\n\n@customElement(EDGELESS_ELEMENT_TOOLBAR_WIDGET)\nexport class EdgelessElementToolbarWidget extends WidgetComponent<\n  RootBlockModel,\n  EdgelessRootBlockComponent\n> {\n  static override styles = css`\n    :host {\n      position: absolute;\n      z-index: 3;\n      transform: translateZ(0);\n      will-change: transform;\n      -webkit-user-select: none;\n      user-select: none;\n    }\n  `;\n\n  private _quickConnect = ({ x, y }: MouseEvent) => {\n    const element = this.selection.selectedElements[0];\n    const point = this.edgeless.service.viewport.toViewCoordFromClientCoord([\n      x,\n      y,\n    ]);\n    this.edgeless.doc.captureSync();\n    this.edgeless.tools.setEdgelessTool({\n      type: 'connector',\n      mode: ConnectorMode.Curve,\n    });\n\n    const ctc = this.edgeless.tools.controllers[\n      'connector'\n    ] as ConnectorToolController;\n    ctc.quickConnect(point, element);\n  };\n\n  private _updateOnSelectedChange = (element: string | { id: string }) => {\n    const id = typeof element === 'string' ? element : element.id;\n\n    if (this.isConnected && !this._dragging && this.selection.has(id)) {\n      this._recalculatePosition();\n      this.requestUpdate();\n    }\n  };\n\n  /*\n   * Caches the more menu items.\n   * Currently only supports configuring more menu.\n   */\n  moreGroups: MenuItemGroup<ElementToolbarMoreMenuContext>[] =\n    cloneGroups(BUILT_IN_GROUPS);\n\n  get edgeless() {\n    return this.block as EdgelessRootBlockComponent;\n  }\n\n  get selection() {\n    return this.edgeless.service.selection;\n  }\n\n  get slots() {\n    return this.edgeless.slots;\n  }\n\n  get surface() {\n    return this.edgeless.surface;\n  }\n\n  private _groupSelected(): CategorizedElements {\n    const result = groupBy(this.selection.selectedElements, model => {\n      if (isNoteBlock(model)) {\n        return 'note';\n      } else if (isFrameBlock(model)) {\n        return 'frame';\n      } else if (isImageBlock(model)) {\n        return 'image';\n      } else if (isAttachmentBlock(model)) {\n        return 'attachment';\n      } else if (isBookmarkBlock(model) || isEmbeddedBlock(model)) {\n        return 'embedCard';\n      } else if (isEdgelessTextBlock(model)) {\n        return 'edgelessText';\n      }\n\n      return (model as LumenSuite.SurfaceElementModel).type;\n    });\n    return result as CategorizedElements;\n  }\n\n  private _recalculatePosition() {\n    const { selection, viewport } = this.edgeless.service;\n    const elements = selection.selectedElements;\n\n    if (elements.length === 0) {\n      this.style.transform = 'translate3d(0, 0, 0)';\n      return;\n    }\n\n    const bound = edgelessElementsBound(elements);\n\n    const { width, height } = viewport;\n    const [x, y] = viewport.toViewCoord(bound.x, bound.y);\n\n    let left = x;\n    let top = y;\n\n    let offset = 37 + 12;\n    // frame, group, shape\n    let hasFrame = false;\n    let hasGroup = false;\n    if (\n      (hasFrame = elements.some(ele => isFrameBlock(ele))) ||\n      (hasGroup = elements.some(ele => ele instanceof GroupElementModel))\n    ) {\n      offset += 16 + 4;\n      if (hasFrame) {\n        offset += 8;\n      }\n    } else if (\n      elements.length === 1 &&\n      elements[0] instanceof ShapeElementModel\n    ) {\n      offset += 22 + 4;\n    }\n\n    top = y - offset;\n    if (top < 0) {\n      top = y + bound.h * viewport.zoom + offset - 37;\n      if (hasFrame || hasGroup) {\n        top -= 16 + 4;\n        if (hasFrame) {\n          top -= 8;\n        }\n      }\n    }\n\n    requestConnectedFrame(() => {\n      const rect = this.getBoundingClientRect();\n\n      left = CommonUtils.clamp(x, 10, width - rect.width - 10);\n      top = CommonUtils.clamp(top, 10, height - rect.height - 150);\n\n      this.style.transform = `translate3d(${left}px, ${top}px, 0)`;\n    }, this);\n  }\n\n  private _renderQuickConnectButton() {\n    return [\n      html`\n        <editor-icon-button\n          aria-label=\"Draw connector\"\n          .tooltip=${'Draw connector'}\n          .activeMode=${'background'}\n          @click=${this._quickConnect}\n        >\n          ${ConnectorCWithArrowIcon}\n        </editor-icon-button>\n      `,\n    ];\n  }\n\n  protected override firstUpdated() {\n    const { _disposables, edgeless } = this;\n\n    this.moreGroups = getMoreMenuConfig(this.std).configure(this.moreGroups);\n\n    _disposables.add(\n      edgeless.service.viewport.viewportUpdated.on(() => {\n        this._recalculatePosition();\n      })\n    );\n\n    _disposables.add(\n      this.selection.slots.updated.on(() => {\n        if (\n          this.selection.selectedIds.length === 0 ||\n          this.selection.editing ||\n          this.selection.inoperable\n        ) {\n          this.toolbarVisible = false;\n        } else {\n          this.selectedIds = this.selection.selectedIds;\n          this._recalculatePosition();\n          this.toolbarVisible = true;\n        }\n      })\n    );\n\n    pickValues(this.edgeless.service.surface, [\n      'elementAdded',\n      'elementUpdated',\n    ]).forEach(slot => _disposables.add(slot.on(this._updateOnSelectedChange)));\n\n    _disposables.add(\n      this.doc.slots.blockUpdated.on(this._updateOnSelectedChange)\n    );\n\n    _disposables.add(\n      edgeless.dispatcher.add('dragStart', () => {\n        this._dragging = true;\n      })\n    );\n    _disposables.add(\n      edgeless.dispatcher.add('dragEnd', () => {\n        this._dragging = false;\n        this._recalculatePosition();\n      })\n    );\n\n    _disposables.add(\n      edgeless.slots.elementResizeStart.on(() => {\n        this._dragging = true;\n      })\n    );\n    _disposables.add(\n      edgeless.slots.elementResizeEnd.on(() => {\n        this._dragging = false;\n        this._recalculatePosition();\n      })\n    );\n\n    _disposables.add(\n      edgeless.slots.readonlyUpdated.on(() => this.requestUpdate())\n    );\n\n    this.updateComplete\n      .then(() => {\n        _disposables.add(ThemeObserver.subscribe(() => this.requestUpdate()));\n      })\n      .catch(console.error);\n  }\n\n  registerEntry(entry: CustomEntry) {\n    this._registeredEntries.push(entry);\n  }\n\n  override render() {\n    if (this.doc.readonly || this._dragging || !this.toolbarVisible) {\n      return nothing;\n    }\n\n    const groupedSelected = this._groupSelected();\n    const { edgeless, selection } = this;\n    const {\n      shape,\n      brush,\n      connector,\n      note,\n      text,\n      frame,\n      group,\n      embedCard,\n      attachment,\n      image,\n      edgelessText,\n      mindmap: mindmaps,\n    } = groupedSelected;\n    const { selectedElements } = this.selection;\n    const selectedAtLeastTwoTypes = atLeastNMatches(\n      Object.values(groupedSelected),\n      e => !!e.length,\n      2\n    );\n\n    const quickConnectButton =\n      selectedElements.length === 1 && !connector?.length\n        ? this._renderQuickConnectButton()\n        : undefined;\n\n    const generalButtons =\n      selectedElements.length !== connector?.length\n        ? [\n            renderAddFrameButton(edgeless, selectedElements),\n            renderAddGroupButton(edgeless, selectedElements),\n            renderAlignButton(edgeless, selectedElements),\n          ]\n        : [];\n\n    const buttons: (symbol | TemplateResult)[] = selectedAtLeastTwoTypes\n      ? generalButtons\n      : [\n          ...generalButtons,\n          renderMindmapButton(edgeless, mindmaps),\n          renderMindmapButton(edgeless, shape),\n          renderChangeShapeButton(edgeless, shape),\n          renderChangeBrushButton(edgeless, brush),\n          renderConnectorButton(edgeless, connector),\n          renderNoteButton(edgeless, note, quickConnectButton),\n          renderChangeTextButton(edgeless, text),\n          renderChangeEdgelessTextButton(edgeless, edgelessText),\n          renderFrameButton(edgeless, frame),\n          renderGroupButton(edgeless, group),\n          renderEmbedButton(edgeless, embedCard, quickConnectButton),\n          renderAttachmentButton(edgeless, attachment),\n          renderChangeImageButton(edgeless, image),\n        ];\n\n    if (selectedElements.length === 1) {\n      if (selection.firstElement.group instanceof GroupElementModel) {\n        buttons.unshift(renderReleaseFromGroupButton(this.edgeless));\n      }\n\n      if (!connector?.length) {\n        buttons.push(quickConnectButton?.pop() ?? nothing);\n      }\n    }\n\n    this._registeredEntries\n      .filter(entry => entry.when(selectedElements))\n      .map(entry => entry.render(this.edgeless))\n      .forEach(entry => entry && buttons.unshift(entry));\n\n    buttons.push(html`\n      <edgeless-more-button\n        .elements=${selectedElements}\n        .edgeless=${edgeless}\n        .groups=${this.moreGroups}\n        .vertical=${true}\n      ></edgeless-more-button>\n    `);\n\n    return html`\n      <editor-toolbar>\n        ${join(\n          buttons.filter(b => b !== nothing),\n          renderToolbarSeparator\n        )}\n      </editor-toolbar>\n    `;\n  }\n\n  @state()\n  private accessor _dragging = false;\n\n  @state()\n  private accessor _registeredEntries: {\n    render: (edgeless: EdgelessRootBlockComponent) => TemplateResult | null;\n    when: (model: LumenSuite.EdgelessModel[]) => boolean;\n  }[] = [];\n\n  @property({ attribute: false })\n  accessor enableNoteSlicer!: boolean;\n\n  @state({\n    hasChanged: (value: string[], oldValue: string[]) => {\n      if (value.length !== oldValue?.length) {\n        return true;\n      }\n\n      return value.some((id, index) => id !== oldValue[index]);\n    },\n  })\n  accessor selectedIds: string[] = [];\n\n  @state()\n  accessor toolbarVisible = false;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'edgeless-element-toolbar-widget': EdgelessElementToolbarWidget;\n  }\n}\n"]}