{"version":3,"file":"embed-card-toolbar.js","sourceRoot":"","sources":["../../../../src/root-block/widgets/embed-card-toolbar/embed-card-toolbar.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  CaptionIcon,\n  CenterPeekIcon,\n  CopyIcon,\n  EditIcon,\n  ExpandFullSmallIcon,\n  MoreVerticalIcon,\n  OpenIcon,\n  PaletteIcon,\n  SmallArrowDownIcon,\n} from '@lumensuite/affine-components/icons';\nimport { isPeekable, peek } from '@lumensuite/affine-components/peek';\nimport { toast } from '@lumensuite/affine-components/toast';\nimport {\n  cloneGroups,\n  type MenuItem,\n  type MenuItemGroup,\n  renderGroups,\n  renderToolbarSeparator,\n} from '@lumensuite/affine-components/toolbar';\nimport {\n  type BookmarkBlockModel,\n  BookmarkStyles,\n  type EmbedGithubModel,\n  type EmbedLinkedDocModel,\n  type RootBlockModel,\n} from '@lumensuite/affine-model';\nimport {\n  EmbedOptionProvider,\n  type EmbedOptions,\n} from '@lumensuite/affine-shared/services';\nimport { getHostName } from '@lumensuite/affine-shared/utils';\nimport { WidgetComponent } from '@lumensuite/block-std';\nimport { assertExists } from '@lumensuite/global/utils';\nimport { type BlockModel, DocCollection } from '@lumensuite/store';\nimport { autoUpdate, computePosition, flip, offset } from '@floating-ui/dom';\nimport { html, nothing, type TemplateResult } from 'lit';\nimport { customElement, query, state } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { ifDefined } from 'lit/directives/if-defined.js';\nimport { join } from 'lit/directives/join.js';\nimport { repeat } from 'lit/directives/repeat.js';\n\nimport type { EmbedCardStyle } from '../../../_common/types.js';\nimport type { RootBlockComponent } from '../../types.js';\n\nimport '../../../_common/components/button.js';\nimport { toggleEmbedCardCaptionEditModal } from '../../../_common/components/embed-card/modal/embed-card-caption-edit-modal.js';\nimport { toggleEmbedCardEditModal } from '../../../_common/components/embed-card/modal/embed-card-edit-modal.js';\nimport {\n  type EmbedToolbarBlockComponent,\n  type EmbedToolbarModel,\n  isEmbedCardBlockComponent,\n} from '../../../_common/components/embed-card/type.js';\nimport { getEmbedCardIcons } from '../../../_common/utils/url.js';\nimport { isLinkToNode } from '../../../embed-linked-doc-block/utils.js';\nimport { getMoreMenuConfig } from '../../configs/toolbar.js';\nimport {\n  isBookmarkBlock,\n  isEmbedGithubBlock,\n  isEmbedLinkedDocBlock,\n  isEmbedSyncedDocBlock,\n} from '../../edgeless/utils/query.js';\nimport { BUILT_IN_GROUPS } from './config.js';\nimport { EmbedCardToolbarContext } from './context.js';\nimport { embedCardToolbarStyle } from './styles.js';\n\nexport const AFFINE_EMBED_CARD_TOOLBAR_WIDGET = 'affine-embed-card-toolbar';\n\n@customElement(AFFINE_EMBED_CARD_TOOLBAR_WIDGET)\nexport class EmbedCardToolbar extends WidgetComponent<\n  RootBlockModel,\n  RootBlockComponent\n> {\n  static override styles = embedCardToolbarStyle;\n\n  private _abortController = new AbortController();\n\n  private _embedOptions: EmbedOptions | null = null;\n\n  private _resetAbortController = () => {\n    this._abortController.abort();\n    this._abortController = new AbortController();\n  };\n\n  /*\n   * Caches the more menu items.\n   * Currently only supports configuring more menu.\n   */\n  moreGroups: MenuItemGroup<EmbedCardToolbarContext>[] =\n    cloneGroups(BUILT_IN_GROUPS);\n\n  private get _canConvertToEmbedView() {\n    // synced doc entry controlled by awareness flag\n    if (this.focusModel && isEmbedLinkedDocBlock(this.focusModel)) {\n      const isSyncedDocEnabled = this.doc.awarenessStore.getFlag(\n        'enable_synced_doc_block'\n      );\n      if (!isSyncedDocEnabled) {\n        return false;\n      }\n    }\n\n    if (!this.focusBlock) return false;\n\n    return (\n      'convertToEmbed' in this.focusBlock ||\n      this._embedOptions?.viewType === 'embed'\n    );\n  }\n\n  private get _canShowUrlOptions() {\n    return this.focusModel && 'url' in this.focusModel && this._isCardView;\n  }\n\n  private get _embedViewButtonDisabled() {\n    if (this.doc.readonly) {\n      return true;\n    }\n    return (\n      this.focusModel &&\n      this.focusBlock &&\n      isEmbedLinkedDocBlock(this.focusModel) &&\n      (isLinkToNode(this.focusModel) ||\n        !!this.focusBlock.closest('affine-embed-synced-doc-block') ||\n        this.focusModel.pageId === this.doc.id)\n    );\n  }\n\n  private get _isCardView() {\n    return (\n      this.focusModel &&\n      (isBookmarkBlock(this.focusModel) ||\n        isEmbedLinkedDocBlock(this.focusModel) ||\n        this._embedOptions?.viewType === 'card')\n    );\n  }\n\n  private get _isEmbedView() {\n    return (\n      this.focusModel &&\n      !isBookmarkBlock(this.focusModel) &&\n      (isEmbedSyncedDocBlock(this.focusModel) ||\n        this._embedOptions?.viewType === 'embed')\n    );\n  }\n\n  get _openButtonDisabled() {\n    return (\n      this.focusModel &&\n      isEmbedLinkedDocBlock(this.focusModel) &&\n      this.focusModel.pageId === this.doc.id\n    );\n  }\n\n  private get _selection() {\n    return this.host.selection;\n  }\n\n  private get _viewType(): 'inline' | 'embed' | 'card' {\n    if (this._isCardView) {\n      return 'card';\n    }\n\n    if (this._isEmbedView) {\n      return 'embed';\n    }\n\n    return 'inline';\n  }\n\n  get focusModel(): EmbedToolbarModel | undefined {\n    return this.focusBlock?.model;\n  }\n\n  private _canShowCardStylePanel(\n    model: BlockModel\n  ): model is BookmarkBlockModel | EmbedGithubModel | EmbedLinkedDocModel {\n    return (\n      isBookmarkBlock(model) ||\n      isEmbedGithubBlock(model) ||\n      isEmbedLinkedDocBlock(model)\n    );\n  }\n\n  private _cardStyleMenuButton() {\n    if (this.focusModel && this._canShowCardStylePanel(this.focusModel)) {\n      const { EmbedCardHorizontalIcon, EmbedCardListIcon } =\n        getEmbedCardIcons();\n\n      const buttons = [\n        {\n          type: 'horizontal',\n          label: 'Large horizontal style',\n          icon: EmbedCardHorizontalIcon,\n        },\n        {\n          type: 'list',\n          label: 'Small horizontal style',\n          icon: EmbedCardListIcon,\n        },\n      ] as {\n        type: EmbedCardStyle;\n        label: string;\n        icon: TemplateResult<1>;\n      }[];\n\n      return html`\n        <editor-menu-button\n          class=\"card-style-select\"\n          .contentPadding=${'8px'}\n          .button=${html`\n            <editor-icon-button\n              aria-label=\"Card style\"\n              .tooltip=${'Card style'}\n            >\n              ${PaletteIcon}\n            </editor-icon-button>\n          `}\n        >\n          <div>\n            ${repeat(\n              buttons,\n              button => button.type,\n              ({ type, label, icon }) => html`\n                <icon-button\n                  width=\"76px\"\n                  height=\"76px\"\n                  aria-label=${label}\n                  class=${classMap({\n                    selected: this.focusModel?.style === type,\n                  })}\n                  @click=${() => this._setEmbedCardStyle(type)}\n                >\n                  ${icon}\n                  <affine-tooltip .offset=${4}>${label}</affine-tooltip>\n                </icon-button>\n              `\n            )}\n          </div>\n        </editor-menu-button>\n      `;\n    }\n\n    return nothing;\n  }\n\n  private _convertToCardView() {\n    if (this._isCardView) {\n      return;\n    }\n    if (!this.focusBlock) {\n      return;\n    }\n\n    if ('convertToCard' in this.focusBlock) {\n      this.focusBlock.convertToCard();\n      return;\n    }\n\n    if (!this.focusModel || !('url' in this.focusModel)) {\n      return;\n    }\n\n    const { doc, url, style, caption } = this.focusModel;\n\n    let targetFlavour = 'affine:bookmark',\n      targetStyle = style;\n\n    if (this._embedOptions && this._embedOptions.viewType === 'card') {\n      const { flavour, styles } = this._embedOptions;\n      targetFlavour = flavour;\n      targetStyle = styles.includes(style) ? style : styles[0];\n    } else {\n      targetStyle = BookmarkStyles.includes(style)\n        ? style\n        : BookmarkStyles.filter(\n            style => style !== 'vertical' && style !== 'cube'\n          )[0];\n    }\n\n    const parent = doc.getParent(this.focusModel);\n    assertExists(parent);\n    const index = parent.children.indexOf(this.focusModel);\n\n    doc.addBlock(\n      targetFlavour as never,\n      { url, style: targetStyle, caption },\n      parent,\n      index\n    );\n    this.std.selection.setGroup('note', []);\n    doc.deleteBlock(this.focusModel);\n  }\n\n  private _convertToEmbedView() {\n    if (this._isEmbedView) {\n      return;\n    }\n\n    if (!this.focusBlock) {\n      return;\n    }\n\n    if ('convertToEmbed' in this.focusBlock) {\n      this.focusBlock.convertToEmbed();\n      return;\n    }\n\n    if (!this.focusModel || !('url' in this.focusModel)) {\n      return;\n    }\n\n    const { doc, url, style, caption } = this.focusModel;\n\n    if (!this._embedOptions || this._embedOptions.viewType !== 'embed') {\n      return;\n    }\n    const { flavour, styles } = this._embedOptions;\n\n    const targetStyle = styles.includes(style)\n      ? style\n      : styles.filter(style => style !== 'vertical' && style !== 'cube')[0];\n\n    const parent = doc.getParent(this.focusModel);\n    assertExists(parent);\n    const index = parent.children.indexOf(this.focusModel);\n\n    doc.addBlock(\n      flavour as never,\n      { url, style: targetStyle, caption },\n      parent,\n      index\n    );\n\n    this.std.selection.setGroup('note', []);\n    doc.deleteBlock(this.focusModel);\n  }\n\n  private _copyUrl() {\n    if (!this.focusModel || !('url' in this.focusModel)) {\n      return;\n    }\n\n    navigator.clipboard.writeText(this.focusModel.url).catch(console.error);\n    toast(this.host, 'Copied link to clipboard');\n  }\n\n  private _hide() {\n    this._resetAbortController();\n    this.focusBlock = null;\n    this.hide = true;\n  }\n\n  private _moreActions() {\n    if (!this.focusBlock) return nothing;\n    const context = new EmbedCardToolbarContext(\n      this.focusBlock,\n      this._abortController\n    );\n    return renderGroups(this.moreGroups, context);\n  }\n\n  private _openMenuButton() {\n    const buttons: MenuItem[] = [];\n\n    if (\n      this.focusModel &&\n      (isEmbedLinkedDocBlock(this.focusModel) ||\n        isEmbedSyncedDocBlock(this.focusModel))\n    ) {\n      buttons.push({\n        type: 'open-this-doc',\n        label: 'Open this doc',\n        icon: ExpandFullSmallIcon,\n        action: () => this.focusBlock?.open(),\n      });\n    }\n\n    // open in new tab\n\n    const element = this.focusBlock;\n    if (element && isPeekable(element)) {\n      buttons.push({\n        type: 'open-in-center-peek',\n        label: 'Open in center peek',\n        icon: CenterPeekIcon,\n        action: () => peek(element),\n      });\n    }\n\n    // open in split view\n\n    if (buttons.length === 0) {\n      return nothing;\n    }\n\n    return html`\n      <editor-menu-button\n        .contentPadding=${'8px'}\n        .button=${html`\n          <editor-icon-button\n            aria-label=\"Open\"\n            .justify=${'space-between'}\n            .labelHeight=${'20px'}\n          >\n            ${OpenIcon}${SmallArrowDownIcon}\n          </editor-icon-button>\n        `}\n      >\n        <div data-size=\"small\" data-orientation=\"vertical\">\n          ${repeat(\n            buttons,\n            button => button.label,\n            ({ label, icon, action, disabled }) => html`\n              <editor-menu-action\n                aria-label=${ifDefined(label)}\n                ?disabled=${disabled}\n                @click=${action}\n              >\n                ${icon}<span class=\"label\">${label}</span>\n              </editor-menu-action>\n            `\n          )}\n        </div>\n      </editor-menu-button>\n    `;\n  }\n\n  private _setEmbedCardStyle(style: EmbedCardStyle) {\n    this.focusModel?.doc.updateBlock(this.focusModel, { style });\n    this.requestUpdate();\n    this._abortController.abort();\n  }\n\n  private _show() {\n    if (!this.focusBlock) {\n      return;\n    }\n    this.hide = false;\n    this._abortController.signal.addEventListener(\n      'abort',\n      autoUpdate(this.focusBlock, this, () => {\n        if (!this.focusBlock) {\n          return;\n        }\n        computePosition(this.focusBlock, this, {\n          placement: 'top-start',\n          middleware: [flip(), offset(8)],\n        })\n          .then(({ x, y }) => {\n            this.style.left = `${x}px`;\n            this.style.top = `${y}px`;\n          })\n          .catch(console.error);\n      })\n    );\n  }\n\n  private _showCaption() {\n    const focusBlock = this.focusBlock;\n    if (!focusBlock) {\n      return;\n    }\n    try {\n      focusBlock.captionEditor?.show();\n    } catch (_) {\n      toggleEmbedCardCaptionEditModal(focusBlock);\n    }\n    this._resetAbortController();\n  }\n\n  private _turnIntoInlineView() {\n    if (this.focusBlock && 'covertToInline' in this.focusBlock) {\n      this.focusBlock.covertToInline();\n      return;\n    }\n\n    if (!this.focusModel || !('url' in this.focusModel)) {\n      return;\n    }\n\n    const { doc } = this.focusModel;\n    const parent = doc.getParent(this.focusModel);\n    const index = parent?.children.indexOf(this.focusModel);\n\n    const yText = new DocCollection.Y.Text();\n    const insert =\n      this.focusModel.title || this.focusModel.caption || this.focusModel.url;\n    yText.insert(0, insert);\n    yText.format(0, insert.length, { link: this.focusModel.url });\n    const text = new doc.Text(yText);\n    doc.addBlock(\n      'affine:paragraph',\n      {\n        text,\n      },\n      parent,\n      index\n    );\n\n    doc.deleteBlock(this.focusModel);\n  }\n\n  private _viewMenuButton() {\n    const buttons = [];\n\n    buttons.push({\n      type: 'inline',\n      label: 'Inline view',\n      action: () => this._turnIntoInlineView(),\n      disabled: this.doc.readonly,\n    });\n\n    buttons.push({\n      type: 'card',\n      label: 'Card view',\n      action: () => this._convertToCardView(),\n      disabled: this.doc.readonly,\n    });\n\n    if (this._canConvertToEmbedView || this._isEmbedView) {\n      buttons.push({\n        type: 'embed',\n        label: 'Embed view',\n        action: () => this._convertToEmbedView(),\n        disabled: this.doc.readonly || this._embedViewButtonDisabled,\n      });\n    }\n\n    return html`\n      <editor-menu-button\n        .contentPadding=${'8px'}\n        .button=${html`\n          <editor-icon-button\n            aria-label=\"Switch view\"\n            .justify=${'space-between'}\n            .labelHeight=${'20px'}\n            .iconContainerWidth=${'110px'}\n          >\n            <div class=\"label\">\n              <span style=\"text-transform: capitalize\">${this._viewType}</span>\n              view\n            </div>\n            ${SmallArrowDownIcon}\n          </editor-icon-button>\n        `}\n      >\n        <div data-size=\"small\" data-orientation=\"vertical\">\n          ${repeat(\n            buttons,\n            button => button.type,\n            ({ type, label, action, disabled }) => html`\n              <editor-menu-action\n                data-testid=${`link-to-${type}`}\n                aria-label=${ifDefined(label)}\n                ?data-selected=${this._viewType === type}\n                ?disabled=${disabled}\n                @click=${action}\n              >\n                ${label}\n              </editor-menu-action>\n            `\n          )}\n        </div>\n      </editor-menu-button>\n    `;\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n\n    this.moreGroups = getMoreMenuConfig(this.std).configure(this.moreGroups);\n\n    this.disposables.add(\n      this._selection.slots.changed.on(() => {\n        const hasTextSelection = this._selection.find('text');\n        if (hasTextSelection) {\n          this._hide();\n          return;\n        }\n\n        const blockSelections = this._selection.filter('block');\n        if (!blockSelections || blockSelections.length !== 1) {\n          this._hide();\n          return;\n        }\n\n        const block = this.std.view.getBlock(blockSelections[0].blockId);\n        if (!block || !isEmbedCardBlockComponent(block)) {\n          this._hide();\n          return;\n        }\n\n        this.focusBlock = block as EmbedToolbarBlockComponent;\n        this._show();\n      })\n    );\n  }\n\n  override render() {\n    if (this.hide) return nothing;\n\n    const model = this.focusModel;\n    this._embedOptions =\n      model && 'url' in model\n        ? this.std.get(EmbedOptionProvider).getEmbedBlockOptions(model.url)\n        : null;\n\n    const buttons = [\n      this._canShowUrlOptions && model && 'url' in model\n        ? html`\n            <a\n              class=\"affine-link-preview\"\n              href=${model.url}\n              rel=\"noopener noreferrer\"\n              target=\"_blank\"\n            >\n              <span>${getHostName(model.url)}</span>\n            </a>\n\n            <editor-icon-button\n              aria-label=\"Copy\"\n              data-testid=\"copy-link\"\n              .tooltip=${'Click to copy link'}\n              ?disabled=${model.doc.readonly}\n              @click=${() => this._copyUrl()}\n            >\n              ${CopyIcon}\n            </editor-icon-button>\n\n            <editor-icon-button\n              aria-label=\"Edit\"\n              data-testid=\"edit\"\n              .tooltip=${'Edit'}\n              ?disabled=${this.doc.readonly}\n              @click=${() => toggleEmbedCardEditModal(this.host, model)}\n            >\n              ${EditIcon}\n            </editor-icon-button>\n          `\n        : nothing,\n\n      this._openMenuButton(),\n\n      this._viewMenuButton(),\n\n      this._cardStyleMenuButton(),\n\n      html`\n        <editor-icon-button\n          aria-label=\"Caption\"\n          .tooltip=${'Add Caption'}\n          ?disabled=${this.doc.readonly}\n          @click=${() => this._showCaption()}\n        >\n          ${CaptionIcon}\n        </editor-icon-button>\n      `,\n\n      html`\n        <editor-menu-button\n          .contentPadding=${'8px'}\n          .button=${html`\n            <editor-icon-button aria-label=\"More\" .tooltip=${'More'}>\n              ${MoreVerticalIcon}\n            </editor-icon-button>\n          `}\n        >\n          <div data-size=\"large\" data-orientation=\"vertical\">\n            ${this._moreActions()}\n          </div>\n        </editor-menu-button>\n      `,\n    ];\n\n    return html`\n      <editor-toolbar class=\"embed-card-toolbar\">\n        ${join(\n          buttons.filter(button => button !== nothing),\n          renderToolbarSeparator\n        )}\n      </editor-toolbar>\n    `;\n  }\n\n  @query('.embed-card-toolbar-button.card-style')\n  accessor cardStyleButton: HTMLElement | null = null;\n\n  @query('.embed-card-toolbar')\n  accessor embedCardToolbarElement!: HTMLElement;\n\n  @state()\n  accessor focusBlock: EmbedToolbarBlockComponent | null = null;\n\n  @state()\n  accessor hide: boolean = true;\n\n  @query('.embed-card-toolbar-button.more-button')\n  accessor moreButton: HTMLElement | null = null;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [AFFINE_EMBED_CARD_TOOLBAR_WIDGET]: EmbedCardToolbar;\n  }\n}\n"]}