{"version":3,"file":"zoom-bar-toggle-button.js","sourceRoot":"","sources":["../../../../src/root-block/widgets/edgeless-zoom-toolbar/zoom-bar-toggle-button.ts"],"names":[],"mappings":"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","sourcesContent":["import { MoreIcon } from '@blocksuite/affine-components/icons';\nimport { createLitPortal } from '@blocksuite/affine-components/portal';\nimport { stopPropagation } from '@blocksuite/affine-shared/utils';\nimport { WithDisposable } from '@blocksuite/block-std';\nimport { offset } from '@floating-ui/dom';\nimport { css, html, LitElement, nothing } from 'lit';\nimport { customElement, property, query, state } from 'lit/decorators.js';\n\nimport type { EdgelessRootBlockComponent } from '../../edgeless/edgeless-root-block.js';\n\n@customElement('zoom-bar-toggle-button')\nexport class ZoomBarToggleButton extends WithDisposable(LitElement) {\n  static override styles = css`\n    :host {\n      display: flex;\n    }\n    .toggle-button {\n      display: flex;\n      position: relative;\n    }\n    edgeless-zoom-toolbar {\n      position: absolute;\n      bottom: initial;\n    }\n  `;\n\n  private _abortController: AbortController | null = null;\n\n  private _closeZoomMenu() {\n    if (this._abortController && !this._abortController.signal.aborted) {\n      this._abortController.abort();\n      this._abortController = null;\n      this._showPopper = false;\n    }\n  }\n\n  private _toggleZoomMenu() {\n    if (this._abortController && !this._abortController.signal.aborted) {\n      this._closeZoomMenu();\n      return;\n    }\n\n    this._abortController = new AbortController();\n    this._abortController.signal.addEventListener('abort', () => {\n      this._showPopper = false;\n    });\n    createLitPortal({\n      template: html`<edgeless-zoom-toolbar\n        .edgeless=${this.edgeless}\n        .layout=${'vertical'}\n      ></edgeless-zoom-toolbar>`,\n      container: this._toggleButton,\n      computePosition: {\n        referenceElement: this._toggleButton,\n        placement: 'top',\n        middleware: [offset(4)],\n        autoUpdate: true,\n      },\n      abortController: this._abortController,\n      closeOnClickAway: true,\n    });\n    this._showPopper = true;\n  }\n\n  override disconnectedCallback() {\n    super.disconnectedCallback();\n    this._closeZoomMenu();\n  }\n\n  override firstUpdated() {\n    const { disposables } = this;\n    disposables.add(\n      this.edgeless.slots.readonlyUpdated.on(() => {\n        this.requestUpdate();\n      })\n    );\n  }\n\n  override render() {\n    if (this.edgeless.doc.readonly) {\n      return nothing;\n    }\n\n    return html`\n      <div class=\"toggle-button\" @pointerdown=${stopPropagation}>\n        <edgeless-tool-icon-button\n          .tooltip=${'Toggle Zoom Tool Bar'}\n          .tipPosition=${'right'}\n          .active=${this._showPopper}\n          .arrow=${false}\n          .activeMode=${'background'}\n          .iconContainerPadding=${6}\n          @click=${() => this._toggleZoomMenu()}\n        >\n          ${MoreIcon}\n        </edgeless-tool-icon-button>\n      </div>\n    `;\n  }\n\n  @state()\n  private accessor _showPopper = false;\n\n  @query('.toggle-button')\n  private accessor _toggleButton!: HTMLElement;\n\n  @property({ attribute: false })\n  accessor edgeless!: EdgelessRootBlockComponent;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'zoom-bar-toggle-button': ZoomBarToggleButton;\n  }\n}\n"]}