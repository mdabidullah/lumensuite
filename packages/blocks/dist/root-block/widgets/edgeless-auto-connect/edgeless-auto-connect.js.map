{"version":3,"file":"edgeless-auto-connect.js","sourceRoot":"","sources":["../../../../src/root-block/widgets/edgeless-auto-connect/edgeless-auto-connect.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  AutoConnectLeftIcon,\n  AutoConnectRightIcon,\n  HiddenIcon,\n  SmallDocIcon,\n} from '@blocksuite/affine-components/icons';\nimport {\n  FrameBlockModel,\n  NoteBlockModel,\n  type RootBlockModel,\n  type SurfaceRefBlockModel,\n} from '@blocksuite/affine-model';\nimport { NoteDisplayMode } from '@blocksuite/affine-model';\nimport {\n  matchFlavours,\n  stopPropagation,\n} from '@blocksuite/affine-shared/utils';\nimport { WidgetComponent } from '@blocksuite/block-std';\nimport { Bound } from '@blocksuite/global/utils';\nimport { css, html, nothing, type TemplateResult } from 'lit';\nimport { customElement, state } from 'lit/decorators.js';\nimport { repeat } from 'lit/directives/repeat.js';\nimport { styleMap } from 'lit/directives/style-map.js';\n\nimport type { EdgelessRootBlockComponent } from '../../edgeless/edgeless-root-block.js';\nimport type { EdgelessRootService } from '../../edgeless/edgeless-root-service.js';\n\nimport { isNoteBlock } from '../../edgeless/utils/query.js';\n\nconst PAGE_VISIBLE_INDEX_LABEL_WIDTH = 44;\nconst PAGE_VISIBLE_INDEX_LABEL_HEIGHT = 24;\nconst EDGELESS_ONLY_INDEX_LABEL_WIDTH = 24;\nconst EDGELESS_ONLY_INDEX_LABEL_HEIGHT = 24;\nconst INDEX_LABEL_OFFSET = 16;\n\nfunction calculatePosition(gap: number, count: number, iconWidth: number) {\n  const positions = [];\n  if (count === 1) {\n    positions.push([0, 10]);\n    return positions;\n  }\n  const middleIndex = (count - 1) / 2;\n  const isEven = count % 2 === 0;\n  const middleOffset = (gap + iconWidth) / 2;\n  function getSign(num: number) {\n    return num - middleIndex > 0 ? 1 : -1;\n  }\n  for (let j = 0; j < count; j++) {\n    let left = 10;\n    if (isEven) {\n      if (Math.abs(j - middleIndex) < 1 && isEven) {\n        left = 10 + middleOffset * getSign(j);\n      } else {\n        left =\n          10 +\n          ((Math.ceil(Math.abs(j - middleIndex)) - 1) * (gap + 24) +\n            middleOffset) *\n            getSign(j);\n      }\n    } else {\n      const offset = gap + iconWidth;\n      left = 10 + Math.ceil(Math.abs(j - middleIndex)) * offset * getSign(j);\n    }\n    positions.push([0, left]);\n  }\n\n  return positions;\n}\n\nfunction getIndexLabelTooltip(icon: TemplateResult, content: string) {\n  const styles = css`\n    .index-label-tooltip {\n      display: flex;\n      align-items: center;\n      flex-wrap: nowrap;\n      gap: 10px;\n    }\n\n    .index-label-tooltip-icon {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n\n    .index-label-tooltip-content {\n      font-size: var(--affine-font-sm);\n\n      display: flex;\n      height: 16px;\n      line-height: 16px;\n    }\n  `;\n\n  return html`<style>\n      ${styles}\n    </style>\n    <div class=\"index-label-tooltip\">\n      <span class=\"index-label-tooltip-icon\">${icon}</span>\n      <span class=\"index-label-tooltip-content\">${content}</span>\n    </div>`;\n}\n\ntype AutoConnectElement = NoteBlockModel | FrameBlockModel;\n\nfunction isAutoConnectElement(element: unknown): element is AutoConnectElement {\n  return (\n    element instanceof NoteBlockModel || element instanceof FrameBlockModel\n  );\n}\n\nexport const AFFINE_EDGELESS_AUTO_CONNECT_WIDGET =\n  'affine-edgeless-auto-connect-widget';\n\n@customElement(AFFINE_EDGELESS_AUTO_CONNECT_WIDGET)\nexport class EdgelessAutoConnectWidget extends WidgetComponent<\n  RootBlockModel,\n  EdgelessRootBlockComponent,\n  EdgelessRootService\n> {\n  static override styles = css`\n    .page-visible-index-label {\n      box-sizing: border-box;\n      padding: 0px 6px;\n      border: 1px solid #0000001a;\n\n      width: fit-content;\n      height: 24px;\n      min-width: 24px;\n\n      color: var(--affine-white);\n      font-size: 15px;\n      line-height: 22px;\n      text-align: center;\n\n      cursor: pointer;\n      user-select: none;\n\n      border-radius: 25px;\n      background: var(--affine-primary-color);\n    }\n\n    .navigator {\n      width: 48px;\n      padding: 4px;\n      border-radius: 58px;\n      border: 1px solid rgba(227, 226, 228, 1);\n      transition: opacity 0.5s ease-in-out;\n      background: rgba(251, 251, 252, 1);\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      opacity: 0;\n    }\n\n    .navigator div {\n      display: flex;\n      align-items: center;\n      cursor: pointer;\n    }\n\n    .navigator span {\n      display: inline-block;\n      height: 8px;\n      border: 1px solid rgba(227, 226, 228, 1);\n    }\n\n    .navigator div:hover {\n      background: var(--affine-hover-color);\n    }\n\n    .navigator.show {\n      opacity: 1;\n    }\n  `;\n\n  private _updateLabels = () => {\n    const service = this.service;\n    if (!service.doc.root) return;\n\n    const pageVisibleBlocks = new Map<AutoConnectElement, number>();\n    const notes = service.doc.root?.children.filter(child =>\n      matchFlavours(child, ['affine:note'])\n    );\n    const edgelessOnlyNotesSet = new Set<NoteBlockModel>();\n\n    notes.forEach(note => {\n      if (isNoteBlock(note)) {\n        if (note.displayMode$.value === NoteDisplayMode.EdgelessOnly) {\n          edgelessOnlyNotesSet.add(note);\n        } else if (note.displayMode$.value === NoteDisplayMode.DocAndEdgeless) {\n          pageVisibleBlocks.set(note, 1);\n        }\n      }\n\n      note.children.forEach(model => {\n        if (matchFlavours(model, ['affine:surface-ref'])) {\n          const reference = service.getElementById(model.reference);\n\n          if (!isAutoConnectElement(reference)) return;\n\n          if (!pageVisibleBlocks.has(reference)) {\n            pageVisibleBlocks.set(reference, 1);\n          } else {\n            pageVisibleBlocks.set(\n              reference,\n              pageVisibleBlocks.get(reference)! + 1\n            );\n          }\n        }\n      });\n    });\n\n    this._edgelessOnlyNotesSet = edgelessOnlyNotesSet;\n    this._pageVisibleElementsMap = pageVisibleBlocks;\n  };\n\n  private _EdgelessOnlyLabels() {\n    const { _edgelessOnlyNotesSet } = this;\n\n    if (!_edgelessOnlyNotesSet.size) return nothing;\n\n    return html`${repeat(\n      _edgelessOnlyNotesSet,\n      note => note.id,\n      note => {\n        const { viewport } = this.service;\n        const { zoom } = viewport;\n        const bound = Bound.deserialize(note.xywh);\n        const [left, right] = viewport.toViewCoord(bound.x, bound.y);\n        const [width, height] = [bound.w * zoom, bound.h * zoom];\n        const style = styleMap({\n          width: `${EDGELESS_ONLY_INDEX_LABEL_WIDTH}px`,\n          height: `${EDGELESS_ONLY_INDEX_LABEL_HEIGHT}px`,\n          borderRadius: '50%',\n          backgroundColor: 'var(--affine-text-secondary-color)',\n          border: '1px solid var(--affine-border-color)',\n          color: 'var(--affine-white)',\n          position: 'absolute',\n          transform: `translate(${\n            left + width / 2 - EDGELESS_ONLY_INDEX_LABEL_WIDTH / 2\n          }px,\n          ${right + height + INDEX_LABEL_OFFSET}px)`,\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n        });\n\n        return html`<div style=${style} class=\"edgeless-only-index-label\">\n          ${HiddenIcon}\n          <affine-tooltip tip-position=\"bottom\">\n            ${getIndexLabelTooltip(SmallDocIcon, 'Hidden on page')}\n          </affine-tooltip>\n        </div>`;\n      }\n    )}`;\n  }\n\n  private _getElementsAndCounts() {\n    const elements: AutoConnectElement[] = [];\n    const counts: number[] = [];\n\n    for (const [key, value] of this._pageVisibleElementsMap.entries()) {\n      elements.push(key);\n      counts.push(value);\n    }\n\n    return { elements, counts };\n  }\n\n  private _initLabels() {\n    const { service } = this.block;\n    const surfaceRefs = service.doc\n      .getBlocksByFlavour('affine:surface-ref')\n      .map(block => block.model) as SurfaceRefBlockModel[];\n\n    const getVisibility = () => {\n      const { selectedElements } = service.selection;\n\n      if (\n        selectedElements.length === 1 &&\n        !service.selection.editing &&\n        (isNoteBlock(selectedElements[0]) ||\n          surfaceRefs.some(ref => ref.reference === selectedElements[0].id))\n      ) {\n        this._show = true;\n      } else {\n        this._show = false;\n      }\n\n      return this._show;\n    };\n\n    this._disposables.add(\n      service.selection.slots.updated.on(() => {\n        getVisibility();\n      })\n    );\n    this._disposables.add(\n      this.doc.slots.blockUpdated.on(payload => {\n        if (payload.flavour === 'affine:surface-ref') {\n          switch (payload.type) {\n            case 'add':\n              surfaceRefs.push(payload.model as SurfaceRefBlockModel);\n              break;\n            case 'delete':\n              {\n                const idx = surfaceRefs.indexOf(\n                  payload.model as SurfaceRefBlockModel\n                );\n                if (idx >= 0) {\n                  surfaceRefs.splice(idx, 1);\n                }\n              }\n              break;\n            case 'update':\n              if (payload.props.key !== 'reference') {\n                return;\n              }\n          }\n\n          this.requestUpdate();\n        }\n      })\n    );\n    this._disposables.add(\n      service.surface.elementUpdated.on(payload => {\n        if (\n          payload.props['xywh'] &&\n          surfaceRefs.some(ref => ref.reference === payload.id)\n        ) {\n          this.requestUpdate();\n        }\n      })\n    );\n  }\n\n  private _navigateToNext() {\n    const { elements } = this._getElementsAndCounts();\n    if (this._index >= elements.length - 1) return;\n    this._index = this._index + 1;\n    const element = elements[this._index];\n    const bound = Bound.deserialize(element.xywh);\n    this.service.selection.set({\n      elements: [element.id],\n      editing: false,\n    });\n    this.service.viewport.setViewportByBound(bound, [80, 80, 80, 80], true);\n  }\n\n  private _navigateToPrev() {\n    const { elements } = this._getElementsAndCounts();\n    if (this._index <= 0) return;\n    this._index = this._index - 1;\n    const element = elements[this._index];\n    const bound = Bound.deserialize(element.xywh);\n    this.service.selection.set({\n      elements: [element.id],\n      editing: false,\n    });\n    this.service.viewport.setViewportByBound(bound, [80, 80, 80, 80], true);\n  }\n\n  private _NavigatorComponent(elements: AutoConnectElement[]) {\n    const { viewport } = this.service;\n    const { zoom } = viewport;\n    const className = `navigator ${this._index >= 0 ? 'show' : 'hidden'}`;\n    const element = elements[this._index];\n    const bound = Bound.deserialize(element.xywh);\n    const [left, right] = viewport.toViewCoord(bound.x, bound.y);\n    const [width, height] = [bound.w * zoom, bound.h * zoom];\n    const navigatorStyle = styleMap({\n      position: 'absolute',\n      transform: `translate(${left + width / 2 - 26}px, ${\n        right + height + 16\n      }px)`,\n    });\n\n    return html`<div class=${className} style=${navigatorStyle}>\n      <div\n        role=\"button\"\n        class=\"edgeless-auto-connect-previous-button\"\n        @pointerdown=${(e: PointerEvent) => {\n          stopPropagation(e);\n          this._navigateToPrev();\n        }}\n      >\n        ${AutoConnectLeftIcon}\n      </div>\n      <span></span>\n      <div\n        role=\"button\"\n        class=\"edgeless-auto-connect-next-button\"\n        @pointerdown=${(e: PointerEvent) => {\n          stopPropagation(e);\n          this._navigateToNext();\n        }}\n      >\n        ${AutoConnectRightIcon}\n      </div>\n    </div> `;\n  }\n\n  private _PageVisibleIndexLabels(\n    elements: AutoConnectElement[],\n    counts: number[]\n  ) {\n    const { viewport } = this.service;\n    const { zoom } = viewport;\n    let index = 0;\n\n    return html`${repeat(\n      elements,\n      element => element.id,\n      (element, i) => {\n        const bound = Bound.deserialize(element.xywh$.value);\n        const [left, right] = viewport.toViewCoord(bound.x, bound.y);\n        const [width, height] = [bound.w * zoom, bound.h * zoom];\n        const style = styleMap({\n          width: `${PAGE_VISIBLE_INDEX_LABEL_WIDTH}px`,\n          maxWidth: `${PAGE_VISIBLE_INDEX_LABEL_WIDTH}px`,\n          height: `${PAGE_VISIBLE_INDEX_LABEL_HEIGHT}px`,\n          position: 'absolute',\n          transform: `translate(${\n            left + width / 2 - PAGE_VISIBLE_INDEX_LABEL_WIDTH / 2\n          }px,\n          ${right + height + INDEX_LABEL_OFFSET}px)`,\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n        });\n        const components = [];\n        const count = counts[i];\n        const initGap = 24 / count - 24;\n        const positions = calculatePosition(\n          initGap,\n          count,\n          PAGE_VISIBLE_INDEX_LABEL_HEIGHT\n        );\n\n        for (let j = 0; j < count; j++) {\n          index++;\n          components.push(html`\n            <div\n              style=${styleMap({\n                position: 'absolute',\n                top: positions[j][0] + 'px',\n                left: positions[j][1] + 'px',\n                transition: 'all 0.1s linear',\n              })}\n              index=${i}\n              class=\"page-visible-index-label\"\n              @pointerdown=${(e: PointerEvent) => {\n                stopPropagation(e);\n                this._index = this._index === i ? -1 : i;\n              }}\n            >\n              ${index}\n              <affine-tooltip tip-position=\"bottom\">\n                ${getIndexLabelTooltip(SmallDocIcon, 'Page mode index')}\n              </affine-tooltip>\n            </div>\n          `);\n        }\n\n        function updateChildrenPosition(e: MouseEvent, positions: number[][]) {\n          if (!e.target) return;\n          const children = (e.target as HTMLElement).children;\n          (Array.from(children) as HTMLElement[]).forEach((c, index) => {\n            c.style.top = positions[index][0] + 'px';\n            c.style.left = positions[index][1] + 'px';\n          });\n        }\n\n        return html`<div\n          style=${style}\n          @mouseenter=${(e: MouseEvent) => {\n            const positions = calculatePosition(\n              5,\n              count,\n              PAGE_VISIBLE_INDEX_LABEL_HEIGHT\n            );\n            updateChildrenPosition(e, positions);\n          }}\n          @mouseleave=${(e: MouseEvent) => {\n            const positions = calculatePosition(\n              initGap,\n              count,\n              PAGE_VISIBLE_INDEX_LABEL_HEIGHT\n            );\n            updateChildrenPosition(e, positions);\n          }}\n        >\n          ${components}\n        </div>`;\n      }\n    )}`;\n  }\n\n  private _setHostStyle() {\n    this.style.position = 'absolute';\n    this.style.top = '0';\n    this.style.left = '0';\n    this.style.zIndex = '1';\n  }\n\n  override connectedCallback(): void {\n    super.connectedCallback();\n\n    this._setHostStyle();\n    this._initLabels();\n  }\n\n  override firstUpdated(): void {\n    const { _disposables, service } = this;\n\n    _disposables.add(\n      service.viewport.viewportUpdated.on(() => {\n        this.requestUpdate();\n      })\n    );\n\n    _disposables.add(\n      service.selection.slots.updated.on(() => {\n        const { selectedElements } = service.selection;\n        if (\n          !(selectedElements.length === 1 && isNoteBlock(selectedElements[0]))\n        ) {\n          this._index = -1;\n        }\n      })\n    );\n\n    _disposables.add(\n      service.uiEventDispatcher.add('dragStart', () => {\n        this._dragging = true;\n      })\n    );\n    _disposables.add(\n      service.uiEventDispatcher.add('dragEnd', () => {\n        this._dragging = false;\n      })\n    );\n    _disposables.add(\n      service.slots.elementResizeStart.on(() => {\n        this._dragging = true;\n      })\n    );\n    _disposables.add(\n      service.slots.elementResizeEnd.on(() => {\n        this._dragging = false;\n      })\n    );\n  }\n\n  override render() {\n    if (!this._show || this._dragging) return nothing;\n\n    this._updateLabels();\n\n    const { elements, counts } = this._getElementsAndCounts();\n\n    return html`${this._PageVisibleIndexLabels(elements, counts)}\n    ${this._EdgelessOnlyLabels()}\n    ${this._index >= 0 && this._index < elements.length\n      ? this._NavigatorComponent(elements)\n      : nothing} `;\n  }\n\n  @state()\n  private accessor _dragging = false;\n\n  @state()\n  private accessor _edgelessOnlyNotesSet = new Set<NoteBlockModel>();\n\n  @state()\n  private accessor _index = -1;\n\n  @state()\n  private accessor _pageVisibleElementsMap: Map<AutoConnectElement, number> =\n    new Map();\n\n  @state()\n  private accessor _show = false;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'affine-edgeless-auto-connect-widget': EdgelessAutoConnectWidget;\n  }\n}\n"]}