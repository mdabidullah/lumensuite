{"version":3,"file":"linked-doc-popover.js","sourceRoot":"","sources":["../../../../src/root-block/widgets/linked-doc/linked-doc-popover.ts"],"names":[],"mappings":"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","sourcesContent":["import type { AffineInlineEditor } from '@blocksuite/affine-components/rich-text';\nimport type { EditorHost } from '@blocksuite/block-std';\n\nimport { MoreHorizontalIcon } from '@blocksuite/affine-components/icons';\nimport { WithDisposable } from '@blocksuite/block-std';\nimport { html, LitElement, nothing } from 'lit';\nimport { customElement, query, queryAll, state } from 'lit/decorators.js';\nimport { styleMap } from 'lit/directives/style-map.js';\n\nimport type { IconButton } from '../../../_common/components/button.js';\nimport type { LinkedMenuGroup } from './config.js';\n\nimport '../../../_common/components/button.js';\nimport {\n  cleanSpecifiedTail,\n  createKeydownObserver,\n  getQuery,\n} from '../../../_common/components/utils.js';\nimport { styles } from './styles.js';\n\n@customElement('affine-linked-doc-popover')\nexport class LinkedDocPopover extends WithDisposable(LitElement) {\n  static override styles = styles;\n\n  private _abort = () => {\n    // remove popover dom\n    this.abortController.abort();\n    // clear input query\n    cleanSpecifiedTail(\n      this.editorHost,\n      this.inlineEditor,\n      this.triggerKey + (this._query || '')\n    );\n  };\n\n  private _expanded = new Map<string, boolean>();\n\n  private _startRange = this.inlineEditor.getInlineRange();\n\n  private get _actionGroup() {\n    return this._linkedDocGroup.map(group => {\n      return {\n        ...group,\n        items: this._getActionItems(group),\n      };\n    });\n  }\n\n  private get _flattenActionList() {\n    return this._actionGroup\n      .map(group =>\n        group.items.map(item => ({ ...item, groupName: group.name }))\n      )\n      .flat();\n  }\n\n  private get _query() {\n    return getQuery(this.inlineEditor, this._startRange);\n  }\n\n  constructor(\n    private triggerKey: string,\n    private getMenus: (\n      query: string,\n      abort: () => void,\n      editorHost: EditorHost,\n      inlineEditor: AffineInlineEditor\n    ) => Promise<LinkedMenuGroup[]>,\n    private editorHost: EditorHost,\n    private inlineEditor: AffineInlineEditor,\n    private abortController: AbortController\n  ) {\n    super();\n  }\n\n  private _getActionItems(group: LinkedMenuGroup) {\n    const isExpanded = !!this._expanded.get(group.name);\n    if (isExpanded) {\n      return group.items;\n    }\n    const isOverflow =\n      !!group.maxDisplay && group.items.length > group.maxDisplay;\n    if (isOverflow) {\n      return group.items.slice(0, group.maxDisplay).concat({\n        key: `${group.name} More`,\n        name: group.overflowText || 'more',\n        icon: MoreHorizontalIcon,\n        action: () => {\n          this._expanded.set(group.name, true);\n          this.requestUpdate();\n        },\n      });\n    }\n    return group.items;\n  }\n\n  private _isTextOverflowing(element: HTMLElement) {\n    return element.scrollWidth > element.clientWidth;\n  }\n\n  private async _updateLinkedDocGroup() {\n    const query = this._query;\n    if (query === null) {\n      this.abortController.abort();\n      return;\n    }\n    this._linkedDocGroup = await this.getMenus(\n      query,\n      this._abort,\n      this.editorHost,\n      this.inlineEditor\n    );\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n\n    // init\n    void this._updateLinkedDocGroup();\n    this._disposables.addFromEvent(this, 'mousedown', e => {\n      // Prevent input from losing focus\n      e.preventDefault();\n    });\n\n    const { eventSource } = this.inlineEditor;\n    if (!eventSource) return;\n    createKeydownObserver({\n      target: eventSource,\n      signal: this.abortController.signal,\n      inlineEditor: this.inlineEditor,\n      onInput: () => {\n        this._activatedItemIndex = 0;\n        void this._updateLinkedDocGroup();\n      },\n      onPaste: () => {\n        this._activatedItemIndex = 0;\n        setTimeout(() => {\n          void this._updateLinkedDocGroup();\n        }, 20);\n      },\n      onDelete: () => {\n        const curRange = this.inlineEditor.getInlineRange();\n        if (!this._startRange || !curRange) {\n          return;\n        }\n        if (curRange.index < this._startRange.index) {\n          this.abortController.abort();\n        }\n        this._activatedItemIndex = 0;\n        void this._updateLinkedDocGroup();\n      },\n      onMove: step => {\n        const itemLen = this._flattenActionList.length;\n        this._activatedItemIndex =\n          (itemLen + this._activatedItemIndex + step) % itemLen;\n\n        // Scroll to the active item\n        const item = this._flattenActionList[this._activatedItemIndex];\n        const shadowRoot = this.shadowRoot;\n        if (!shadowRoot) {\n          console.warn('Failed to find the shadow root!', this);\n          return;\n        }\n        const ele = shadowRoot.querySelector(\n          `icon-button[data-id=\"${item.key}\"]`\n        );\n        if (!ele) {\n          console.warn('Failed to find the active item!', item);\n          return;\n        }\n        ele.scrollIntoView({\n          block: 'nearest',\n        });\n      },\n      onConfirm: () => {\n        this._flattenActionList[this._activatedItemIndex]\n          .action()\n          ?.catch(console.error);\n      },\n      onAbort: () => {\n        this.abortController.abort();\n      },\n    });\n  }\n\n  override render() {\n    const MAX_HEIGHT = 410;\n    const style = this._position\n      ? styleMap({\n          transform: `translate(${this._position.x}, ${this._position.y})`,\n          maxHeight: `${Math.min(this._position.height, MAX_HEIGHT)}px`,\n        })\n      : styleMap({\n          visibility: 'hidden',\n        });\n\n    // XXX This is a side effect\n    let accIdx = 0;\n    return html`<div class=\"linked-doc-popover\" style=\"${style}\">\n      ${this._actionGroup\n        .filter(group => group.items.length)\n        .map((group, idx) => {\n          return html`\n            <div class=\"divider\" ?hidden=${idx === 0}></div>\n            <div class=\"group-title\">${group.name}</div>\n            <div class=\"group\" style=${group.styles ?? ''}>\n              ${group.items.map(({ key, name, icon, action }) => {\n                accIdx++;\n                const curIdx = accIdx - 1;\n                const tooltip = this._showTooltip\n                  ? html`<affine-tooltip tip-position=${'right'}\n                      >${name}</affine-tooltip\n                    >`\n                  : nothing;\n                return html`<icon-button\n                  width=\"280px\"\n                  height=\"32px\"\n                  data-id=${key}\n                  text=${name}\n                  hover=${this._activatedItemIndex === curIdx}\n                  @click=${() => {\n                    action()?.catch(console.error);\n                  }}\n                  @mousemove=${() => {\n                    // Use `mousemove` instead of `mouseover` to avoid navigate conflict with keyboard\n                    this._activatedItemIndex = curIdx;\n                    // show tooltip whether text length overflows\n                    for (const button of this.iconButtons.values()) {\n                      if (button.dataset.id == key && button.textElement) {\n                        const isOverflowing = this._isTextOverflowing(\n                          button.textElement\n                        );\n                        this._showTooltip = isOverflowing;\n                        break;\n                      }\n                    }\n                  }}\n                >\n                  ${icon} ${tooltip}\n                </icon-button>`;\n              })}\n            </div>\n          `;\n        })}\n    </div>`;\n  }\n\n  updatePosition(position: { height: number; x: string; y: string }) {\n    this._position = position;\n  }\n\n  @state()\n  private accessor _activatedItemIndex = 0;\n\n  @state()\n  private accessor _linkedDocGroup: LinkedMenuGroup[] = [];\n\n  @state()\n  private accessor _position: {\n    height: number;\n    x: string;\n    y: string;\n  } | null = null;\n\n  @state()\n  private accessor _showTooltip = false;\n\n  @queryAll('icon-button')\n  accessor iconButtons!: NodeListOf<IconButton>;\n\n  @query('.linked-doc-popover')\n  accessor linkedDocElement: Element | null = null;\n}\n"]}