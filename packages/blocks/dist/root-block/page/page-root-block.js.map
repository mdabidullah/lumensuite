{"version":3,"file":"page-root-block.js","sourceRoot":"","sources":["../../../src/root-block/page/page-root-block.ts"],"names":[],"mappings":"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","sourcesContent":["import type { NoteBlockModel, RootBlockModel } from '@lumensuite/affine-model';\nimport type { Viewport } from '@lumensuite/affine-shared/types';\nimport type { PointerEventState } from '@lumensuite/block-std';\nimport type { BlockModel, Text } from '@lumensuite/store';\n\nimport { focusTextModel } from '@lumensuite/affine-components/rich-text';\nimport { NoteDisplayMode } from '@lumensuite/affine-model';\nimport {\n  focusTitle,\n  getDocTitleInlineEditor,\n  getScrollContainer,\n  matchFlavours,\n} from '@lumensuite/affine-shared/utils';\nimport { BlockComponent } from '@lumensuite/block-std';\nimport { css, html } from 'lit';\nimport { customElement, query } from 'lit/decorators.js';\nimport { repeat } from 'lit/directives/repeat.js';\n\nimport type { PageRootBlockWidgetName } from '../index.js';\nimport type { PageRootService } from './page-root-service.js';\n\nimport { buildPath } from '../../_common/utils/index.js';\nimport { PageClipboard } from '../clipboard/index.js';\nimport { PageKeyboardManager } from '../keyboard/keyboard-manager.js';\n\nconst DOC_BLOCK_CHILD_PADDING = 24;\nconst DOC_BOTTOM_PADDING = 32;\n\nfunction testClickOnBlankArea(\n  state: PointerEventState,\n  viewportLeft: number,\n  viewportWidth: number,\n  pageWidth: number,\n  paddingLeft: number,\n  paddingRight: number\n) {\n  const blankLeft =\n    viewportLeft + (viewportWidth - pageWidth) / 2 + paddingLeft;\n  const blankRight =\n    viewportLeft + (viewportWidth - pageWidth) / 2 + pageWidth - paddingRight;\n\n  if (state.raw.clientX < blankLeft || state.raw.clientX > blankRight) {\n    return true;\n  }\n\n  return false;\n}\n\n@customElement('affine-page-root')\nexport class PageRootBlockComponent extends BlockComponent<\n  RootBlockModel,\n  PageRootService,\n  PageRootBlockWidgetName\n> {\n  static override styles = css`\n    editor-host:has(> affine-page-root, * > affine-page-root) {\n      display: block;\n      height: 100%;\n    }\n\n    affine-page-root {\n      display: block;\n      height: 100%;\n    }\n\n    .affine-page-root-block-container {\n      display: flex;\n      flex-direction: column;\n      width: 100%;\n      height: 100%;\n      font-family: var(--affine-font-family);\n      font-size: var(--affine-font-base);\n      line-height: var(--affine-line-height);\n      color: var(--affine-text-primary-color);\n      font-weight: 400;\n      max-width: var(--affine-editor-width);\n      margin: 0 auto;\n      /* cursor: crosshair; */\n      cursor: default;\n\n      /* Leave a place for drag-handle */\n      /* Do not use prettier format this style, or it will be broken */\n      /* prettier-ignore */\n      padding-left: var(--affine-editor-side-padding, ${DOC_BLOCK_CHILD_PADDING}px);\n      /* prettier-ignore */\n      padding-right: var(--affine-editor-side-padding, ${DOC_BLOCK_CHILD_PADDING}px);\n      /* prettier-ignore */\n      padding-bottom: var(--affine-editor-bottom-padding, ${DOC_BOTTOM_PADDING}px);\n    }\n\n    /* Extra small devices (phones, 640px and down) */\n    @container viewport (width <= 640px) {\n      .affine-page-root-block-container {\n        padding-left: ${DOC_BLOCK_CHILD_PADDING}px;\n        padding-right: ${DOC_BLOCK_CHILD_PADDING}px;\n      }\n    }\n\n    .affine-block-element {\n      display: block;\n    }\n\n    @media print {\n      .selected {\n        background-color: transparent !important;\n      }\n    }\n  `;\n\n  private _viewportElement: HTMLDivElement | null = null;\n\n  clipboardController = new PageClipboard(this);\n\n  focusFirstParagraph = () => {\n    const defaultNote = this._getDefaultNoteBlock();\n    const firstText = defaultNote?.children.find(block =>\n      matchFlavours(block, ['affine:paragraph', 'affine:list', 'affine:code'])\n    );\n    if (firstText) {\n      focusTextModel(this.std, firstText.id);\n    } else {\n      const newFirstParagraphId = this.doc.addBlock(\n        'affine:paragraph',\n        {},\n        defaultNote,\n        0\n      );\n      focusTextModel(this.std, newFirstParagraphId);\n    }\n  };\n\n  keyboardManager: PageKeyboardManager | null = null;\n\n  prependParagraphWithText = (text: Text) => {\n    const newFirstParagraphId = this.doc.addBlock(\n      'affine:paragraph',\n      { text },\n      this._getDefaultNoteBlock(),\n      0\n    );\n    focusTextModel(this.std, newFirstParagraphId);\n  };\n\n  get rootScrollContainer() {\n    return getScrollContainer(this);\n  }\n\n  get slots() {\n    return this.service.slots;\n  }\n\n  get viewport(): Viewport | null {\n    if (!this.viewportElement) {\n      return null;\n    }\n    const {\n      scrollLeft,\n      scrollTop,\n      scrollWidth,\n      scrollHeight,\n      clientWidth,\n      clientHeight,\n    } = this.viewportElement;\n    const { top, left } = this.viewportElement.getBoundingClientRect();\n    return {\n      top,\n      left,\n      scrollLeft,\n      scrollTop,\n      scrollWidth,\n      scrollHeight,\n      clientWidth,\n      clientHeight,\n    };\n  }\n\n  get viewportElement(): HTMLDivElement | null {\n    if (this._viewportElement) return this._viewportElement;\n    this._viewportElement = this.host.closest(\n      '.affine-page-viewport'\n    ) as HTMLDivElement | null;\n    return this._viewportElement;\n  }\n\n  private _createDefaultNoteBlock() {\n    const { doc } = this;\n\n    const noteId = doc.addBlock('affine:note', {}, doc.root?.id);\n    return doc.getBlockById(noteId) as NoteBlockModel;\n  }\n\n  private _getDefaultNoteBlock() {\n    return (\n      this.doc.root?.children.find(child => child.flavour === 'affine:note') ??\n      this._createDefaultNoteBlock()\n    );\n  }\n\n  private _initViewportResizeEffect() {\n    const viewport = this.viewport;\n    const viewportElement = this.viewportElement;\n    if (!viewport || !viewportElement) {\n      return;\n    }\n    // when observe viewportElement resize, emit viewport update event\n    const resizeObserver = new ResizeObserver(\n      (entries: ResizeObserverEntry[]) => {\n        for (const { target } of entries) {\n          if (target === viewportElement) {\n            this.slots.viewportUpdated.emit(viewport);\n            break;\n          }\n        }\n      }\n    );\n    resizeObserver.observe(viewportElement);\n    this.disposables.add(() => {\n      resizeObserver.unobserve(viewportElement);\n      resizeObserver.disconnect();\n    });\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n    this.clipboardController.hostConnected();\n\n    this.keyboardManager = new PageKeyboardManager(this);\n\n    this.bindHotKey({\n      'Mod-a': () => {\n        const blocks = this.model.children\n          .filter(model => {\n            if (matchFlavours(model, ['affine:note'])) {\n              const note = model as NoteBlockModel;\n              if (note.displayMode === NoteDisplayMode.EdgelessOnly)\n                return false;\n\n              return true;\n            }\n            return false;\n          })\n          .flatMap(model => {\n            return model.children.map(child => {\n              return this.std.selection.create('block', {\n                blockId: child.id,\n              });\n            });\n          });\n        this.std.selection.setGroup('note', blocks);\n        return true;\n      },\n      ArrowUp: () => {\n        const selection = this.host.selection;\n        const sel = selection.value.find(\n          sel => sel.is('text') || sel.is('block')\n        );\n        if (!sel) return;\n        let model: BlockModel | null = null;\n        let path: string[] = buildPath(this.doc.getBlockById(sel.blockId));\n        while (path.length > 0 && !model) {\n          const m = this.doc.getBlockById(path[path.length - 1]);\n          if (m && m.flavour === 'affine:note') {\n            model = m;\n          }\n          path = path.slice(0, -1);\n        }\n        if (!model) return;\n        const prevNote = this.doc.getPrev(model);\n        if (!prevNote || prevNote.flavour !== 'affine:note') {\n          const isFirstText = sel.is('text') && sel.start.index === 0;\n          const isBlock = sel.is('block');\n          if (isBlock || isFirstText) {\n            focusTitle(this.host);\n          }\n          return;\n        }\n        const notes = this.doc.getBlockByFlavour('affine:note');\n        const index = notes.indexOf(prevNote);\n        if (index !== 0) return;\n\n        const range = this.std.range.value;\n        requestAnimationFrame(() => {\n          const currentRange = this.std.range.value;\n\n          if (!range || !currentRange) return;\n\n          // If the range has not changed, it means we need to manually move the cursor to the title.\n          if (\n            range.startContainer === currentRange.startContainer &&\n            range.startOffset === currentRange.startOffset &&\n            range.endContainer === currentRange.endContainer &&\n            range.endOffset === currentRange.endOffset\n          ) {\n            const titleInlineEditor = getDocTitleInlineEditor(this.host);\n            if (titleInlineEditor) {\n              titleInlineEditor.focusEnd();\n            }\n          }\n        });\n      },\n    });\n\n    this.handleEvent('click', ctx => {\n      const event = ctx.get('pointerState');\n      if (\n        event.raw.target !== this &&\n        event.raw.target !== this.viewportElement &&\n        event.raw.target !== this.rootElementContainer\n      ) {\n        return;\n      }\n\n      const { paddingLeft, paddingRight } = window.getComputedStyle(\n        this.rootElementContainer\n      );\n      if (!this.viewport) return;\n      const isClickOnBlankArea = testClickOnBlankArea(\n        event,\n        this.viewport.left,\n        this.viewport.clientWidth,\n        this.rootElementContainer.clientWidth,\n        parseFloat(paddingLeft),\n        parseFloat(paddingRight)\n      );\n      if (isClickOnBlankArea) {\n        this.host.selection.clear(['block']);\n        return;\n      }\n\n      let newTextSelectionId: string | null = null;\n      const readonly = this.doc.readonly;\n      const lastNote = this.model.children\n        .slice()\n        .reverse()\n        .find(child => {\n          const isNote = matchFlavours(child, ['affine:note']);\n          if (!isNote) return false;\n          const note = child as NoteBlockModel;\n          const displayOnDoc =\n            !!note.displayMode &&\n            note.displayMode !== NoteDisplayMode.EdgelessOnly;\n          return displayOnDoc;\n        });\n      if (!lastNote) {\n        if (readonly) return;\n        const noteId = this.doc.addBlock('affine:note', {}, this.model.id);\n        const paragraphId = this.doc.addBlock('affine:paragraph', {}, noteId);\n        newTextSelectionId = paragraphId;\n      } else {\n        const last = lastNote.children.at(-1);\n        if (\n          !last ||\n          !last.text ||\n          matchFlavours(last, [\n            'affine:code',\n            'affine:divider',\n            'affine:image',\n            'affine:database',\n            'affine:bookmark',\n            'affine:attachment',\n            'affine:surface-ref',\n          ]) ||\n          /affine:embed-*/.test(last.flavour)\n        ) {\n          if (readonly) return;\n          const paragraphId = this.doc.addBlock(\n            'affine:paragraph',\n            {},\n            lastNote.id\n          );\n          newTextSelectionId = paragraphId;\n        }\n      }\n\n      this.updateComplete\n        .then(() => {\n          if (!newTextSelectionId) return;\n          this.host.selection.setGroup('note', [\n            this.host.selection.create('text', {\n              from: {\n                blockId: newTextSelectionId,\n                index: 0,\n                length: 0,\n              },\n              to: null,\n            }),\n          ]);\n        })\n        .catch(console.error);\n    });\n  }\n\n  override disconnectedCallback() {\n    super.disconnectedCallback();\n    this.clipboardController.hostDisconnected();\n    this._disposables.dispose();\n    this.keyboardManager = null;\n  }\n\n  override firstUpdated() {\n    this._initViewportResizeEffect();\n    const noteModels = this.model.children.filter(model =>\n      matchFlavours(model, ['affine:note'])\n    );\n    noteModels.forEach(note => {\n      this.disposables.add(\n        note.propsUpdated.on(({ key }) => {\n          if (key === 'displayMode') {\n            this.requestUpdate();\n          }\n        })\n      );\n    });\n  }\n\n  override renderBlock() {\n    const widgets = html`${repeat(\n      Object.entries(this.widgets),\n      ([id]) => id,\n      ([_, widget]) => widget\n    )}`;\n\n    const children = this.renderChildren(this.model, child => {\n      const isNote = matchFlavours(child, ['affine:note']);\n      const note = child as NoteBlockModel;\n      const displayOnEdgeless =\n        !!note.displayMode && note.displayMode === NoteDisplayMode.EdgelessOnly;\n      // Should remove deprecated `hidden` property in the future\n      return !(isNote && displayOnEdgeless);\n    });\n\n    return html`\n      <div class=\"affine-page-root-block-container\">${children} ${widgets}</div>\n    `;\n  }\n\n  @query('.affine-page-root-block-container')\n  accessor rootElementContainer!: HTMLDivElement;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'affine-page-root': PageRootBlockComponent;\n  }\n}\n"]}