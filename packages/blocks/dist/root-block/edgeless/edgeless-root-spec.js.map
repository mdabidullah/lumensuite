{"version":3,"file":"edgeless-root-spec.js","sourceRoot":"","sources":["../../../src/root-block/edgeless/edgeless-root-spec.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  DocModeService,\n  EmbedOptionService,\n} from '@blocksuite/affine-shared/services';\nimport {\n  BlockViewExtension,\n  CommandExtension,\n  type ExtensionType,\n  WidgetViewMapExtension,\n} from '@blocksuite/block-std';\nimport { BlockServiceWatcher, FlavourExtension } from '@blocksuite/block-std';\nimport { literal, unsafeStatic } from 'lit/static-html.js';\n\nimport { commands } from '../commands/index.js';\nimport { AFFINE_DOC_REMOTE_SELECTION_WIDGET } from '../widgets/doc-remote-selection/doc-remote-selection.js';\nimport { AFFINE_DRAG_HANDLE_WIDGET } from '../widgets/drag-handle/drag-handle.js';\nimport { AFFINE_EDGELESS_AUTO_CONNECT_WIDGET } from '../widgets/edgeless-auto-connect/edgeless-auto-connect.js';\nimport { AFFINE_EDGELESS_REMOTE_SELECTION_WIDGET } from '../widgets/edgeless-remote-selection/index.js';\nimport { AFFINE_EDGELESS_ZOOM_TOOLBAR_WIDGET } from '../widgets/edgeless-zoom-toolbar/index.js';\nimport { AFFINE_EMBED_CARD_TOOLBAR_WIDGET } from '../widgets/embed-card-toolbar/embed-card-toolbar.js';\nimport { AFFINE_FORMAT_BAR_WIDGET } from '../widgets/format-bar/format-bar.js';\nimport { EDGELESS_ELEMENT_TOOLBAR_WIDGET } from '../widgets/index.js';\nimport { AFFINE_INNER_MODAL_WIDGET } from '../widgets/inner-modal/inner-modal.js';\nimport { AFFINE_LINKED_DOC_WIDGET } from '../widgets/linked-doc/index.js';\nimport { AFFINE_MODAL_WIDGET } from '../widgets/modal/modal.js';\nimport { AFFINE_PIE_MENU_WIDGET } from '../widgets/pie-menu/index.js';\nimport { AFFINE_SLASH_MENU_WIDGET } from '../widgets/slash-menu/index.js';\nimport { AFFINE_VIEWPORT_OVERLAY_WIDGET } from '../widgets/viewport-overlay/viewport-overlay.js';\nimport './edgeless-root-preview-block.js';\nimport { EdgelessRootService } from './edgeless-root-service.js';\n\nexport const edgelessRootWigetViewMap = {\n  [AFFINE_MODAL_WIDGET]: literal`${unsafeStatic(AFFINE_MODAL_WIDGET)}`,\n  [AFFINE_INNER_MODAL_WIDGET]: literal`${unsafeStatic(AFFINE_INNER_MODAL_WIDGET)}`,\n  [AFFINE_PIE_MENU_WIDGET]: literal`${unsafeStatic(AFFINE_PIE_MENU_WIDGET)}`,\n  [AFFINE_SLASH_MENU_WIDGET]: literal`${unsafeStatic(\n    AFFINE_SLASH_MENU_WIDGET\n  )}`,\n  [AFFINE_LINKED_DOC_WIDGET]: literal`${unsafeStatic(\n    AFFINE_LINKED_DOC_WIDGET\n  )}`,\n  [AFFINE_DRAG_HANDLE_WIDGET]: literal`${unsafeStatic(\n    AFFINE_DRAG_HANDLE_WIDGET\n  )}`,\n  [AFFINE_EMBED_CARD_TOOLBAR_WIDGET]: literal`${unsafeStatic(\n    AFFINE_EMBED_CARD_TOOLBAR_WIDGET\n  )}`,\n  [AFFINE_FORMAT_BAR_WIDGET]: literal`${unsafeStatic(\n    AFFINE_FORMAT_BAR_WIDGET\n  )}`,\n  [AFFINE_DOC_REMOTE_SELECTION_WIDGET]: literal`${unsafeStatic(\n    AFFINE_DOC_REMOTE_SELECTION_WIDGET\n  )}`,\n  [AFFINE_EDGELESS_REMOTE_SELECTION_WIDGET]: literal`${unsafeStatic(\n    AFFINE_EDGELESS_REMOTE_SELECTION_WIDGET\n  )}`,\n  [AFFINE_EDGELESS_ZOOM_TOOLBAR_WIDGET]: literal`${unsafeStatic(\n    AFFINE_EDGELESS_ZOOM_TOOLBAR_WIDGET\n  )}`,\n  [EDGELESS_ELEMENT_TOOLBAR_WIDGET]: literal`${unsafeStatic(EDGELESS_ELEMENT_TOOLBAR_WIDGET)}`,\n  [AFFINE_VIEWPORT_OVERLAY_WIDGET]: literal`${unsafeStatic(\n    AFFINE_VIEWPORT_OVERLAY_WIDGET\n  )}`,\n  [AFFINE_EDGELESS_AUTO_CONNECT_WIDGET]: literal`${unsafeStatic(\n    AFFINE_EDGELESS_AUTO_CONNECT_WIDGET\n  )}`,\n};\n\nexport const EdgelessRootBlockSpec: ExtensionType[] = [\n  FlavourExtension('affine:page'),\n  EdgelessRootService,\n  DocModeService,\n  EmbedOptionService,\n  CommandExtension(commands),\n  BlockViewExtension('affine:page', literal`affine-edgeless-root`),\n  WidgetViewMapExtension('affine:page', edgelessRootWigetViewMap),\n];\n\nclass EdgelessServiceWatcher extends BlockServiceWatcher {\n  static override readonly flavour = 'affine:page';\n\n  override mounted() {\n    const service = this.blockService;\n    service.disposables.add(\n      service.specSlots.viewConnected.on(({ service }) => {\n        // Does not allow the user to move and zoom.\n        (service as EdgelessRootService).locked = true;\n      })\n    );\n  }\n}\n\nexport const PreviewEdgelessRootBlockSpec: ExtensionType[] = [\n  FlavourExtension('affine:page'),\n  EdgelessRootService,\n  EdgelessServiceWatcher,\n  DocModeService,\n  EmbedOptionService,\n  CommandExtension(commands),\n  BlockViewExtension('affine:page', literal`affine-edgeless-root-preview`),\n];\n"]}