{"version":3,"file":"crud.js","sourceRoot":"","sources":["../../../../src/root-block/edgeless/utils/crud.ts"],"names":[],"mappings":"AAGA,OAAO,EAAE,aAAa,EAAE,WAAW,EAAE,MAAM,YAAY,CAAC;AAExD,MAAM,UAAU,cAAc,CAC5B,QAAoC,EACpC,QAAoC;IAEpC,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,QAAQ,CAAC,CAAC;IAC9B,MAAM,EAAE,OAAO,EAAE,GAAG,QAAQ,CAAC;IAE7B,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;QACzB,IAAI,aAAa,CAAC,OAAO,CAAC,EAAE,CAAC;YAC3B,MAAM,UAAU,GAAG,OAAO,CAAC,aAAa,CAAC,OAAsB,CAAC,CAAC;YACjE,UAAU,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC;QACtD,CAAC;IACH,CAAC,CAAC,CAAC;IAEH,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;QACpB,IAAI,WAAW,CAAC,OAAO,CAAC,EAAE,CAAC;YACzB,MAAM,QAAQ,GAAG,QAAQ,CAAC,GAAG,CAAC,IAAI,EAAE,QAAQ,IAAI,EAAE,CAAC;YACnD,4CAA4C;YAC5C,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;gBACxB,QAAQ,CAAC,GAAG,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;YACpC,CAAC;QACH,CAAC;aAAM,CAAC;YACN,OAAO,CAAC,aAAa,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;QACpC,CAAC;IACH,CAAC,CAAC,CAAC;AACL,CAAC","sourcesContent":["import type { Connectable } from '../../../_common/utils/index.js';\nimport type { EdgelessRootBlockComponent } from '../index.js';\n\nimport { isConnectable, isNoteBlock } from './query.js';\n\nexport function deleteElements(\n  edgeless: EdgelessRootBlockComponent,\n  elements: LumenSuite.EdgelessModel[]\n) {\n  const set = new Set(elements);\n  const { service } = edgeless;\n\n  elements.forEach(element => {\n    if (isConnectable(element)) {\n      const connectors = service.getConnectors(element as Connectable);\n      connectors.forEach(connector => set.add(connector));\n    }\n  });\n\n  set.forEach(element => {\n    if (isNoteBlock(element)) {\n      const children = edgeless.doc.root?.children ?? [];\n      // FIXME: should always keep at least 1 note\n      if (children.length > 1) {\n        edgeless.doc.deleteBlock(element);\n      }\n    } else {\n      service.removeElement(element.id);\n    }\n  });\n}\n"]}