{"version":3,"file":"slide-menu.js","sourceRoot":"","sources":["../../../../../../src/root-block/edgeless/components/toolbar/common/slide-menu.ts"],"names":[],"mappings":"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","sourcesContent":["import { ArrowRightSmallIcon } from '@blocksuite/affine-components/icons';\nimport { WithDisposable } from '@blocksuite/block-std';\nimport { consume } from '@lit/context';\nimport { css, html, LitElement } from 'lit';\nimport { customElement, property, query } from 'lit/decorators.js';\nimport { styleMap } from 'lit/directives/style-map.js';\n\nimport {\n  type EdgelessToolbarSlots,\n  edgelessToolbarSlotsContext,\n} from '../context.js';\n\n@customElement('edgeless-slide-menu')\nexport class EdgelessSlideMenu extends WithDisposable(LitElement) {\n  static override styles = css`\n    :host {\n      max-width: 100%;\n    }\n    ::-webkit-scrollbar {\n      display: none;\n    }\n    .slide-menu-wrapper {\n      position: relative;\n    }\n    .menu-container {\n      background: var(--affine-background-overlay-panel-color);\n      border-radius: 8px 8px 0 0;\n      border: 1px solid var(--affine-border-color);\n      border-bottom: none;\n      display: flex;\n      align-items: center;\n      width: fit-content;\n      max-width: 100%;\n      overflow-x: auto;\n      overscroll-behavior: none;\n      scrollbar-width: none;\n      position: relative;\n      height: calc(var(--menu-height) + 1px);\n      box-sizing: border-box;\n      padding: 0 10px;\n      scroll-snap-type: x mandatory;\n    }\n    .slide-menu-content {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      height: 100%;\n      transition: left 0.5s ease-in-out;\n    }\n    .next-slide-button,\n    .previous-slide-button {\n      align-items: center;\n      justify-content: center;\n      position: absolute;\n      width: 32px;\n      height: 32px;\n      border-radius: 50%;\n      border: 1px solid var(--affine-border-color);\n      background: var(--affine-background-overlay-panel-color);\n      box-shadow: var(--affine-shadow-2);\n      color: var(--affine-icon-color);\n      transition:\n        transform 0.3s ease-in-out,\n        opacity 0.5s ease-in-out;\n      z-index: 12;\n    }\n    .next-slide-button {\n      opacity: 0;\n      display: flex;\n      top: 50%;\n      right: 0;\n      transform: translate(50%, -50%) scale(0.5);\n    }\n    .next-slide-button:hover {\n      cursor: pointer;\n      transform: translate(50%, -50%) scale(1);\n    }\n    .previous-slide-button {\n      opacity: 0;\n      top: 50%;\n      left: 0;\n      transform: translate(-50%, -50%) scale(0.5);\n    }\n    .previous-slide-button:hover {\n      cursor: pointer;\n      transform: translate(-50%, -50%) scale(1);\n    }\n    .previous-slide-button svg {\n      transform: rotate(180deg);\n    }\n  `;\n\n  private _handleSlideButtonClick(direction: 'left' | 'right') {\n    const totalWidth = this._slideMenuContent.clientWidth;\n    const currentScrollLeft = this._menuContainer.scrollLeft;\n    const menuWidth = this._menuContainer.clientWidth;\n    const newLeft =\n      currentScrollLeft + (direction === 'left' ? -menuWidth : menuWidth);\n    this._menuContainer.scrollTo({\n      left: Math.max(0, Math.min(newLeft, totalWidth)),\n      behavior: 'smooth',\n    });\n  }\n\n  private _handleWheel(event: WheelEvent) {\n    event.stopPropagation();\n  }\n\n  private _toggleSlideButton() {\n    const scrollLeft = this._menuContainer.scrollLeft;\n    const menuWidth = this._menuContainer.clientWidth;\n\n    const leftMin = 0;\n    const leftMax = this._slideMenuContent.clientWidth - menuWidth + 2; // border is 2\n    this.showPrevious = scrollLeft > leftMin;\n    this.showNext = scrollLeft < leftMax;\n  }\n\n  override firstUpdated() {\n    setTimeout(this._toggleSlideButton.bind(this), 0);\n    this._disposables.addFromEvent(this._menuContainer, 'scrollend', () => {\n      this._toggleSlideButton();\n    });\n    this._disposables.add(\n      this.toolbarSlots.resize.on(() => this._toggleSlideButton())\n    );\n  }\n\n  override render() {\n    return html`\n      <div class=\"slide-menu-wrapper\">\n        <div\n          class=\"previous-slide-button\"\n          @click=${() => this._handleSlideButtonClick('left')}\n          style=${styleMap({ opacity: this.showPrevious ? '1' : '0' })}\n        >\n          ${ArrowRightSmallIcon}\n        </div>\n        <div\n          class=\"menu-container\"\n          style=${styleMap({ '--menu-height': this.height })}\n        >\n          <div class=\"slide-menu-content\" @wheel=${this._handleWheel}>\n            <slot></slot>\n          </div>\n        </div>\n        <div\n          style=${styleMap({ opacity: this.showNext ? '1' : '0' })}\n          class=\"next-slide-button\"\n          @click=${() => this._handleSlideButtonClick('right')}\n        >\n          ${ArrowRightSmallIcon}\n        </div>\n      </div>\n    `;\n  }\n\n  @query('.menu-container')\n  private accessor _menuContainer!: HTMLDivElement;\n\n  @query('.slide-menu-content')\n  private accessor _slideMenuContent!: HTMLDivElement;\n\n  @property({ attribute: false })\n  accessor height = '40px';\n\n  @property({ attribute: false })\n  accessor showNext = false;\n\n  @property({ attribute: false })\n  accessor showPrevious = false;\n\n  @consume({ context: edgelessToolbarSlotsContext })\n  accessor toolbarSlots!: EdgelessToolbarSlots;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'edgeless-slide-menu': EdgelessSlideMenu;\n  }\n}\n"]}