{"version":3,"file":"font-weight-and-style-panel.js","sourceRoot":"","sources":["../../../../../src/root-block/edgeless/components/panel/font-weight-and-style-panel.ts"],"names":[],"mappings":"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","sourcesContent":["import { TextUtils } from '@lumensuite/affine-block-surface';\nimport { CheckIcon } from '@lumensuite/affine-components/icons';\nimport {\n  FontFamily,\n  FontFamilyMap,\n  FontStyle,\n  FontWeight,\n} from '@lumensuite/affine-model';\nimport { css, html, LitElement, nothing } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\nimport { choose } from 'lit/directives/choose.js';\nimport { join } from 'lit/directives/join.js';\nimport { repeat } from 'lit/directives/repeat.js';\n\nconst FONT_WEIGHT_CHOOSE: [FontWeight, () => string][] = [\n  [FontWeight.Light, () => 'Light'],\n  [FontWeight.Regular, () => 'Regular'],\n  [FontWeight.SemiBold, () => 'Semibold'],\n];\n\n@customElement('edgeless-font-weight-and-style-panel')\nexport class EdgelessFontWeightAndStylePanel extends LitElement {\n  static override styles = css`\n    :host {\n      display: flex;\n      align-items: start;\n      flex-direction: column;\n      min-width: 124px;\n    }\n\n    edgeless-tool-icon-button {\n      width: 100%;\n    }\n  `;\n\n  private _isActive(\n    fontWeight: FontWeight,\n    fontStyle: FontStyle = FontStyle.Normal\n  ) {\n    return this.fontWeight === fontWeight && this.fontStyle === fontStyle;\n  }\n\n  private _isDisabled(\n    fontWeight: FontWeight,\n    fontStyle: FontStyle = FontStyle.Normal\n  ) {\n    // Compatible with old data\n    if (!(this.fontFamily in FontFamilyMap)) return false;\n\n    const fontFace = TextUtils.getFontFaces()\n      .filter(TextUtils.isSameFontFamily(this.fontFamily))\n      .find(\n        fontFace =>\n          fontFace.weight === fontWeight && fontFace.style === fontStyle\n      );\n\n    return !fontFace;\n  }\n\n  private _onSelect(\n    fontWeight: FontWeight,\n    fontStyle: FontStyle = FontStyle.Normal\n  ) {\n    this.fontWeight = fontWeight;\n    this.fontStyle = fontStyle;\n    if (this.onSelect) {\n      this.onSelect(fontWeight, fontStyle);\n    }\n  }\n\n  override render() {\n    let fontFaces = TextUtils.getFontFacesByFontFamily(this.fontFamily);\n    // Compatible with old data\n    if (fontFaces.length === 0) {\n      fontFaces = TextUtils.getFontFacesByFontFamily(FontFamily.Inter);\n    }\n    const fontFacesWithNormal = fontFaces.filter(\n      fontFace => fontFace.style === FontStyle.Normal\n    );\n    const fontFacesWithItalic = fontFaces.filter(\n      fontFace => fontFace.style === FontStyle.Italic\n    );\n\n    return join(\n      [\n        fontFacesWithNormal.length > 0\n          ? repeat(\n              fontFacesWithNormal,\n              fontFace => fontFace.weight,\n              fontFace => {\n                const active = this._isActive(fontFace.weight as FontWeight);\n                return html`\n                  <edgeless-tool-icon-button\n                    data-weight=\"${fontFace.weight}\"\n                    .iconContainerPadding=${[4, 8]}\n                    .justify=${'space-between'}\n                    .disabled=${this._isDisabled(fontFace.weight as FontWeight)}\n                    .active=${active}\n                    @click=${() =>\n                      this._onSelect(fontFace.weight as FontWeight)}\n                  >\n                    ${choose(fontFace.weight, FONT_WEIGHT_CHOOSE)}\n                    ${active ? CheckIcon : nothing}\n                  </edgeless-tool-icon-button>\n                `;\n              }\n            )\n          : nothing,\n        fontFacesWithItalic.length > 0\n          ? repeat(\n              fontFacesWithItalic,\n              fontFace => fontFace.weight,\n              fontFace => {\n                const active = this._isActive(\n                  fontFace.weight as FontWeight,\n                  FontStyle.Italic\n                );\n                return html`\n                  <edgeless-tool-icon-button\n                    data-weight=\"${fontFace.weight} italic\"\n                    .iconContainerPadding=${[4, 8]}\n                    .justify=${'space-between'}\n                    .disabled=${this._isDisabled(\n                      fontFace.weight as FontWeight,\n                      FontStyle.Italic\n                    )}\n                    .active=${active}\n                    @click=${() =>\n                      this._onSelect(\n                        fontFace.weight as FontWeight,\n                        FontStyle.Italic\n                      )}\n                  >\n                    ${choose(fontFace.weight, FONT_WEIGHT_CHOOSE)} Italic\n                    ${active ? CheckIcon : nothing}\n                  </edgeless-tool-icon-button>\n                `;\n              }\n            )\n          : nothing,\n      ].filter(item => item !== nothing),\n      () => html`\n        <edgeless-menu-divider\n          data-orientation=\"horizontal\"\n        ></edgeless-menu-divider>\n      `\n    );\n  }\n\n  @property({ attribute: false })\n  accessor fontFamily = FontFamily.Inter;\n\n  @property({ attribute: false })\n  accessor fontStyle = FontStyle.Normal;\n\n  @property({ attribute: false })\n  accessor fontWeight = FontWeight.Regular;\n\n  @property({ attribute: false })\n  accessor onSelect:\n    | ((fontWeight: FontWeight, fontStyle: FontStyle) => void)\n    | undefined;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'edgeless-font-weight-and-style-panel': EdgelessFontWeightAndStylePanel;\n  }\n}\n"]}