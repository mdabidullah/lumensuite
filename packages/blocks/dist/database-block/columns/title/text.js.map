{"version":3,"file":"text.js","sourceRoot":"","sources":["../../../../src/database-block/columns/title/text.ts"],"names":[],"mappings":"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","sourcesContent":["import type { Text } from '@lumensuite/store';\n\nimport {\n  DefaultInlineManagerExtension,\n  type RichText,\n} from '@lumensuite/affine-components/rich-text';\nimport { QuickSearchProvider } from '@lumensuite/affine-shared/services';\nimport {\n  getViewportElement,\n  isValidUrl,\n} from '@lumensuite/affine-shared/utils';\nimport { BaseCellRenderer } from '@lumensuite/data-view';\nimport { IS_MAC } from '@lumensuite/global/env';\nimport { assertExists } from '@lumensuite/global/utils';\nimport { css } from 'lit';\nimport { customElement, property, query } from 'lit/decorators.js';\nimport { html } from 'lit/static-html.js';\n\nimport type { DatabaseBlockComponent } from '../../database-block.js';\n\nimport { HostContextKey } from '../../context/host-context.js';\n\nconst styles = css`\n  data-view-header-area-text {\n    width: 100%;\n    display: flex;\n  }\n\n  data-view-header-area-text rich-text {\n    pointer-events: none;\n    user-select: none;\n  }\n\n  data-view-header-area-text-editing {\n    width: 100%;\n    display: flex;\n    cursor: text;\n  }\n\n  .data-view-header-area-rich-text {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    width: 100%;\n    height: 100%;\n    outline: none;\n    word-break: break-all;\n    font-size: var(--data-view-cell-text-size);\n    line-height: var(--data-view-cell-text-line-height);\n  }\n\n  .data-view-header-area-rich-text v-line {\n    display: flex !important;\n    align-items: center;\n    height: 100%;\n    width: 100%;\n  }\n\n  .data-view-header-area-rich-text v-line > div {\n    flex-grow: 1;\n  }\n\n  .data-view-header-area-icon {\n    height: max-content;\n    display: flex;\n    align-items: center;\n    margin-right: 8px;\n    padding: 2px;\n    border-radius: 4px;\n    margin-top: 2px;\n    background-color: var(--affine-background-secondary-color);\n  }\n\n  .data-view-header-area-icon svg {\n    width: 14px;\n    height: 14px;\n    fill: var(--affine-icon-color);\n    color: var(--affine-icon-color);\n  }\n`;\n\nabstract class BaseTextCell extends BaseCellRenderer<Text> {\n  static override styles = styles;\n\n  get attributeRenderer() {\n    return this.inlineManager?.getRenderer();\n  }\n\n  get attributesSchema() {\n    return this.inlineManager?.getSchema();\n  }\n\n  get inlineEditor() {\n    assertExists(this.richText);\n    const inlineEditor = this.richText.inlineEditor;\n    assertExists(inlineEditor);\n    return inlineEditor;\n  }\n\n  get inlineManager() {\n    return this.view\n      .getContext(HostContextKey)\n      ?.std.get(DefaultInlineManagerExtension.identifier);\n  }\n\n  get service() {\n    return this.view\n      .getContext(HostContextKey)\n      ?.std.getService('affine:database');\n  }\n\n  get topContenteditableElement() {\n    const databaseBlock =\n      this.closest<DatabaseBlockComponent>('affine-database');\n    return databaseBlock?.topContenteditableElement;\n  }\n\n  renderIcon() {\n    if (!this.showIcon) {\n      return;\n    }\n    const iconColumn = this.view.header$.value.iconColumn;\n    if (!iconColumn) return;\n\n    const icon = this.view.cellGetValue(this.cell.rowId, iconColumn) as string;\n    if (!icon) return;\n\n    return html`<div class=\"data-view-header-area-icon\">${icon}</div>`;\n  }\n\n  @query('rich-text')\n  accessor richText!: RichText;\n\n  @property({ attribute: false })\n  accessor showIcon = false;\n}\n\n@customElement('data-view-header-area-text')\nexport class HeaderAreaTextCell extends BaseTextCell {\n  override render() {\n    return html`${this.renderIcon()}\n      <rich-text\n        .yText=${this.value}\n        .attributesSchema=${this.attributesSchema}\n        .attributeRenderer=${this.attributeRenderer}\n        .embedChecker=${this.inlineManager?.embedChecker}\n        .markdownShortcutHandler=${this.inlineManager?.markdownShortcutHandler}\n        .readonly=${true}\n        class=\"data-view-header-area-rich-text\"\n      ></rich-text>`;\n  }\n}\n\n@customElement('data-view-header-area-text-editing')\nexport class HeaderAreaTextCellEditing extends BaseTextCell {\n  private _onCopy = (e: ClipboardEvent) => {\n    const inlineEditor = this.inlineEditor;\n    assertExists(inlineEditor);\n\n    const inlineRange = inlineEditor.getInlineRange();\n    if (!inlineRange) return;\n\n    const text = inlineEditor.yTextString.slice(\n      inlineRange.index,\n      inlineRange.index + inlineRange.length\n    );\n\n    e.clipboardData?.setData('text/plain', text);\n    e.preventDefault();\n    e.stopPropagation();\n  };\n\n  private _onCut = (e: ClipboardEvent) => {\n    const inlineEditor = this.inlineEditor;\n    assertExists(inlineEditor);\n\n    const inlineRange = inlineEditor.getInlineRange();\n    if (!inlineRange) return;\n\n    const text = inlineEditor.yTextString.slice(\n      inlineRange.index,\n      inlineRange.index + inlineRange.length\n    );\n    inlineEditor.deleteText(inlineRange);\n    inlineEditor.setInlineRange({\n      index: inlineRange.index,\n      length: 0,\n    });\n\n    e.clipboardData?.setData('text/plain', text);\n    e.preventDefault();\n    e.stopPropagation();\n  };\n\n  private _onPaste = async (e: ClipboardEvent) => {\n    const inlineEditor = this.inlineEditor;\n    assertExists(inlineEditor);\n\n    const inlineRange = inlineEditor.getInlineRange();\n    if (!inlineRange) return;\n\n    const text = e.clipboardData\n      ?.getData('text/plain')\n      ?.replace(/\\r?\\n|\\r/g, '\\n');\n    if (!text) return;\n    e.preventDefault();\n    e.stopPropagation();\n    if (isValidUrl(text)) {\n      const std = this.std;\n      const result = await std?.getOptional(QuickSearchProvider)?.searchDoc({\n        userInput: text,\n        skipSelection: true,\n      });\n      if (result && 'docId' in result) {\n        const text = ' ';\n        inlineEditor.insertText(inlineRange, text, {\n          reference: {\n            type: 'LinkedPage',\n            pageId: result.docId,\n          },\n        });\n        inlineEditor.setInlineRange({\n          index: inlineRange.index + text.length,\n          length: 0,\n        });\n      } else {\n        inlineEditor.insertText(inlineRange, text, {\n          link: text,\n        });\n        inlineEditor.setInlineRange({\n          index: inlineRange.index + text.length,\n          length: 0,\n        });\n      }\n    } else {\n      inlineEditor.insertText(inlineRange, text);\n      inlineEditor.setInlineRange({\n        index: inlineRange.index + text.length,\n        length: 0,\n      });\n    }\n  };\n\n  private get std() {\n    const host = this.view.getContext(HostContextKey);\n    return host?.std;\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n    const selectAll = (e: KeyboardEvent) => {\n      if (e.key === 'a' && (IS_MAC ? e.metaKey : e.ctrlKey)) {\n        e.stopPropagation();\n        e.preventDefault();\n        this.inlineEditor.selectAll();\n      }\n    };\n    this.addEventListener('keydown', selectAll);\n    this.disposables.add(() => {\n      this.removeEventListener('keydown', selectAll);\n    });\n  }\n\n  override firstUpdated(props: Map<string, unknown>) {\n    super.firstUpdated(props);\n    this.disposables.addFromEvent(this.richText, 'copy', this._onCopy);\n    this.disposables.addFromEvent(this.richText, 'cut', this._onCut);\n    this.disposables.addFromEvent(this.richText, 'paste', e => {\n      this._onPaste(e).catch(console.error);\n    });\n    this.richText.updateComplete\n      .then(() => {\n        this.inlineEditor.focusEnd();\n\n        this.disposables.add(\n          this.inlineEditor.slots.inlineRangeUpdate.on(([inlineRange]) => {\n            if (inlineRange) {\n              if (!this.isEditing) {\n                this.selectCurrentCell(true);\n              }\n            } else {\n              if (this.isEditing) {\n                this.selectCurrentCell(false);\n              }\n            }\n          })\n        );\n      })\n      .catch(console.error);\n  }\n\n  override render() {\n    return html`${this.renderIcon()}\n      <rich-text\n        .yText=${this.value}\n        .inlineEventSource=${this.topContenteditableElement}\n        .attributesSchema=${this.attributesSchema}\n        .attributeRenderer=${this.attributeRenderer}\n        .embedChecker=${this.inlineManager?.embedChecker}\n        .markdownShortcutHandler=${this.inlineManager?.markdownShortcutHandler}\n        .readonly=${this.readonly}\n        .enableClipboard=${false}\n        .verticalScrollContainerGetter=${() =>\n          this.topContenteditableElement?.host\n            ? getViewportElement(this.topContenteditableElement.host)\n            : null}\n        class=\"data-view-header-area-rich-text can-link-doc\"\n      ></rich-text>`;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'data-view-header-area-text': HeaderAreaTextCell;\n    'data-view-header-area-text-editing': HeaderAreaTextCellEditing;\n  }\n}\n"]}