{"version":3,"file":"html.unit.spec.js","sourceRoot":"","sources":["../../../src/__tests__/adapters/html.unit.spec.ts"],"names":[],"mappings":"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","sourcesContent":["import type { BlockSnapshot } from '@lumensuite/store';\n\nimport {\n  DEFAULT_NOTE_BACKGROUND_COLOR,\n  NoteDisplayMode,\n} from '@lumensuite/affine-model';\nimport { AssetsManager, MemoryBlobCRUD } from '@lumensuite/store';\nimport { describe, expect, test } from 'vitest';\n\nimport { HtmlAdapter } from '../../_common/adapters/html.js';\nimport { nanoidReplacement } from '../../_common/test-utils/test-utils.js';\nimport { createJob } from '../utils/create-job.js';\n\nconst template = (html: string) =>\n  `\n<!doctype html>\n<html>\n<head>\n  <style>\n    input[type='checkbox'] {\n      display: none;\n    }\n    label:before {\n      background: rgb(30, 150, 235);\n      border-radius: 3px;\n      height: 16px;\n      width: 16px;\n      display: inline-block;\n      cursor: pointer;\n    }\n    input[type='checkbox'] + label:before {\n      content: '';\n      background: rgb(30, 150, 235);\n      color: #fff;\n      font-size: 16px;\n      line-height: 16px;\n      text-align: center;\n    }\n    input[type='checkbox']:checked + label:before {\n      content: 'âœ“';\n    }\n  </style>\n</head>\n<body>\n<div style=\"width: 70vw; margin: 60px auto;\"><!--LumenSuiteDocTitlePlaceholder-->\n<!--HtmlTemplate-->\n</div>\n</body>\n</html>\n`\n    .replace(/\\s\\s+|\\n/g, '')\n    .replace('<!--HtmlTemplate-->', html);\n\ndescribe('snapshot to html', () => {\n  test('code', async () => {\n    const blockSnapshot: BlockSnapshot = {\n      type: 'block',\n      id: 'block:vu6SK6WJpW',\n      flavour: 'affine:page',\n      props: {\n        title: {\n          '$lumensuite:internal:text$': true,\n          delta: [],\n        },\n      },\n      children: [\n        {\n          type: 'block',\n          id: 'block:Tk4gSPocAt',\n          flavour: 'affine:surface',\n          props: {\n            elements: {},\n          },\n          children: [],\n        },\n        {\n          type: 'block',\n          id: 'block:WfnS5ZDCJT',\n          flavour: 'affine:note',\n          props: {\n            xywh: '[0,0,800,95]',\n            background: DEFAULT_NOTE_BACKGROUND_COLOR,\n            index: 'a0',\n            hidden: false,\n            displayMode: NoteDisplayMode.DocAndEdgeless,\n          },\n          children: [\n            {\n              type: 'block',\n              id: 'block:8hOLxad5Fv',\n              flavour: 'affine:code',\n              props: {\n                language: 'python',\n                text: {\n                  '$lumensuite:internal:text$': true,\n                  delta: [\n                    {\n                      insert: 'import this',\n                    },\n                  ],\n                },\n              },\n              children: [],\n            },\n          ],\n        },\n      ],\n    };\n\n    const html = template(\n      `<pre class=\"shiki light-plus\" style=\"background-color:#FFFFFF;color:#000000\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#AF00DB\">import</span><span style=\"color:#000000\"> this</span></span></code></pre>`\n    );\n\n    const htmlAdapter = new HtmlAdapter(createJob());\n    const target = await htmlAdapter.fromBlockSnapshot({\n      snapshot: blockSnapshot,\n    });\n    expect(target.file).toBe(html);\n  });\n\n  test('code upper case', async () => {\n    const blockSnapshot: BlockSnapshot = {\n      type: 'block',\n      id: 'block:vu6SK6WJpW',\n      flavour: 'affine:page',\n      props: {\n        title: {\n          '$lumensuite:internal:text$': true,\n          delta: [],\n        },\n      },\n      children: [\n        {\n          type: 'block',\n          id: 'block:Tk4gSPocAt',\n          flavour: 'affine:surface',\n          props: {\n            elements: {},\n          },\n          children: [],\n        },\n        {\n          type: 'block',\n          id: 'block:WfnS5ZDCJT',\n          flavour: 'affine:note',\n          props: {\n            xywh: '[0,0,800,95]',\n            background: DEFAULT_NOTE_BACKGROUND_COLOR,\n            index: 'a0',\n            hidden: false,\n            displayMode: NoteDisplayMode.DocAndEdgeless,\n          },\n          children: [\n            {\n              type: 'block',\n              id: 'block:8hOLxad5Fv',\n              flavour: 'affine:code',\n              props: {\n                language: 'PYTHON',\n                text: {\n                  '$lumensuite:internal:text$': true,\n                  delta: [\n                    {\n                      insert: 'import this',\n                    },\n                  ],\n                },\n              },\n              children: [],\n            },\n          ],\n        },\n      ],\n    };\n\n    const html = template(\n      `<pre class=\"shiki light-plus\" style=\"background-color:#FFFFFF;color:#000000\" tabindex=\"0\"><code><span class=\"line\"><span>import this</span></span></code></pre>`\n    );\n\n    const htmlAdapter = new HtmlAdapter(createJob());\n    const target = await htmlAdapter.fromBlockSnapshot({\n      snapshot: blockSnapshot,\n    });\n    expect(target.file).toBe(html);\n  });\n\n  test('code unknown', async () => {\n    const blockSnapshot: BlockSnapshot = {\n      type: 'block',\n      id: 'block:vu6SK6WJpW',\n      flavour: 'affine:page',\n      props: {\n        title: {\n          '$lumensuite:internal:text$': true,\n          delta: [],\n        },\n      },\n      children: [\n        {\n          type: 'block',\n          id: 'block:Tk4gSPocAt',\n          flavour: 'affine:surface',\n          props: {\n            elements: {},\n          },\n          children: [],\n        },\n        {\n          type: 'block',\n          id: 'block:WfnS5ZDCJT',\n          flavour: 'affine:note',\n          props: {\n            xywh: '[0,0,800,95]',\n            background: DEFAULT_NOTE_BACKGROUND_COLOR,\n            index: 'a0',\n            hidden: false,\n            displayMode: NoteDisplayMode.DocAndEdgeless,\n          },\n          children: [\n            {\n              type: 'block',\n              id: 'block:8hOLxad5Fv',\n              flavour: 'affine:code',\n              props: {\n                language: 'unknown',\n                text: {\n                  '$lumensuite:internal:text$': true,\n                  delta: [\n                    {\n                      insert: 'import this',\n                    },\n                  ],\n                },\n              },\n              children: [],\n            },\n          ],\n        },\n      ],\n    };\n\n    const html = template(\n      `<pre class=\"shiki light-plus\" style=\"background-color:#FFFFFF;color:#000000\" tabindex=\"0\"><code><span class=\"line\"><span>import this</span></span></code></pre>`\n    );\n\n    const htmlAdapter = new HtmlAdapter(createJob());\n    const target = await htmlAdapter.fromBlockSnapshot({\n      snapshot: blockSnapshot,\n    });\n    expect(target.file).toBe(html);\n  });\n\n  test('paragraph', async () => {\n    const blockSnapshot: BlockSnapshot = {\n      type: 'block',\n      id: 'block:vu6SK6WJpW',\n      flavour: 'affine:page',\n      props: {\n        title: {\n          '$lumensuite:internal:text$': true,\n          delta: [],\n        },\n      },\n      children: [\n        {\n          type: 'block',\n          id: 'block:Tk4gSPocAt',\n          flavour: 'affine:surface',\n          props: {\n            elements: {},\n          },\n          children: [],\n        },\n        {\n          type: 'block',\n          id: 'block:WfnS5ZDCJT',\n          flavour: 'affine:note',\n          props: {\n            xywh: '[0,0,800,95]',\n            background: DEFAULT_NOTE_BACKGROUND_COLOR,\n            index: 'a0',\n            hidden: false,\n            displayMode: NoteDisplayMode.DocAndEdgeless,\n          },\n          children: [\n            {\n              type: 'block',\n              id: 'block:Bdn8Yvqcny',\n              flavour: 'affine:paragraph',\n              props: {\n                type: 'text',\n                text: {\n                  '$lumensuite:internal:text$': true,\n                  delta: [\n                    {\n                      insert: 'aaa',\n                    },\n                  ],\n                },\n              },\n              children: [\n                {\n                  type: 'block',\n                  id: 'block:72SMa5mdLy',\n                  flavour: 'affine:paragraph',\n                  props: {\n                    type: 'text',\n                    text: {\n                      '$lumensuite:internal:text$': true,\n                      delta: [\n                        {\n                          insert: 'bbb',\n                        },\n                      ],\n                    },\n                  },\n                  children: [],\n                },\n                {\n                  type: 'block',\n                  id: 'block:f-Z6nRrGK_',\n                  flavour: 'affine:paragraph',\n                  props: {\n                    type: 'text',\n                    text: {\n                      '$lumensuite:internal:text$': true,\n                      delta: [\n                        {\n                          insert: 'ccc',\n                        },\n                      ],\n                    },\n                  },\n                  children: [\n                    {\n                      type: 'block',\n                      id: 'block:sP3bU52el7',\n                      flavour: 'affine:paragraph',\n                      props: {\n                        type: 'text',\n                        text: {\n                          '$lumensuite:internal:text$': true,\n                          delta: [\n                            {\n                              insert: 'ddd',\n                            },\n                          ],\n                        },\n                      },\n                      children: [],\n                    },\n                    {\n                      type: 'block',\n                      id: 'block:X_HMxP4wxC',\n                      flavour: 'affine:paragraph',\n                      props: {\n                        type: 'text',\n                        text: {\n                          '$lumensuite:internal:text$': true,\n                          delta: [\n                            {\n                              insert: 'eee',\n                            },\n                          ],\n                        },\n                      },\n                      children: [],\n                    },\n                    {\n                      type: 'block',\n                      id: 'block:iA34Rb-RvV',\n                      flavour: 'affine:paragraph',\n                      props: {\n                        text: {\n                          '$lumensuite:internal:text$': true,\n                          delta: [\n                            {\n                              insert: 'fff',\n                            },\n                          ],\n                        },\n                        type: 'text',\n                      },\n                      children: [],\n                    },\n                  ],\n                },\n                {\n                  type: 'block',\n                  id: 'block:I0Fmz5Nv02',\n                  flavour: 'affine:paragraph',\n                  props: {\n                    type: 'text',\n                    text: {\n                      '$lumensuite:internal:text$': true,\n                      delta: [\n                        {\n                          insert: 'ggg',\n                        },\n                      ],\n                    },\n                  },\n                  children: [],\n                },\n              ],\n            },\n            {\n              type: 'block',\n              id: 'block:12lDwMD7ec',\n              flavour: 'affine:paragraph',\n              props: {\n                type: 'text',\n                text: {\n                  '$lumensuite:internal:text$': true,\n                  delta: [\n                    {\n                      insert: 'hhh',\n                    },\n                  ],\n                },\n              },\n              children: [],\n            },\n          ],\n        },\n      ],\n    };\n    const html = template(\n      `<div class=\"affine-paragraph-block-container\"><p>aaa</p><div class=\"affine-block-children-container\" style=\"padding-left: 26px;\"><div class=\"affine-paragraph-block-container\"><p>bbb</p><div class=\"affine-block-children-container\" style=\"padding-left: 26px;\"></div></div><div class=\"affine-paragraph-block-container\"><p>ccc</p><div class=\"affine-block-children-container\" style=\"padding-left: 26px;\"><div class=\"affine-paragraph-block-container\"><p>ddd</p><div class=\"affine-block-children-container\" style=\"padding-left: 26px;\"></div></div><div class=\"affine-paragraph-block-container\"><p>eee</p><div class=\"affine-block-children-container\" style=\"padding-left: 26px;\"></div></div><div class=\"affine-paragraph-block-container\"><p>fff</p><div class=\"affine-block-children-container\" style=\"padding-left: 26px;\"></div></div></div></div><div class=\"affine-paragraph-block-container\"><p>ggg</p><div class=\"affine-block-children-container\" style=\"padding-left: 26px;\"></div></div></div></div><div class=\"affine-paragraph-block-container\"><p>hhh</p><div class=\"affine-block-children-container\" style=\"padding-left: 26px;\"></div></div>`\n    );\n\n    const htmlAdapter = new HtmlAdapter(createJob());\n    const target = await htmlAdapter.fromBlockSnapshot({\n      snapshot: blockSnapshot,\n    });\n    expect(target.file).toBe(html);\n  });\n\n  test('bulleted list', async () => {\n    const blockSnapshot: BlockSnapshot = {\n      type: 'block',\n      id: 'block:vu6SK6WJpW',\n      flavour: 'affine:page',\n      props: {\n        title: {\n          '$lumensuite:internal:text$': true,\n          delta: [],\n        },\n      },\n      children: [\n        {\n          type: 'block',\n          id: 'block:Tk4gSPocAt',\n          flavour: 'affine:surface',\n          props: {\n            elements: {},\n          },\n          children: [],\n        },\n        {\n          type: 'block',\n          id: 'block:WfnS5ZDCJT',\n          flavour: 'affine:note',\n          props: {\n            xywh: '[0,0,800,95]',\n            background: DEFAULT_NOTE_BACKGROUND_COLOR,\n            index: 'a0',\n            hidden: false,\n            displayMode: NoteDisplayMode.DocAndEdgeless,\n          },\n          children: [\n            {\n              type: 'block',\n              id: 'block:imiLDMKSkx',\n              flavour: 'affine:list',\n              props: {\n                type: 'bulleted',\n                text: {\n                  '$lumensuite:internal:text$': true,\n                  delta: [\n                    {\n                      insert: 'aaa',\n                    },\n                  ],\n                },\n                checked: false,\n                collapsed: false,\n              },\n              children: [\n                {\n                  type: 'block',\n                  id: 'block:kYliRIovvL',\n                  flavour: 'affine:list',\n                  props: {\n                    type: 'bulleted',\n                    text: {\n                      '$lumensuite:internal:text$': true,\n                      delta: [\n                        {\n                          insert: 'bbb',\n                        },\n                      ],\n                    },\n                    checked: false,\n                    collapsed: false,\n                  },\n                  children: [\n                    {\n                      type: 'block',\n                      id: 'block:UyvxA_gqCJ',\n                      flavour: 'affine:list',\n                      props: {\n                        type: 'bulleted',\n                        text: {\n                          '$lumensuite:internal:text$': true,\n                          delta: [\n                            {\n                              insert: 'ccc',\n                            },\n                          ],\n                        },\n                        checked: false,\n                        collapsed: false,\n                      },\n                      children: [],\n                    },\n                  ],\n                },\n                {\n                  type: 'block',\n                  id: 'block:-guNZRm5u1',\n                  flavour: 'affine:list',\n                  props: {\n                    type: 'bulleted',\n                    text: {\n                      '$lumensuite:internal:text$': true,\n                      delta: [\n                        {\n                          insert: 'ddd',\n                        },\n                      ],\n                    },\n                    checked: false,\n                    collapsed: false,\n                  },\n                  children: [],\n                },\n              ],\n            },\n            {\n              type: 'block',\n              id: 'block:B9CaZzQ2CO',\n              flavour: 'affine:list',\n              props: {\n                type: 'bulleted',\n                text: {\n                  '$lumensuite:internal:text$': true,\n                  delta: [\n                    {\n                      insert: 'eee',\n                    },\n                  ],\n                },\n                checked: false,\n                collapsed: false,\n              },\n              children: [],\n            },\n          ],\n        },\n      ],\n    };\n    const html = template(\n      `<div class=\"affine-list-block-container\"><ul style=\"\"><li>aaa</li></ul><div class=\"affine-block-children-container\" style=\"padding-left: 26px;\"><div class=\"affine-list-block-container\"><ul style=\"\"><li>bbb</li></ul><div class=\"affine-block-children-container\" style=\"padding-left: 26px;\"><div class=\"affine-list-block-container\"><ul style=\"\"><li>ccc</li></ul><div class=\"affine-block-children-container\" style=\"padding-left: 26px;\"></div></div></div></div><div class=\"affine-list-block-container\"><ul style=\"\"><li>ddd</li></ul><div class=\"affine-block-children-container\" style=\"padding-left: 26px;\"></div></div></div></div><div class=\"affine-list-block-container\"><ul style=\"\"><li>eee</li></ul><div class=\"affine-block-children-container\" style=\"padding-left: 26px;\"></div></div>`\n    );\n\n    const htmlAdapter = new HtmlAdapter(createJob());\n    const target = await htmlAdapter.fromBlockSnapshot({\n      snapshot: blockSnapshot,\n    });\n    expect(target.file).toBe(html);\n  });\n\n  test('code inline', async () => {\n    const blockSnapshot: BlockSnapshot = {\n      type: 'block',\n      id: 'block:vu6SK6WJpW',\n      flavour: 'affine:page',\n      props: {\n        title: {\n          '$lumensuite:internal:text$': true,\n          delta: [],\n        },\n      },\n      children: [\n        {\n          type: 'block',\n          id: 'block:Tk4gSPocAt',\n          flavour: 'affine:surface',\n          props: {\n            elements: {},\n          },\n          children: [],\n        },\n        {\n          type: 'block',\n          id: 'block:WfnS5ZDCJT',\n          flavour: 'affine:note',\n          props: {\n            xywh: '[0,0,800,95]',\n            background: DEFAULT_NOTE_BACKGROUND_COLOR,\n            index: 'a0',\n            hidden: false,\n            displayMode: NoteDisplayMode.DocAndEdgeless,\n          },\n          children: [\n            {\n              type: 'block',\n              id: 'block:qhpbuss-KN',\n              flavour: 'affine:paragraph',\n              props: {\n                type: 'text',\n                text: {\n                  '$lumensuite:internal:text$': true,\n                  delta: [\n                    {\n                      insert: 'aaa ',\n                    },\n                    {\n                      insert: 'bbb',\n                      attributes: {\n                        code: true,\n                      },\n                    },\n                    {\n                      insert: ' ccc',\n                    },\n                  ],\n                },\n              },\n              children: [],\n            },\n          ],\n        },\n      ],\n    };\n    const html = template(\n      `<div class=\"affine-paragraph-block-container\"><p>aaa <code>bbb</code> ccc</p><div class=\"affine-block-children-container\" style=\"padding-left: 26px;\"></div></div>`\n    );\n\n    const htmlAdapter = new HtmlAdapter(createJob());\n    const target = await htmlAdapter.fromBlockSnapshot({\n      snapshot: blockSnapshot,\n    });\n    expect(target.file).toBe(html);\n  });\n\n  test('link', async () => {\n    const blockSnapshot: BlockSnapshot = {\n      type: 'block',\n      id: 'block:vu6SK6WJpW',\n      flavour: 'affine:page',\n      props: {\n        title: {\n          '$lumensuite:internal:text$': true,\n          delta: [],\n        },\n      },\n      children: [\n        {\n          type: 'block',\n          id: 'block:Tk4gSPocAt',\n          flavour: 'affine:surface',\n          props: {\n            elements: {},\n          },\n          children: [],\n        },\n        {\n          type: 'block',\n          id: 'block:WfnS5ZDCJT',\n          flavour: 'affine:note',\n          props: {\n            xywh: '[0,0,800,95]',\n            background: DEFAULT_NOTE_BACKGROUND_COLOR,\n            index: 'a0',\n            hidden: false,\n            displayMode: NoteDisplayMode.DocAndEdgeless,\n          },\n          children: [\n            {\n              type: 'block',\n              id: 'block:Bdn8Yvqcny',\n              flavour: 'affine:paragraph',\n              props: {\n                type: 'text',\n                text: {\n                  '$lumensuite:internal:text$': true,\n                  delta: [\n                    {\n                      insert: 'aaa ',\n                    },\n                    {\n                      insert: 'bbb',\n                      attributes: {\n                        link: 'https://affine.pro/',\n                      },\n                    },\n                    {\n                      insert: ' ccc',\n                    },\n                  ],\n                },\n              },\n              children: [],\n            },\n          ],\n        },\n      ],\n    };\n    const html = template(\n      `<div class=\"affine-paragraph-block-container\"><p>aaa <a href=\"https://affine.pro/\">bbb</a> ccc</p><div class=\"affine-block-children-container\" style=\"padding-left: 26px;\"></div></div>`\n    );\n\n    const htmlAdapter = new HtmlAdapter(createJob());\n    const target = await htmlAdapter.fromBlockSnapshot({\n      snapshot: blockSnapshot,\n    });\n    expect(target.file).toBe(html);\n  });\n\n  test('bold', async () => {\n    const blockSnapshot: BlockSnapshot = {\n      type: 'block',\n      id: 'block:vu6SK6WJpW',\n      flavour: 'affine:page',\n      props: {\n        title: {\n          '$lumensuite:internal:text$': true,\n          delta: [],\n        },\n      },\n      children: [\n        {\n          type: 'block',\n          id: 'block:Tk4gSPocAt',\n          flavour: 'affine:surface',\n          props: {\n            elements: {},\n          },\n          children: [],\n        },\n        {\n          type: 'block',\n          id: 'block:WfnS5ZDCJT',\n          flavour: 'affine:note',\n          props: {\n            xywh: '[0,0,800,95]',\n            background: DEFAULT_NOTE_BACKGROUND_COLOR,\n            index: 'a0',\n            hidden: false,\n            displayMode: NoteDisplayMode.DocAndEdgeless,\n          },\n          children: [\n            {\n              type: 'block',\n              id: 'block:zxDyvrg1Mh',\n              flavour: 'affine:paragraph',\n              props: {\n                type: 'text',\n                text: {\n                  '$lumensuite:internal:text$': true,\n                  delta: [\n                    {\n                      insert: 'aaa',\n                    },\n                    {\n                      insert: 'bbb',\n                      attributes: {\n                        bold: true,\n                      },\n                    },\n                    {\n                      insert: 'ccc',\n                    },\n                  ],\n                },\n              },\n              children: [],\n            },\n          ],\n        },\n      ],\n    };\n\n    const html = template(\n      `<div class=\"affine-paragraph-block-container\"><p>aaa<strong>bbb</strong>ccc</p><div class=\"affine-block-children-container\" style=\"padding-left: 26px;\"></div></div>`\n    );\n\n    const htmlAdapter = new HtmlAdapter(createJob());\n    const target = await htmlAdapter.fromBlockSnapshot({\n      snapshot: blockSnapshot,\n    });\n    expect(target.file).toBe(html);\n  });\n\n  test('italic', async () => {\n    const blockSnapshot: BlockSnapshot = {\n      type: 'block',\n      id: 'block:vu6SK6WJpW',\n      flavour: 'affine:page',\n      props: {\n        title: {\n          '$lumensuite:internal:text$': true,\n          delta: [],\n        },\n      },\n      children: [\n        {\n          type: 'block',\n          id: 'block:Tk4gSPocAt',\n          flavour: 'affine:surface',\n          props: {\n            elements: {},\n          },\n          children: [],\n        },\n        {\n          type: 'block',\n          id: 'block:WfnS5ZDCJT',\n          flavour: 'affine:note',\n          props: {\n            xywh: '[0,0,800,95]',\n            background: DEFAULT_NOTE_BACKGROUND_COLOR,\n            index: 'a0',\n            hidden: false,\n            displayMode: NoteDisplayMode.DocAndEdgeless,\n          },\n          children: [\n            {\n              type: 'block',\n              id: 'block:zxDyvrg1Mh',\n              flavour: 'affine:paragraph',\n              props: {\n                type: 'text',\n                text: {\n                  '$lumensuite:internal:text$': true,\n                  delta: [\n                    {\n                      insert: 'aaa',\n                    },\n                    {\n                      insert: 'bbb',\n                      attributes: {\n                        italic: true,\n                      },\n                    },\n                    {\n                      insert: 'ccc',\n                    },\n                  ],\n                },\n              },\n              children: [],\n            },\n          ],\n        },\n      ],\n    };\n\n    const html = template(\n      `<div class=\"affine-paragraph-block-container\"><p>aaa<em>bbb</em>ccc</p><div class=\"affine-block-children-container\" style=\"padding-left: 26px;\"></div></div>`\n    );\n\n    const htmlAdapter = new HtmlAdapter(createJob());\n    const target = await htmlAdapter.fromBlockSnapshot({\n      snapshot: blockSnapshot,\n    });\n    expect(target.file).toBe(html);\n  });\n\n  test('image', async () => {\n    const blockSnapshot: BlockSnapshot = {\n      type: 'block',\n      id: 'block:WcYcyv-oZY',\n      flavour: 'affine:page',\n      props: {\n        title: {\n          '$lumensuite:internal:text$': true,\n          delta: [],\n        },\n      },\n      children: [\n        {\n          type: 'block',\n          id: 'block:zqtuv999Ww',\n          flavour: 'affine:surface',\n          props: {\n            elements: {},\n          },\n          children: [],\n        },\n        {\n          type: 'block',\n          id: 'block:UTUZojv22c',\n          flavour: 'affine:note',\n          props: {\n            xywh: '[0,0,800,95]',\n            background: DEFAULT_NOTE_BACKGROUND_COLOR,\n            index: 'a0',\n            hidden: false,\n            displayMode: NoteDisplayMode.DocAndEdgeless,\n          },\n          children: [\n            {\n              type: 'block',\n              id: 'block:Gan31s-dYK',\n              flavour: 'affine:image',\n              props: {\n                sourceId: 'YXXTjRmLlNyiOUnHb8nAIvUP6V7PAXhwW9F5_tc2LGs=',\n                caption: 'aaa',\n                width: 0,\n                height: 0,\n                index: 'a0',\n                xywh: '[0,0,0,0]',\n                rotate: 0,\n              },\n              children: [],\n            },\n            {\n              type: 'block',\n              id: 'block:If92CIQiOl',\n              flavour: 'affine:paragraph',\n              props: {\n                type: 'text',\n                text: {\n                  '$lumensuite:internal:text$': true,\n                  delta: [],\n                },\n              },\n              children: [],\n            },\n          ],\n        },\n      ],\n    };\n\n    const html = template(\n      `<figure class=\"affine-image-block-container\"><img src=\"assets/YXXTjRmLlNyiOUnHb8nAIvUP6V7PAXhwW9F5_tc2LGs=.blob\" alt=\"YXXTjRmLlNyiOUnHb8nAIvUP6V7PAXhwW9F5_tc2LGs=.blob\" title=\"aaa\"></figure><div class=\"affine-paragraph-block-container\"><p></p><div class=\"affine-block-children-container\" style=\"padding-left: 26px;\"></div></div>`\n    );\n\n    const htmlAdapter = new HtmlAdapter(createJob());\n    const blobManager = new MemoryBlobCRUD();\n    await blobManager.set(\n      'YXXTjRmLlNyiOUnHb8nAIvUP6V7PAXhwW9F5_tc2LGs=',\n      new Blob()\n    );\n    const assets = new AssetsManager({ blob: blobManager });\n\n    const target = await htmlAdapter.fromBlockSnapshot({\n      snapshot: blockSnapshot,\n      assets,\n    });\n    expect(target.file).toBe(html);\n  });\n});\n\ndescribe('html to snapshot', () => {\n  test('code', async () => {\n    const html = template(\n      `<pre><code class=\"code-python\"><span style=\"word-wrap: break-word; color: #81A1C1;\">import</span><span style=\"word-wrap: break-word; color: #D8DEE9FF;\"> this</span></code></pre>`\n    );\n\n    const blockSnapshot: BlockSnapshot = {\n      type: 'block',\n      id: 'matchesReplaceMap[0]',\n      flavour: 'affine:note',\n      props: {\n        xywh: '[0,0,800,95]',\n        background: DEFAULT_NOTE_BACKGROUND_COLOR,\n        index: 'a0',\n        hidden: false,\n        displayMode: NoteDisplayMode.DocAndEdgeless,\n      },\n      children: [\n        {\n          type: 'block',\n          id: 'matchesReplaceMap[1]',\n          flavour: 'affine:code',\n          props: {\n            language: 'python',\n            text: {\n              '$lumensuite:internal:text$': true,\n              delta: [\n                {\n                  insert: 'import this',\n                },\n              ],\n            },\n          },\n          children: [],\n        },\n      ],\n    };\n\n    const htmlAdapter = new HtmlAdapter(createJob());\n    const rawBlockSnapshot = await htmlAdapter.toBlockSnapshot({\n      file: html,\n    });\n    expect(nanoidReplacement(rawBlockSnapshot)).toEqual(blockSnapshot);\n  });\n\n  test('paragraph', async () => {\n    const html = template(`<p>aaa</p><p>bbb</p><p>ccc</p><p>ddd</p><p>eee</p>`);\n\n    const blockSnapshot: BlockSnapshot = {\n      type: 'block',\n      id: 'matchesReplaceMap[0]',\n      flavour: 'affine:note',\n      props: {\n        xywh: '[0,0,800,95]',\n        background: DEFAULT_NOTE_BACKGROUND_COLOR,\n        index: 'a0',\n        hidden: false,\n        displayMode: NoteDisplayMode.DocAndEdgeless,\n      },\n      children: [\n        {\n          type: 'block',\n          id: 'matchesReplaceMap[1]',\n          flavour: 'affine:paragraph',\n          props: {\n            type: 'text',\n            text: {\n              '$lumensuite:internal:text$': true,\n              delta: [\n                {\n                  insert: 'aaa',\n                },\n              ],\n            },\n          },\n          children: [],\n        },\n        {\n          type: 'block',\n          id: 'matchesReplaceMap[2]',\n          flavour: 'affine:paragraph',\n          props: {\n            type: 'text',\n            text: {\n              '$lumensuite:internal:text$': true,\n              delta: [\n                {\n                  insert: 'bbb',\n                },\n              ],\n            },\n          },\n          children: [],\n        },\n        {\n          type: 'block',\n          id: 'matchesReplaceMap[3]',\n          flavour: 'affine:paragraph',\n          props: {\n            type: 'text',\n            text: {\n              '$lumensuite:internal:text$': true,\n              delta: [\n                {\n                  insert: 'ccc',\n                },\n              ],\n            },\n          },\n          children: [],\n        },\n        {\n          type: 'block',\n          id: 'matchesReplaceMap[4]',\n          flavour: 'affine:paragraph',\n          props: {\n            type: 'text',\n            text: {\n              '$lumensuite:internal:text$': true,\n              delta: [\n                {\n                  insert: 'ddd',\n                },\n              ],\n            },\n          },\n          children: [],\n        },\n        {\n          type: 'block',\n          id: 'matchesReplaceMap[5]',\n          flavour: 'affine:paragraph',\n          props: {\n            type: 'text',\n            text: {\n              '$lumensuite:internal:text$': true,\n              delta: [\n                {\n                  insert: 'eee',\n                },\n              ],\n            },\n          },\n          children: [],\n        },\n      ],\n    };\n\n    const htmlAdapter = new HtmlAdapter(createJob());\n    const rawBlockSnapshot = await htmlAdapter.toBlockSnapshot({\n      file: html,\n    });\n    expect(nanoidReplacement(rawBlockSnapshot)).toEqual(blockSnapshot);\n  });\n\n  test('p in list', async () => {\n    const html = template(`<ol><li><p>p in list</p></li></ol>`);\n\n    const blockSnapshot: BlockSnapshot = {\n      type: 'block',\n      id: 'matchesReplaceMap[0]',\n      flavour: 'affine:note',\n      props: {\n        xywh: '[0,0,800,95]',\n        background: DEFAULT_NOTE_BACKGROUND_COLOR,\n        index: 'a0',\n        hidden: false,\n        displayMode: NoteDisplayMode.DocAndEdgeless,\n      },\n      children: [\n        {\n          type: 'block',\n          id: 'matchesReplaceMap[1]',\n          flavour: 'affine:list',\n          props: {\n            type: 'numbered',\n            text: {\n              '$lumensuite:internal:text$': true,\n              delta: [\n                {\n                  insert: 'p in list',\n                },\n              ],\n            },\n            checked: false,\n            collapsed: false,\n          },\n          children: [],\n        },\n      ],\n    };\n\n    const htmlAdapter = new HtmlAdapter(createJob());\n    const rawBlockSnapshot = await htmlAdapter.toBlockSnapshot({\n      file: html,\n    });\n    expect(nanoidReplacement(rawBlockSnapshot)).toEqual(blockSnapshot);\n  });\n\n  test('iframe', async () => {\n    const html = template(\n      `<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/QDsd0nyzwz0?start=&amp;end=\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe>`\n    );\n\n    const blockSnapshot: BlockSnapshot = {\n      type: 'block',\n      id: 'matchesReplaceMap[0]',\n      flavour: 'affine:note',\n      props: {\n        xywh: '[0,0,800,95]',\n        background: DEFAULT_NOTE_BACKGROUND_COLOR,\n        index: 'a0',\n        hidden: false,\n        displayMode: NoteDisplayMode.DocAndEdgeless,\n      },\n      children: [\n        {\n          type: 'block',\n          id: 'matchesReplaceMap[1]',\n          flavour: 'affine:embed-youtube',\n          props: {\n            url: 'https://www.youtube.com/watch?v=QDsd0nyzwz0',\n          },\n          children: [],\n        },\n      ],\n    };\n\n    const htmlAdapter = new HtmlAdapter(createJob());\n    const rawBlockSnapshot = await htmlAdapter.toBlockSnapshot({\n      file: html,\n    });\n    expect(nanoidReplacement(rawBlockSnapshot)).toEqual(blockSnapshot);\n  });\n\n  test('wrap', async () => {\n    const html = template(\n      `<p>a\\n aa</p><p>b\\t bb</p><p>c  cc</p><p>ddd</p><p>eee</p>`\n    );\n\n    const blockSnapshot: BlockSnapshot = {\n      type: 'block',\n      id: 'matchesReplaceMap[0]',\n      flavour: 'affine:note',\n      props: {\n        xywh: '[0,0,800,95]',\n        background: DEFAULT_NOTE_BACKGROUND_COLOR,\n        index: 'a0',\n        hidden: false,\n        displayMode: NoteDisplayMode.DocAndEdgeless,\n      },\n      children: [\n        {\n          type: 'block',\n          id: 'matchesReplaceMap[1]',\n          flavour: 'affine:paragraph',\n          props: {\n            type: 'text',\n            text: {\n              '$lumensuite:internal:text$': true,\n              delta: [\n                {\n                  insert: 'a aa',\n                },\n              ],\n            },\n          },\n          children: [],\n        },\n        {\n          type: 'block',\n          id: 'matchesReplaceMap[2]',\n          flavour: 'affine:paragraph',\n          props: {\n            type: 'text',\n            text: {\n              '$lumensuite:internal:text$': true,\n              delta: [\n                {\n                  insert: 'b bb',\n                },\n              ],\n            },\n          },\n          children: [],\n        },\n        {\n          type: 'block',\n          id: 'matchesReplaceMap[3]',\n          flavour: 'affine:paragraph',\n          props: {\n            type: 'text',\n            text: {\n              '$lumensuite:internal:text$': true,\n              delta: [\n                {\n                  insert: 'c cc',\n                },\n              ],\n            },\n          },\n          children: [],\n        },\n        {\n          type: 'block',\n          id: 'matchesReplaceMap[4]',\n          flavour: 'affine:paragraph',\n          props: {\n            type: 'text',\n            text: {\n              '$lumensuite:internal:text$': true,\n              delta: [\n                {\n                  insert: 'ddd',\n                },\n              ],\n            },\n          },\n          children: [],\n        },\n        {\n          type: 'block',\n          id: 'matchesReplaceMap[5]',\n          flavour: 'affine:paragraph',\n          props: {\n            type: 'text',\n            text: {\n              '$lumensuite:internal:text$': true,\n              delta: [\n                {\n                  insert: 'eee',\n                },\n              ],\n            },\n          },\n          children: [],\n        },\n      ],\n    };\n\n    const htmlAdapter = new HtmlAdapter(createJob());\n    const rawBlockSnapshot = await htmlAdapter.toBlockSnapshot({\n      file: html,\n    });\n    expect(nanoidReplacement(rawBlockSnapshot)).toEqual(blockSnapshot);\n  });\n});\n"]}