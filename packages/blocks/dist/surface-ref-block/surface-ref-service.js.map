{"version":3,"file":"surface-ref-service.js","sourceRoot":"","sources":["../../src/surface-ref-block/surface-ref-service.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,qBAAqB,EAAE,MAAM,0BAA0B,CAAC;AACjE,OAAO,EAAE,YAAY,EAAE,MAAM,uBAAuB,CAAC;AAErD,OAAO,EAAE,kBAAkB,EAAE,MAAM,2BAA2B,CAAC;AAE/D,MAAM,OAAO,sBAAuB,SAAQ,YAAY;IAAxD;;QAGU,iBAAY,GAAG,IAAI,GAAG,EAA8B,CAAC;IAoB/D,CAAC;aAtB0B,YAAO,GAAG,qBAAqB,CAAC,KAAK,CAAC,OAAO,AAAtC,CAAuC;IAIvE,WAAW,CAAC,EAAU,EAAE,MAAW,IAAI,CAAC,GAAG,EAAE,cAAc,GAAG,KAAK;QACjE,IAAI,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC;YAC9B,OAAO,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE,CAAE,CAAC;QACpC,CAAC;QACD,MAAM,QAAQ,GAAG,IAAI,kBAAkB,CAAC,EAAE,EAAE,GAAG,EAAE,IAAI,CAAC,GAAG,EAAE;YACzD,oBAAoB,EAAE,cAAc;SACrC,CAAC,CAAC;QACH,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;QACpC,OAAO,QAAQ,CAAC;IAClB,CAAC;IAED,cAAc,CAAC,EAAU;QACvB,MAAM,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;QAC3C,IAAI,QAAQ,EAAE,CAAC;YACb,QAAQ,CAAC,OAAO,EAAE,CAAC;YACnB,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;QAC/B,CAAC;IACH,CAAC","sourcesContent":["import type { Doc } from '@lumensuite/store';\n\nimport { SurfaceRefBlockSchema } from '@lumensuite/affine-model';\nimport { BlockService } from '@lumensuite/block-std';\n\nimport { SurfaceRefRenderer } from './surface-ref-renderer.js';\n\nexport class SurfaceRefBlockService extends BlockService {\n  static override readonly flavour = SurfaceRefBlockSchema.model.flavour;\n\n  private _rendererMap = new Map<string, SurfaceRefRenderer>();\n\n  getRenderer(id: string, doc: Doc = this.doc, stackingCanvas = false) {\n    if (this._rendererMap.has(id)) {\n      return this._rendererMap.get(id)!;\n    }\n    const renderer = new SurfaceRefRenderer(id, doc, this.std, {\n      enableStackingCanvas: stackingCanvas,\n    });\n    this._rendererMap.set(id, renderer);\n    return renderer;\n  }\n\n  removeRenderer(id: string) {\n    const renderer = this._rendererMap.get(id);\n    if (renderer) {\n      renderer.unmount();\n      this._rendererMap.delete(id);\n    }\n  }\n}\n"]}