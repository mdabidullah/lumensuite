{"version":3,"file":"frame-panel-body.js","sourceRoot":"","sources":["../../../../src/fragments/frame-panel/body/frame-panel-body.ts"],"names":[],"mappings":"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","sourcesContent":["import type { Doc } from '@lumensuite/store';\n\nimport { CommonUtils } from '@lumensuite/affine-block-surface';\nimport {\n  type EditorHost,\n  ShadowlessElement,\n  WithDisposable,\n} from '@lumensuite/block-std';\nimport {\n  DocModeProvider,\n  type EdgelessRootBlockComponent,\n  type FrameBlockModel,\n} from '@lumensuite/blocks';\nimport { Bound, DisposableGroup } from '@lumensuite/global/utils';\nimport { css, html, nothing, type PropertyValues } from 'lit';\nimport { customElement, property, query, state } from 'lit/decorators.js';\nimport { repeat } from 'lit/directives/repeat.js';\n\nimport type {\n  DragEvent,\n  FitViewEvent,\n  FrameCard,\n  SelectEvent,\n} from '../card/frame-card.js';\n\nimport '../card/frame-card.js';\nimport { startDragging } from '../utils/drag.js';\n\ntype FrameListItem = {\n  frame: FrameBlockModel;\n\n  // frame index\n  frameIndex: string;\n\n  // card index\n  cardIndex: number;\n};\n\nconst styles = css`\n  .frame-list-container {\n    display: flex;\n    align-items: start;\n    box-sizing: border-box;\n    flex-direction: column;\n    width: 100%;\n    gap: 16px;\n    position: relative;\n    margin: 0 8px;\n  }\n\n  .no-frame-container {\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    min-width: 300px;\n  }\n\n  .no-frame-placeholder {\n    margin-top: 240px;\n    align-self: center;\n    width: 230px;\n    height: 48px;\n    color: var(--affine-text-secondary-color, #8e8d91);\n    text-align: center;\n\n    /* light/base */\n    font-size: 15px;\n    font-style: normal;\n    font-weight: 400;\n    line-height: 24px;\n  }\n\n  .insert-indicator {\n    height: 2px;\n    border-radius: 1px;\n    background-color: var(--affine-blue-600);\n    position: absolute;\n    contain: layout size;\n    width: 284px;\n    left: 0;\n  }\n`;\n\nexport const AFFINE_FRAME_PANEL_BODY = 'affine-frame-panel-body';\n\n@customElement(AFFINE_FRAME_PANEL_BODY)\nexport class FramePanelBody extends WithDisposable(ShadowlessElement) {\n  static override styles = styles;\n\n  private _clearDocDisposables = () => {\n    this._docDisposables?.dispose();\n    this._docDisposables = null;\n  };\n\n  /**\n   * click at blank area to clear selection\n   */\n  private _clickBlank = (e: MouseEvent) => {\n    e.stopPropagation();\n    // check if click at frame-card, if not, set this._selected to empty\n    if (\n      (e.target as HTMLElement).closest('frame-card') ||\n      this._selected.length === 0\n    ) {\n      return;\n    }\n\n    this._selected = [];\n    this.edgeless?.service.selection.set({\n      elements: this._selected,\n      editing: false,\n    });\n  };\n\n  private _docDisposables: DisposableGroup | null = null;\n\n  private _frameElementHeight = 0;\n\n  private _frameItems: FrameListItem[] = [];\n\n  private _indicatorTranslateY = 0;\n\n  private _lastEdgelessRootId = '';\n\n  private _selectFrame = (e: SelectEvent) => {\n    const { selected, id, multiselect } = e.detail;\n\n    if (!selected) {\n      // de-select frame\n      this._selected = this._selected.filter(frameId => frameId !== id);\n    } else if (multiselect) {\n      this._selected = [...this._selected, id];\n    } else {\n      this._selected = [id];\n    }\n\n    this.edgeless?.service.selection.set({\n      elements: this._selected,\n      editing: false,\n    });\n  };\n\n  private _updateFrameItems = () => {\n    this._frameItems = this.frames.map((frame, idx) => ({\n      frame,\n      frameIndex: frame.index,\n      cardIndex: idx,\n    }));\n  };\n\n  get frames() {\n    const frames = this.doc.getBlockByFlavour(\n      'affine:frame'\n    ) as FrameBlockModel[];\n    return frames.sort(this.compare);\n  }\n\n  get viewportPadding(): [number, number, number, number] {\n    return this.fitPadding\n      ? ([0, 0, 0, 0].map((val, idx) =>\n          Number.isFinite(this.fitPadding[idx]) ? this.fitPadding[idx] : val\n        ) as [number, number, number, number])\n      : [0, 0, 0, 0];\n  }\n\n  private _drag(e: DragEvent) {\n    if (!this._selected.length) return;\n\n    this._dragging = true;\n\n    const framesMap = this._frameItems.reduce((map, frame) => {\n      map.set(frame.frame.id, {\n        ...frame,\n      });\n      return map;\n    }, new Map<string, FrameListItem>());\n    const selected = this._selected.slice();\n\n    const draggedFramesInfo = selected.map(id => {\n      const frame = framesMap.get(id) as FrameListItem;\n\n      return {\n        frame: frame.frame,\n        element: this.renderRoot.querySelector(\n          `[data-frame-id=\"${frame.frame.id}\"]`\n        ) as FrameCard,\n        cardIndex: frame.cardIndex,\n        frameIndex: frame.frameIndex,\n      };\n    });\n    const width = draggedFramesInfo[0].element.clientWidth;\n\n    this._frameElementHeight = draggedFramesInfo[0].element.offsetHeight;\n\n    startDragging(draggedFramesInfo, {\n      width,\n      container: this,\n      document: this.ownerDocument,\n      domHost: this.domHost ?? this.ownerDocument,\n      start: {\n        x: e.detail.clientX,\n        y: e.detail.clientY,\n      },\n      framePanelBody: this,\n      frameListContainer: this.frameListContainer,\n      frameElementHeight: this._frameElementHeight,\n      edgeless: this.edgeless,\n      doc: this.doc,\n      editorHost: this.editorHost,\n      onDragEnd: insertIdx => {\n        this._dragging = false;\n        this.insertIndex = undefined;\n\n        if (insertIdx === undefined) return;\n        this._reorderFrames(selected, framesMap, insertIdx);\n      },\n      onDragMove: (idx, indicatorTranslateY) => {\n        this.insertIndex = idx;\n        this._indicatorTranslateY = indicatorTranslateY ?? 0;\n      },\n    });\n  }\n\n  private _fitToElement(e: FitViewEvent) {\n    const { block } = e.detail;\n    const bound = Bound.deserialize(block.xywh);\n\n    if (!this.edgeless) {\n      // When click frame card in page mode\n      // Should switch to edgeless mode and set viewport to the frame\n      const viewport = {\n        xywh: block.xywh,\n        referenceId: block.id,\n        padding: this.viewportPadding as [number, number, number, number],\n      };\n\n      const rootService = this.editorHost.std.getService('affine:page');\n      rootService.editPropsStore.setStorage('viewport', viewport);\n      rootService.std.get(DocModeProvider).setEditorMode('edgeless');\n    } else {\n      this.edgeless.service.viewport.setViewportByBound(\n        bound,\n        this.viewportPadding,\n        true\n      );\n    }\n  }\n\n  private _renderEmptyContent() {\n    const emptyContent = html` <div class=\"no-frame-container\">\n      <div class=\"no-frame-placeholder\">\n        Add frames to organize and present your Edgeless\n      </div>\n    </div>`;\n\n    return emptyContent;\n  }\n\n  private _renderFrameList() {\n    const selectedFrames = new Set(this._selected);\n    const frameCards = html`${repeat(\n      this._frameItems,\n      frameItem => [frameItem.frame.id, frameItem.cardIndex].join('-'),\n      frameItem => {\n        const { frame, frameIndex, cardIndex } = frameItem;\n        return html`<affine-frame-card\n          data-frame-id=${frame.id}\n          .edgeless=${this.edgeless}\n          .doc=${this.doc}\n          .host=${this.editorHost}\n          .frame=${frame}\n          .cardIndex=${cardIndex}\n          .frameIndex=${frameIndex}\n          .status=${selectedFrames.has(frame.id)\n            ? this._dragging\n              ? 'placeholder'\n              : 'selected'\n            : 'none'}\n          @select=${this._selectFrame}\n          @fitview=${this._fitToElement}\n          @drag=${this._drag}\n        ></affine-frame-card>`;\n      }\n    )}`;\n\n    const frameList = html` <div class=\"frame-list-container\">\n      ${this.insertIndex !== undefined\n        ? html`<div\n            class=\"insert-indicator\"\n            style=${`transform: translateY(${this._indicatorTranslateY}px)`}\n          ></div>`\n        : nothing}\n      ${frameCards}\n    </div>`;\n    return frameList;\n  }\n\n  private _reorderFrames(\n    selected: string[],\n    framesMap: Map<string, FrameListItem>,\n    insertIndex: number\n  ) {\n    if (insertIndex >= 0 && insertIndex <= this._frameItems.length) {\n      const frames = Array.from(framesMap.values()).map(\n        frameItem => frameItem.frame\n      );\n      const selectedFrames = selected\n        .map(id => framesMap.get(id) as FrameListItem)\n        .map(frameItem => frameItem.frame)\n        .sort(this.compare);\n\n      // update selected frames index\n      // make the indexes larger than the frame before and smaller than the frame after\n      let before = frames[insertIndex - 1]?.index || null;\n      const after = frames[insertIndex]?.index || null;\n      selectedFrames.forEach(frame => {\n        const newIndex = CommonUtils.generateKeyBetween(before, after);\n        frame.doc.updateBlock(frame, {\n          index: newIndex,\n        });\n        before = newIndex;\n      });\n\n      this.doc.captureSync();\n      this._updateFrames();\n    }\n  }\n\n  private _setDocDisposables(doc: Doc) {\n    this._clearDocDisposables();\n    this._docDisposables = new DisposableGroup();\n    this._docDisposables.add(\n      doc.slots.blockUpdated.on(({ flavour }) => {\n        if (flavour === 'affine:frame') {\n          requestAnimationFrame(() => {\n            this._updateFrames();\n          });\n        }\n      })\n    );\n  }\n\n  private _updateFrames() {\n    if (this._dragging) return;\n\n    if (!this.frames.length) {\n      this._selected = [];\n      this._frameItems = [];\n      return;\n    }\n\n    const frameItems: FramePanelBody['_frameItems'] = [];\n    const oldSelectedSet = new Set(this._selected);\n    const newSelected: string[] = [];\n    const frames = this.frames.sort(this.compare);\n    frames.forEach((frame, idx) => {\n      const frameItem = {\n        frame,\n        frameIndex: frame.index,\n        cardIndex: idx,\n      };\n\n      frameItems.push(frameItem);\n      if (oldSelectedSet.has(frame.id)) {\n        newSelected.push(frame.id);\n      }\n    });\n\n    this._frameItems = frameItems;\n    this._selected = newSelected;\n    this.requestUpdate();\n  }\n\n  compare(a: FrameBlockModel, b: FrameBlockModel) {\n    if (a.index < b.index) return -1;\n    else if (a.index > b.index) return 1;\n    return 0;\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n    this._updateFrameItems();\n    if (this.edgeless) {\n      this._lastEdgelessRootId = this.edgeless.model.id;\n    }\n  }\n\n  override disconnectedCallback() {\n    super.disconnectedCallback();\n    this._clearDocDisposables();\n  }\n\n  override firstUpdated() {\n    const disposables = this.disposables;\n    disposables.addFromEvent(this, 'click', this._clickBlank);\n  }\n\n  override render() {\n    this._updateFrameItems();\n    return html` ${this._frameItems.length\n      ? this._renderFrameList()\n      : this._renderEmptyContent()}`;\n  }\n\n  override updated(_changedProperties: PropertyValues) {\n    if (_changedProperties.has('doc') || _changedProperties.has('edgeless')) {\n      this._setDocDisposables(this.doc);\n    }\n\n    if (_changedProperties.has('edgeless') && this.edgeless) {\n      // after switch to edgeless mode, should update the selection\n      if (this.edgeless.model.id === this._lastEdgelessRootId) {\n        this.edgeless.service.selection.set({\n          elements: this._selected,\n          editing: false,\n        });\n      } else {\n        this._selected = [];\n      }\n      this._lastEdgelessRootId = this.edgeless.model.id;\n    }\n  }\n\n  @state()\n  private accessor _dragging = false;\n\n  // Store the ids of the selected frames\n  @state()\n  private accessor _selected: string[] = [];\n\n  @property({ attribute: false })\n  accessor doc!: Doc;\n\n  @property({ attribute: false })\n  accessor domHost!: Document | HTMLElement;\n\n  @property({ attribute: false })\n  accessor edgeless: EdgelessRootBlockComponent | null = null;\n\n  @property({ attribute: false })\n  accessor editorHost!: EditorHost;\n\n  @property({ attribute: false })\n  accessor fitPadding!: number[];\n\n  @query('.frame-list-container')\n  accessor frameListContainer!: HTMLElement;\n\n  @property({ attribute: false })\n  accessor insertIndex: number | undefined = undefined;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [AFFINE_FRAME_PANEL_BODY]: FramePanelBody;\n  }\n}\n"]}