{"version":3,"file":"frame-card-title.js","sourceRoot":"","sources":["../../../../src/fragments/frame-panel/card/frame-card-title.ts"],"names":[],"mappings":"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","sourcesContent":["import type { FrameBlockModel } from '@lumensuite/blocks';\nimport type { Y } from '@lumensuite/store';\n\nimport { ShadowlessElement, WithDisposable } from '@lumensuite/block-std';\nimport { DisposableGroup } from '@lumensuite/global/utils';\nimport { css, html, type PropertyValues } from 'lit';\nimport { customElement, property, query } from 'lit/decorators.js';\n\nimport { FrameCardTitleEditor } from './frame-card-title-editor.js';\n\nconst styles = css`\n  .frame-card-title-container {\n    display: flex;\n    white-space: nowrap;\n    display: flex;\n    justify-content: start;\n    align-items: center;\n    width: 100%;\n    height: 20px;\n    box-sizing: border-box;\n    gap: 6px;\n    font-size: var(--affine-font-sm);\n    cursor: default;\n    position: relative;\n  }\n\n  .frame-card-title-container .card-index {\n    display: flex;\n    align-self: center;\n    align-items: center;\n    justify-content: center;\n    min-width: 18px;\n    height: 18px;\n    box-sizing: border-box;\n    border-radius: 2px;\n    background: var(--affine-black);\n    margin-left: 2px;\n\n    color: var(--affine-white);\n    text-align: center;\n    font-weight: 500;\n    line-height: 18px;\n  }\n\n  .frame-card-title-container .card-title {\n    height: 20px;\n    color: var(--affine-text-primary-color);\n    font-weight: 400;\n    line-height: 20px;\n\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    flex: 1;\n  }\n`;\n\nexport const AFFINE_FRAME_CARD_TITLE = 'affine-frame-card-title';\n\n@customElement(AFFINE_FRAME_CARD_TITLE)\nexport class FrameCardTitle extends WithDisposable(ShadowlessElement) {\n  static override styles = styles;\n\n  private _clearTitleDisposables = () => {\n    this._titleDisposables?.dispose();\n    this._titleDisposables = null;\n  };\n\n  private _mountTitleEditor = (e: MouseEvent) => {\n    e.stopPropagation();\n\n    const titleEditor = new FrameCardTitleEditor();\n    titleEditor.frameModel = this.frame;\n    titleEditor.titleContentElement = this.titleContentElement;\n    const left = this.titleIndexElement.offsetWidth + 6;\n    titleEditor.left = left;\n    titleEditor.maxWidth = this.titleContainer.offsetWidth - left - 6;\n    this.titleContainer.append(titleEditor);\n  };\n\n  private _titleDisposables: DisposableGroup | null = null;\n\n  private _updateElement = () => {\n    this.requestUpdate();\n  };\n\n  private _setFrameDisposables(title: Y.Text) {\n    this._clearTitleDisposables();\n    title.observe(this._updateElement);\n    this._titleDisposables = new DisposableGroup();\n    this._titleDisposables.add({\n      dispose: () => {\n        title.unobserve(this._updateElement);\n      },\n    });\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n  }\n\n  override disconnectedCallback() {\n    super.disconnectedCallback();\n    this._clearTitleDisposables();\n  }\n\n  override render() {\n    return html`<div class=\"frame-card-title-container\">\n      <div\n        class=\"card-index\"\n        @click=${(e: MouseEvent) => e.stopPropagation()}\n        @dblclick=${(e: MouseEvent) => e.stopPropagation()}\n      >\n        ${this.cardIndex + 1}\n      </div>\n      <div class=\"card-title\">\n        <span\n          @click=${(e: MouseEvent) => e.stopPropagation()}\n          @dblclick=${this._mountTitleEditor}\n          >${this.frame.title}</span\n        >\n      </div>\n    </div>`;\n  }\n\n  override updated(_changedProperties: PropertyValues) {\n    if (_changedProperties.has('frame')) {\n      this._setFrameDisposables(this.frame.title.yText);\n    }\n  }\n\n  @property({ attribute: false })\n  accessor cardIndex!: number;\n\n  @property({ attribute: false })\n  accessor frame!: FrameBlockModel;\n\n  @query('.frame-card-title-container')\n  accessor titleContainer!: HTMLElement;\n\n  @query('.frame-card-title-container .card-title')\n  accessor titleContentElement!: HTMLElement;\n\n  @query('.frame-card-title-container .card-index')\n  accessor titleIndexElement!: HTMLElement;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [AFFINE_FRAME_CARD_TITLE]: FrameCardTitle;\n  }\n}\n"]}