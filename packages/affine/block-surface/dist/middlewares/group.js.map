{"version":3,"file":"group.js","sourceRoot":"","sources":["../../src/middlewares/group.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,qBAAqB,EAAE,MAAM,0BAA0B,CAAC;AAEjE,MAAM,CAAC,MAAM,uBAAuB,GAAsB,CACxD,OAA0B,EAC1B,EAAE;IACF,MAAM,WAAW,GAAG;QAClB,OAAO,CAAC,cAAc;aACnB,MAAM,CAAC,OAAO,CAAC,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC;aAChC,EAAE,CAAC,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE;YACpB,MAAM,OAAO,GAAG,OAAO,CAAC,cAAc,CAAC,EAAE,CAAE,CAAC;YAE5C,yCAAyC;YACzC,IAAI,OAAO,YAAY,qBAAqB,IAAI,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC;gBAClE,IAAI,OAAO,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;oBAClC,OAAO,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;gBAC5B,CAAC;YACH,CAAC;QACH,CAAC,CAAC;KACL,CAAC;IAEF,OAAO,GAAG,EAAE;QACV,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC,CAAC;IACxC,CAAC,CAAC;AACJ,CAAC,CAAC","sourcesContent":["import type { SurfaceBlockModel, SurfaceMiddleware } from '../surface-model.js';\n\nimport { SurfaceGroupLikeModel } from '../element-model/base.js';\n\nexport const groupRelationMiddleware: SurfaceMiddleware = (\n  surface: SurfaceBlockModel\n) => {\n  const disposables = [\n    surface.elementUpdated\n      .filter(payload => payload.local)\n      .on(({ id, props }) => {\n        const element = surface.getElementById(id)!;\n\n        // remove the group if it has no children\n        if (element instanceof SurfaceGroupLikeModel && props['childIds']) {\n          if (element.childIds.length === 0) {\n            surface.removeElement(id);\n          }\n        }\n      }),\n  ];\n\n  return () => {\n    disposables.forEach(d => d.dispose());\n  };\n};\n"]}