{"version":3,"file":"affine-text.js","sourceRoot":"","sources":["../../../../../src/rich-text/inline/presets/nodes/affine-text.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,EAAE,iBAAiB,EAAE,MAAM,uBAAuB,CAAC;AAC1D,OAAO,EAAoB,gBAAgB,EAAE,MAAM,oBAAoB,CAAC;AACxE,OAAO,EAAE,IAAI,EAAE,MAAM,KAAK,CAAC;AAC3B,OAAO,EAAE,aAAa,EAAE,QAAQ,EAAE,MAAM,mBAAmB,CAAC;AAC5D,OAAO,EAAkB,QAAQ,EAAE,MAAM,6BAA6B,CAAC;AAIvE,MAAM,UAAU,gBAAgB,CAC9B,KAA2B,EAC3B,QAA8B;IAE9B,IAAI,eAAe,GAAG,EAAE,CAAC;IACzB,IAAI,KAAK,CAAC,SAAS,EAAE,CAAC;QACpB,eAAe,IAAI,WAAW,CAAC;IACjC,CAAC;IACD,IAAI,KAAK,CAAC,MAAM,EAAE,CAAC;QACjB,eAAe,IAAI,eAAe,CAAC;IACrC,CAAC;IAED,IAAI,eAAe,GAAG,EAAE,CAAC;IACzB,IAAI,KAAK,CAAC,IAAI,EAAE,CAAC;QACf,eAAe,GAAG;YAChB,aAAa,EAAE,gCAAgC;YAC/C,UAAU,EAAE,qCAAqC;YACjD,MAAM,EAAE,sCAAsC;YAC9C,eAAe,EAAE,KAAK;YACtB,KAAK,EAAE,kCAAkC;YACzC,wBAAwB,EAAE,MAAM;YAChC,aAAa,EAAE,MAAM;SACtB,CAAC;IACJ,CAAC;IAED,OAAO,QAAQ,CAAC;QACd,aAAa,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,SAAS;QAChD,YAAY,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,QAAQ;QAChD,kBAAkB,EAAE,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,SAAS;QACnE,KAAK,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,SAAS;QAC5C,iBAAiB,EAAE,eAAe,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC,MAAM;QACxE,GAAG,eAAe;QAClB,GAAG,QAAQ;KACZ,CAAC,CAAC;AACL,CAAC;IAGY,UAAU;4BADtB,aAAa,CAAC,aAAa,CAAC;;;;sBACG,iBAAiB;;;;0BAAzB,SAAQ,WAAiB;;;;iCAqB9C,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;YAC3B,oKAAS,KAAK,6BAAL,KAAK,qFAEZ;YAxBJ,6KAyBC;;;YAzBY,uDAAU;;QACZ,MAAM;YACb,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU;gBACjC,CAAC,CAAC,gBAAgB,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC;gBACzC,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;YAEjB,8EAA8E;YAC9E,6BAA6B;YAC7B,IAAI,IAAI,CAAC,KAAK,CAAC,UAAU,EAAE,IAAI,EAAE,CAAC;gBAChC,OAAO,IAAI,CAAA,eAAe,KAAK;wBACb,IAAI,CAAC,KAAK,CAAC,MAAM;eAC1B,CAAC;YACZ,CAAC;YAED,8EAA8E;YAC9E,6BAA6B;YAC7B,OAAO,IAAI,CAAA,eAAe,KAAK;sBACb,IAAI,CAAC,KAAK,CAAC,MAAM;aAC1B,CAAC;QACZ,CAAC;QAGD,uEAAoD;YAClD,MAAM,EAAE,gBAAgB;SACzB,EAAC;QAFF,IAAS,KAAK,2CAEZ;QAFF,IAAS,KAAK,iDAEZ;;;;;;;;SAxBS,UAAU","sourcesContent":["import { ShadowlessElement } from '@lumensuite/block-std';\nimport { type DeltaInsert, ZERO_WIDTH_SPACE } from '@lumensuite/inline';\nimport { html } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\nimport { type StyleInfo, styleMap } from 'lit/directives/style-map.js';\n\nimport type { AffineTextAttributes } from '../../../extension/index.js';\n\nexport function affineTextStyles(\n  props: AffineTextAttributes,\n  override?: Readonly<StyleInfo>\n): ReturnType<typeof styleMap> {\n  let textDecorations = '';\n  if (props.underline) {\n    textDecorations += 'underline';\n  }\n  if (props.strike) {\n    textDecorations += ' line-through';\n  }\n\n  let inlineCodeStyle = {};\n  if (props.code) {\n    inlineCodeStyle = {\n      'font-family': 'var(--affine-font-code-family)',\n      background: 'var(--affine-background-code-block)',\n      border: '1px solid var(--affine-border-color)',\n      'border-radius': '4px',\n      color: 'var(--affine-text-primary-color)',\n      'font-variant-ligatures': 'none',\n      'line-height': 'auto',\n    };\n  }\n\n  return styleMap({\n    'font-weight': props.bold ? 'bolder' : 'inherit',\n    'font-style': props.italic ? 'italic' : 'normal',\n    'background-color': props.background ? props.background : undefined,\n    color: props.color ? props.color : undefined,\n    'text-decoration': textDecorations.length > 0 ? textDecorations : 'none',\n    ...inlineCodeStyle,\n    ...override,\n  });\n}\n\n@customElement('affine-text')\nexport class AffineText extends ShadowlessElement {\n  override render() {\n    const style = this.delta.attributes\n      ? affineTextStyles(this.delta.attributes)\n      : styleMap({});\n\n    // we need to avoid \\n appearing before and after the span element, which will\n    // cause the unexpected space\n    if (this.delta.attributes?.code) {\n      return html`<code style=${style}\n        ><v-text .str=${this.delta.insert}></v-text\n      ></code>`;\n    }\n\n    // we need to avoid \\n appearing before and after the span element, which will\n    // cause the unexpected space\n    return html`<span style=${style}\n      ><v-text .str=${this.delta.insert}></v-text\n    ></span>`;\n  }\n\n  @property({ type: Object })\n  accessor delta: DeltaInsert<AffineTextAttributes> = {\n    insert: ZERO_WIDTH_SPACE,\n  };\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'affine-text': AffineText;\n  }\n}\n"]}