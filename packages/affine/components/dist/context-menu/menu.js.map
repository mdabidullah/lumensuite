{"version":3,"file":"menu.js","sourceRoot":"","sources":["../../src/context-menu/menu.ts"],"names":[],"mappings":"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","sourcesContent":["import type {\n  ClientRectObject,\n  Middleware,\n  Placement,\n  VirtualElement,\n} from '@floating-ui/dom';\nimport type { TemplateResult } from 'lit';\n\nimport { rangeWrap } from '@lumensuite/affine-shared/utils';\nimport { ShadowlessElement, WithDisposable } from '@lumensuite/block-std';\nimport {\n  ArrowRightSmallIcon,\n  CheckBoxCkeckSolidIcon,\n  CheckBoxUnIcon,\n  DoneIcon,\n} from '@blocksuite/icons/lit';\nimport {\n  autoUpdate,\n  computePosition,\n  flip,\n  offset,\n  shift,\n} from '@floating-ui/dom';\nimport { css, html, nothing } from 'lit';\nimport { customElement, property, state } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { ifDefined } from 'lit/directives/if-defined.js';\nimport { createRef, ref } from 'lit/directives/ref.js';\nimport { repeat } from 'lit/directives/repeat.js';\nimport { styleMap } from 'lit/directives/style-map.js';\n\ntype MenuCommon = {\n  hide?: () => boolean;\n};\nexport type GroupMenu = MenuCommon & {\n  type: 'group';\n  name: string;\n  children: () => Menu[];\n};\ntype MenuClass = (string & {}) | 'delete-item';\nexport type NormalMenu = MenuCommon &\n  (\n    | {\n        type: 'action';\n        name: string;\n        isSelected?: boolean;\n        label?: () => TemplateResult;\n        icon?: TemplateResult;\n        postfix?: TemplateResult;\n        select: () => void;\n        onHover?: (hover: boolean) => void;\n        class?: MenuClass;\n      }\n    | {\n        type: 'checkbox';\n        name: string;\n        checked: boolean;\n        postfix?: TemplateResult;\n        label?: () => TemplateResult;\n        select: (checked: boolean) => boolean;\n        class?: string;\n      }\n    | {\n        type: 'toggle-switch';\n        name: string;\n        on: boolean;\n        postfix?: TemplateResult;\n        label?: () => TemplateResult;\n        onChange: (on: boolean) => void;\n        class?: string;\n      }\n    | {\n        type: 'sub-menu';\n        name: string;\n        label?: () => TemplateResult;\n        postfix?: TemplateResult;\n        icon?: TemplateResult;\n        options: MenuOptions;\n        select?: () => void;\n        isSelected?: boolean;\n      }\n    | {\n        type: 'custom';\n        render: () => TemplateResult;\n      }\n  );\nexport type Menu = GroupMenu | NormalMenu;\ntype GetMenuByType<T extends Menu['type'], M extends Menu = Menu> = M extends {\n  type: T;\n}\n  ? M\n  : never;\nexport type MenuOptions = {\n  onComplete?: () => void;\n  onClose?: () => void;\n  style?: string;\n  input?: {\n    icon?: TemplateResult;\n    divider?: boolean;\n    search?: boolean;\n    placeholder?: string;\n    initValue?: string;\n    onComplete?: (text: string) => void;\n    left?: TemplateResult;\n    right?: TemplateResult;\n  };\n  items: Menu[];\n};\n\ntype ItemBase = {\n  label: () => TemplateResult;\n  upDivider?: boolean;\n  downDivider?: boolean;\n  mouseEnter?: () => void;\n  onHover?: (hover: boolean) => void;\n  class?: string;\n};\n\ntype NormalItem = ItemBase & {\n  type: 'normal';\n};\n\ntype SelectItem = ItemBase & {\n  type: 'select';\n  select: () => void;\n};\n\ntype UIItem = {\n  type: 'ui';\n  render: () => TemplateResult;\n  upDivider?: boolean;\n  downDivider?: boolean;\n};\n\ntype Item = SelectItem | NormalItem | UIItem;\n\nconst isSelectableItem = (item: Item): item is SelectItem => {\n  return item.type === 'select';\n};\n\n@customElement('affine-menu')\nexport class MenuComponent<_T> extends WithDisposable(ShadowlessElement) {\n  static override styles = css`\n    affine-menu {\n      font-family: var(--affine-font-family);\n      display: flex;\n      flex-direction: column;\n      user-select: none;\n      min-width: 276px;\n      box-shadow: var(--affine-shadow-2);\n      border-radius: 8px;\n      background-color: var(--affine-background-overlay-panel-color);\n      padding: 8px;\n      position: absolute;\n      z-index: 999;\n    }\n\n    affine-menu * {\n      box-sizing: border-box;\n    }\n\n    .affine-menu-body {\n      display: flex;\n      flex-direction: column;\n      gap: 4px;\n    }\n\n    .affine-menu-header {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      padding: 8px 12px;\n    }\n\n    /* .affine-menu-header .icon {\n    } */\n    .affine-menu-header input {\n      flex: 1;\n      border-radius: 4px;\n      outline: none;\n      font-size: 14px;\n      line-height: 22px;\n      padding: 5px 12px;\n      border: 1px solid var(--affine-border-color);\n    }\n\n    .affine-menu-header input::placeholder {\n      color: var(--affine-placeholder-color);\n    }\n\n    .affine-menu-header input:focus {\n      border: 1px solid var(--affine-primary-color);\n    }\n\n    .affine-menu-action {\n      padding: 4px 12px;\n      cursor: pointer;\n      display: flex;\n      gap: 4px;\n      border-radius: 4px;\n    }\n\n    .affine-menu-action svg {\n      width: 20px;\n      height: 20px;\n    }\n\n    .affine-menu-action .icon {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      color: var(--affine-icon-color);\n      fill: var(--affine-icon-color);\n    }\n\n    .affine-menu-action .content {\n      border-radius: 4px;\n      cursor: pointer;\n      white-space: nowrap;\n      justify-content: space-between;\n      display: flex;\n      align-items: center;\n      font-size: 14px;\n      line-height: 22px;\n      flex: 1;\n      gap: 8px;\n    }\n\n    .affine-menu-action.selected {\n      background-color: var(--affine-hover-color);\n    }\n\n    .affine-menu-action.selected.delete-item {\n      background-color: var(--affine-background-error-color);\n      color: var(--affine-error-color);\n    }\n\n    .affine-menu-action.selected.delete-item .icon > svg {\n      color: var(--affine-error-color);\n    }\n\n    .affine-menu-action.selected-item {\n      color: var(--affine-text-emphasis-color);\n    }\n\n    .affine-menu-action.selected-item .icon {\n      color: var(--affine-text-emphasis-color);\n      fill: currentColor;\n    }\n\n    .database-menu-component-action-button:hover {\n      background-color: rgba(0, 0, 0, 0.1);\n    }\n\n    .no-results {\n      font-size: 12px;\n      line-height: 20px;\n      color: var(--affine-text-secondary-color);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      margin-top: 8px;\n    }\n\n    .affine-menu-action-text {\n      flex: 1;\n      padding: 0 4px;\n    }\n  `;\n\n  private _checked: Record<string, boolean> = {};\n\n  private _clickContainer = (e: MouseEvent) => {\n    e.stopPropagation();\n    this.focusInput();\n  };\n\n  private _complete = () => {\n    this.options.onComplete?.();\n    this.close();\n  };\n\n  private _inputText = (e: InputEvent) => {\n    const target = e.target as HTMLInputElement;\n    this.text = target.value;\n  };\n\n  private _mouseEnter = (index?: number) => {\n    if (this._isConsciousChoice()) {\n      return;\n    }\n    if (index !== this.selectedIndex) {\n      this.selectedIndex = index;\n      this.clearSubMenu();\n      this.selectedItem?.mouseEnter?.();\n    }\n  };\n\n  private allItems: Array<Item & { index?: number }> = [];\n\n  private initTime = 0;\n\n  private inputRef = createRef<HTMLInputElement>();\n\n  private processMap: {\n    [K in Menu['type']]: (menu: GetMenuByType<K>) => Item[];\n  } = {\n    action: menu => {\n      const icon = menu.icon\n        ? html` <div class=\"icon\">${menu.icon}</div>`\n        : nothing;\n      const postfixIcon =\n        menu.postfix ?? (menu.isSelected ? DoneIcon() : undefined);\n      const postfix = postfixIcon\n        ? html` <div class=\"icon\">${postfixIcon}</div>`\n        : nothing;\n      return [\n        {\n          type: 'select',\n          label: () => html`\n            ${icon}\n            <div class=\"affine-menu-action-text\">\n              ${menu.label?.() ?? menu.name}\n            </div>\n            ${postfix}\n          `,\n          onHover: menu.onHover,\n          select: () => {\n            menu.select();\n            this._complete();\n          },\n          class: menu.class ?? (menu.isSelected ? 'selected-item' : ''),\n        },\n      ];\n    },\n    checkbox: menu => {\n      const postfix = menu.postfix\n        ? html` <div class=\"icon\">${menu.postfix}</div>`\n        : nothing;\n      const checked = this.getChecked(menu.name) ?? menu.checked;\n      return [\n        {\n          type: 'select',\n          label: () => html`\n            <div class=\"icon\">\n              ${checked\n                ? CheckBoxCkeckSolidIcon({ style: `color:#1E96EB` })\n                : CheckBoxUnIcon()}\n            </div>\n            <div class=\"affine-menu-action-text\">\n              ${menu.label?.() ?? menu.name}\n            </div>\n            ${postfix}\n          `,\n          select: () => {\n            this.setChecked(menu.name, menu.select(checked));\n          },\n          class: menu.class ?? '',\n        },\n      ];\n    },\n    'toggle-switch': menu => {\n      const postfix = menu.postfix\n        ? html` <div class=\"icon\">${menu.postfix}</div>`\n        : nothing;\n\n      const onChange = (on: boolean) => {\n        menu.onChange(on);\n      };\n\n      return [\n        {\n          type: 'normal',\n          label: () => html`\n            <div class=\"affine-menu-action-text\">\n              ${menu.label?.() ?? menu.name}\n            </div>\n\n            <toggle-switch .on=${menu.on} .onChange=${onChange}></toggle-switch>\n            ${postfix}\n          `,\n          class: menu.class ?? '',\n        },\n      ];\n    },\n    group: menu => {\n      const items = menu.children().flatMap(menu => this.process(menu));\n      if (items[0]) {\n        items[0].upDivider = true;\n      }\n      if (items[items.length - 1]) {\n        items[items.length - 1].downDivider = true;\n      }\n      return items;\n    },\n    'sub-menu': menu => {\n      const openSubMenu = () => {\n        this.subMenu?.remove();\n        setTimeout(() => {\n          const subMenu = new MenuComponent();\n          const options = menu.options;\n          subMenu.options = {\n            ...options,\n            onClose: () => {\n              options.onClose?.();\n              this.clearSubMenu();\n            },\n            onComplete: () => {\n              this._complete();\n            },\n          };\n          this.append(subMenu);\n          computePosition(this, subMenu, {\n            placement: 'right-start',\n            middleware: [\n              flip({\n                fallbackPlacements: ['left-start', 'right-end', 'left-end'],\n              }),\n              offset(4),\n            ],\n          })\n            .then(({ x, y }) => {\n              Object.assign(subMenu.style, {\n                left: `${x}px`,\n                top: `${y}px`,\n              });\n            })\n            .catch(console.error);\n          this.subMenu = subMenu;\n        });\n      };\n      const select = () => {\n        menu.select?.();\n        menu.select ? this._complete() : openSubMenu();\n      };\n      const postfix = html` <div class=\"icon\">\n        ${menu.postfix ?? ArrowRightSmallIcon()}\n      </div>`;\n      return [\n        {\n          type: 'select',\n          label: () =>\n            html`${menu.icon\n                ? html` <div class=\"icon\">${menu.icon}</div>`\n                : nothing}\n              <div class=\"affine-menu-action-text\">\n                ${menu.label?.() ?? menu.name}\n              </div>\n              ${postfix}`,\n          mouseEnter: openSubMenu,\n          select,\n          class: menu.isSelected ? 'selected-item' : '',\n        },\n      ];\n    },\n    custom: menu => {\n      return [\n        {\n          type: 'ui',\n          render: menu.render,\n        },\n      ];\n    },\n  };\n\n  private selectableItems!: Array<SelectItem>;\n\n  private subMenu?: HTMLElement;\n\n  mouseEnterHeader = () => {\n    if (this.isSearchMode) {\n      return;\n    }\n    this._mouseEnter(-1);\n  };\n\n  private get isSearchMode() {\n    return this.options.input?.search;\n  }\n\n  private get minIndex() {\n    return this.isSearchMode ? 0 : -1;\n  }\n\n  private get selectedIndex(): number | undefined {\n    return this._selectedIndex;\n  }\n\n  private set selectedIndex(index: number | undefined) {\n    const old =\n      this._selectedIndex != null\n        ? this.selectableItems[this._selectedIndex]\n        : undefined;\n    old?.onHover?.(false);\n    if (index == null) {\n      this._selectedIndex = index;\n      return;\n    }\n    const newIndex = rangeWrap(\n      index ?? this.minIndex,\n      this.minIndex,\n      this.selectableItems.length\n    );\n    this._selectedIndex = newIndex;\n    this.selectableItems[newIndex]?.onHover?.(true);\n  }\n\n  private get selectedItem(): SelectItem | undefined {\n    return this.selectedIndex != null\n      ? this.selectableItems[this.selectedIndex]\n      : undefined;\n  }\n\n  private get text() {\n    return this._text ?? this.options.input?.initValue ?? '';\n  }\n\n  private set text(value: string) {\n    this._text = value;\n  }\n\n  private _isConsciousChoice() {\n    return Date.now() < this.initTime + 100;\n  }\n\n  private clearSubMenu() {\n    this.subMenu?.remove();\n    this.subMenu = undefined;\n    this.focusInput();\n  }\n\n  private close() {\n    this.options.onClose?.();\n  }\n\n  private focusInput() {\n    this.inputRef.value?.focus();\n  }\n\n  private getChecked(name: string): boolean {\n    return this._checked[name];\n  }\n\n  private process(menu: Menu): Item[] {\n    if (this.show(menu)) {\n      return this.processMap[menu.type](menu as never);\n    } else {\n      return [];\n    }\n  }\n\n  private setChecked(name: string, checked: boolean) {\n    this._checked[name] = checked;\n    this.requestUpdate();\n  }\n\n  private show(item: Menu): boolean {\n    if (this.isSearchMode) {\n      if (item.type === 'group') {\n        return !item.hide?.();\n      }\n      if (item.type === 'custom') {\n        return this.text.length === 0;\n      }\n      if (!item.name.toLowerCase().includes(this.text.toLowerCase())) {\n        return false;\n      }\n    }\n    return !item.hide?.();\n  }\n\n  private showHeader() {\n    return !this.isSearchMode || !!this.text;\n  }\n\n  override disconnectedCallback() {\n    super.disconnectedCallback();\n    this.selectedItem?.onHover?.(false);\n  }\n\n  override firstUpdated() {\n    this.initTime = Date.now();\n    const input = this.inputRef.value;\n    if (input) {\n      requestAnimationFrame(() => {\n        this.focusInput();\n      });\n      const length = input.value.length;\n      input.setSelectionRange(length, length);\n      this._disposables.addFromEvent(input, 'keydown', e => {\n        e.stopPropagation();\n        if (e.key === 'Escape') {\n          this.close();\n          return;\n        }\n        if (e.key === 'Enter' && !e.isComposing) {\n          const selectedItem = this.selectedItem;\n          if (selectedItem) {\n            selectedItem.select();\n          } else {\n            this.options.input?.onComplete?.(this.text);\n            this._complete();\n          }\n          return;\n        }\n        if (e.key === 'ArrowUp') {\n          e.preventDefault();\n          this.selectedIndex =\n            this.selectedIndex != null ? this.selectedIndex - 1 : this.minIndex;\n          return;\n        }\n        if (e.key === 'ArrowDown') {\n          e.preventDefault();\n          this.selectedIndex =\n            this.selectedIndex != null ? this.selectedIndex + 1 : this.minIndex;\n          return;\n        }\n      });\n\n      this._disposables.addFromEvent(input, 'copy', e => {\n        e.stopPropagation();\n      });\n      this._disposables.addFromEvent(input, 'cut', e => {\n        e.stopPropagation();\n      });\n    }\n  }\n\n  processItems() {\n    this.allItems = [];\n    this.selectableItems = [];\n    this.options.items\n      .flatMap(item => this.process(item))\n      .forEach(item => {\n        const isSelectable = isSelectableItem(item);\n        this.allItems.push({\n          ...item,\n          index: isSelectable ? this.selectableItems.length : undefined,\n        });\n        if (isSelectable) {\n          this.selectableItems.push(item);\n        }\n      });\n  }\n\n  override render() {\n    this.processItems();\n    this.selectedIndex = this._selectedIndex;\n    const showHeader = this.showHeader();\n    const headerStyle = styleMap({\n      opacity: showHeader ? '1' : '0',\n      height: showHeader ? undefined : '0',\n      overflow: showHeader ? undefined : 'hidden',\n      position: showHeader ? undefined : 'absolute',\n    });\n    const showHeaderDivider =\n      this.selectableItems.length > 0 &&\n      showHeader &&\n      this.options.input?.divider !== false;\n    return html`\n      <div\n        class=\"affine-menu\"\n        style=${ifDefined(this.options.style)}\n        @click=\"${this._clickContainer}\"\n      >\n        ${this.options.input\n          ? html` <div\n                class=\"affine-menu-header\"\n                style=${headerStyle}\n                @mouseenter=\"${this.mouseEnterHeader}\"\n              >\n                ${this.options.input.icon\n                  ? html`<div class=\"icon\">${this.options.input.icon}</div>`\n                  : nothing}\n                <input\n                  autocomplete=\"off\"\n                  data-1p-ignore\n                  ${ref(this.inputRef)}\n                  type=\"text\"\n                  placeholder=\"${this.options.input?.placeholder ?? ''}\"\n                  value=\"${this.text ?? this.options.input?.initValue ?? ''}\"\n                  @input=\"${this._inputText}\"\n                />\n              </div>\n              ${showHeaderDivider\n                ? html`<menu-divider style=\"width: 100%\"></menu-divider>`\n                : null}`\n          : null}\n        <div class=\"affine-menu-body\">\n          ${this.selectableItems.length === 0 && this.isSearchMode\n            ? html` <div class=\"no-results\">No Results</div>`\n            : ''}\n          ${repeat(this.allItems, (menu, index) => {\n            const i = menu.index;\n            const hideDividerWhenHeaderDividerIsShow = i === 0;\n            const divider =\n              menu.upDivider || this.allItems[index - 1]?.downDivider;\n            const mouseEnter = () => {\n              this._mouseEnter(i);\n            };\n            if (menu.type === 'ui') {\n              return html`\n                ${divider\n                  ? html`<menu-divider style=\"width: 100%\"></menu-divider>`\n                  : null}\n                <div @mouseenter=${mouseEnter}>${menu.render()}</div>\n              `;\n            }\n\n            const itemClass = menu.class || 'affine-menu-item';\n            const classes = classMap({\n              'affine-menu-action': true,\n              selected: menu.type === 'select' && this._selectedIndex === i,\n              [itemClass]: true,\n            });\n\n            const select = () => {\n              if (!isSelectableItem(menu)) return;\n              menu.select();\n            };\n\n            return html`\n              ${divider && !hideDividerWhenHeaderDividerIsShow\n                ? html`<menu-divider style=\"width: 100%\"></menu-divider>`\n                : null}\n              <div\n                class=\"${classes}\"\n                @click=${select}\n                @mouseenter=${mouseEnter}\n              >\n                <div class=\"content\">${menu.label()}</div>\n              </div>\n            `;\n          })}\n        </div>\n      </div>\n    `;\n  }\n\n  @state()\n  private accessor _selectedIndex: number | undefined = undefined;\n\n  @state()\n  private accessor _text: string | undefined = undefined;\n\n  @property({ attribute: false })\n  accessor options!: MenuOptions;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'affine-menu': MenuComponent<unknown>;\n  }\n}\nexport const getDefaultModalRoot = (ele: HTMLElement) => {\n  const host: HTMLElement | null =\n    ele.closest('editor-host') ?? ele.closest('.data-view-popup-container');\n  if (host) {\n    return host;\n  }\n  return document.body;\n};\nexport const createModal = (container: HTMLElement = document.body) => {\n  const div = document.createElement('div');\n  div.style.pointerEvents = 'auto';\n  div.style.position = 'absolute';\n  div.style.left = '0';\n  div.style.top = '0';\n  div.style.width = '100%';\n  div.style.height = '100%';\n  div.style.zIndex = '1001';\n  div.style.fontFamily = 'var(--affine-font-family)';\n  container.append(div);\n  return div;\n};\nexport const positionToVRect = (x: number, y: number): VirtualElement => {\n  return {\n    getBoundingClientRect(): ClientRectObject {\n      return {\n        x: x,\n        y: y,\n        width: 0,\n        height: 0,\n        top: y,\n        bottom: y,\n        left: x,\n        right: x,\n      };\n    },\n  };\n};\nexport const createPopup = (\n  target: HTMLElement,\n  content: HTMLElement,\n  options?: {\n    onClose?: () => void;\n    middleware?: Array<Middleware | null | undefined | false>;\n    placement?: Placement;\n    container?: HTMLElement;\n  }\n) => {\n  const modal = createModal(options?.container ?? getDefaultModalRoot(target));\n  autoUpdate(target, content, () => {\n    computePosition(target, content, {\n      placement: options?.placement,\n      middleware: options?.middleware ?? [shift({ crossAxis: true })],\n    })\n      .then(({ x, y }) => {\n        Object.assign(content.style, {\n          left: `${x}px`,\n          top: `${y}px`,\n        });\n      })\n      .catch(console.error);\n  });\n  modal.append(content);\n\n  modal.onmousedown = ev => {\n    if (ev.target === modal) {\n      modal.remove();\n      options?.onClose?.();\n    }\n  };\n\n  modal.oncontextmenu = ev => {\n    ev.preventDefault();\n    if (ev.target === modal) {\n      modal.remove();\n      options?.onClose?.();\n    }\n  };\n\n  return () => modal.remove();\n};\n\nexport type MenuHandler = {\n  close: () => void;\n};\n\nexport const popMenu = <T>(\n  target: HTMLElement,\n  props: {\n    options: MenuOptions;\n    placement?: Placement;\n    middleware?: Array<Middleware | null | undefined | false>;\n    container?: HTMLElement;\n  }\n): MenuHandler => {\n  const menu = new MenuComponent<T>();\n  menu.options = {\n    ...props.options,\n    onClose: () => {\n      props.options.onClose?.();\n      close();\n    },\n  };\n  const close = createPopup(target, menu, {\n    onClose: props.options.onClose,\n    middleware: props.middleware,\n    container: props.container,\n    placement: props.placement,\n  });\n  return {\n    close,\n  };\n};\nexport const popFilterableSimpleMenu = (\n  target: HTMLElement,\n  options: Menu[],\n  onClose?: () => void\n) => {\n  popMenu(target, {\n    options: {\n      input: {\n        placeholder: 'Search',\n        search: true,\n      },\n      items: options,\n      onClose,\n    },\n  });\n};\n"]}