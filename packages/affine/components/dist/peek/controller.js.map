{"version":3,"file":"controller.js","sourceRoot":"","sources":["../../src/peek/controller.ts"],"names":[],"mappings":"AAKA,MAAM,OAAO,kBAAkB;IAoB7B,IAAI,QAAQ;QACV,OAAO,CACL,CAAC,CAAC,IAAI,CAAC,mBAAmB,EAAE;YAC5B,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAChD,CAAC;IACJ,CAAC;IAED,YACU,MAAS,EACT,MAA0B;QAD1B,WAAM,GAAN,MAAM,CAAG;QACT,WAAM,GAAN,MAAM,CAAoB;QA5B5B,wBAAmB,GAAG,GAA2B,EAAE;YACzD,IAAI,iBAAiB,IAAI,IAAI,CAAC,cAAc,EAAE,EAAE,CAAC;gBAC/C,OAAO,IAAI,CAAC,cAAc,EAEvB,CAAC,eAAe,CAAC;YACtB,CAAC;YACD,OAAO,IAAI,CAAC;QACd,CAAC,CAAC;QAEM,mBAAc,GAAG,GAA2B,EAAE;YACpD,OAAO,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,UAAU,CAAI,aAAa,CAAC,CAAC;QACtD,CAAC,CAAC;QAEF,SAAI,GAAG,CAAC,QAAyB,EAAE,EAAE;YACnC,OAAO,OAAO,CAAC,OAAO,CACpB,IAAI,CAAC,mBAAmB,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,QAAQ,CAAC,CACxD,CAAC;QACJ,CAAC,CAAC;IAYC,CAAC;CACL","sourcesContent":["import type { BlockService } from '@blocksuite/block-std';\nimport type { TemplateResult } from 'lit';\n\nimport type { PeekableClass, PeekViewService } from './type.js';\n\nexport class PeekableController<T extends PeekableClass> {\n  private _getPeekViewService = (): PeekViewService | null => {\n    if ('peekViewService' in this.getRootService()) {\n      return this.getRootService<\n        BlockService & { peekViewService: PeekViewService }\n      >().peekViewService;\n    }\n    return null;\n  };\n\n  private getRootService = <T extends BlockService>() => {\n    return this.target.std.getService<T>('affine:page');\n  };\n\n  peek = (template?: TemplateResult) => {\n    return Promise.resolve<void>(\n      this._getPeekViewService()?.peek(this.target, template)\n    );\n  };\n\n  get peekable() {\n    return (\n      !!this._getPeekViewService() &&\n      (this.enable ? this.enable(this.target) : true)\n    );\n  }\n\n  constructor(\n    private target: T,\n    private enable?: (e: T) => boolean\n  ) {}\n}\n"]}