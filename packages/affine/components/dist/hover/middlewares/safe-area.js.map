{"version":3,"file":"safe-area.js","sourceRoot":"","sources":["../../../src/hover/middlewares/safe-area.ts"],"names":[],"mappings":"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","sourcesContent":["import type { HoverMiddleware } from '../types.js';\n\nexport type SafeTriangleOptions = {\n  zIndex: number;\n  buffer: number;\n  /**\n   * abort triangle guard if the mouse not move for some time\n   */\n  idleTimeout: number;\n  debug?: boolean;\n};\n\n/**\n * Returns true if the line from (a,b)->(c,d) intersects with (p,q)->(r,s)\n *\n * See https://stackoverflow.com/questions/9043805/test-if-two-lines-intersect-javascript-function\n */\nfunction hasIntersection(\n  { x: a, y: b }: { x: number; y: number },\n  { x: c, y: d }: { x: number; y: number },\n  { x: p, y: q }: { x: number; y: number },\n  { x: r, y: s }: { x: number; y: number }\n) {\n  const det = (c - a) * (s - q) - (r - p) * (d - b);\n  if (det === 0) {\n    return false;\n  } else {\n    const lambda = ((s - q) * (r - a) + (p - r) * (s - b)) / det;\n    const gamma = ((b - d) * (r - a) + (c - a) * (s - b)) / det;\n    return 0 < lambda && lambda < 1 && 0 < gamma && gamma < 1;\n  }\n}\n\nfunction isInside(\n  { x, y }: { x: number; y: number },\n  rect: DOMRect,\n  buffer = 0\n) {\n  return (\n    x >= rect.left - buffer &&\n    x <= rect.right + buffer &&\n    y >= rect.top - buffer &&\n    y <= rect.bottom - buffer\n  );\n}\n\nconst getNearestSide = (\n  point: { x: number; y: number },\n  rect: DOMRect\n):\n  | [\n      'top' | 'bottom' | 'left' | 'right',\n      { x: number; y: number },\n      { x: number; y: number },\n    ]\n  | null => {\n  const centerPoint = {\n    x: rect.x + rect.width / 2,\n    y: rect.y + rect.height / 2,\n  };\n  const topLeft = { x: rect.x, y: rect.y };\n  const topRight = { x: rect.right, y: rect.y };\n  const bottomLeft = { x: rect.x, y: rect.bottom };\n  const bottomRight = { x: rect.right, y: rect.bottom };\n  if (hasIntersection(point, centerPoint, bottomLeft, bottomRight)) {\n    return ['top', bottomLeft, bottomRight];\n  }\n  if (hasIntersection(point, centerPoint, topLeft, topRight)) {\n    return ['bottom', topLeft, topRight];\n  }\n  if (hasIntersection(point, centerPoint, topLeft, bottomLeft)) {\n    return ['right', topLeft, bottomLeft];\n  }\n  if (hasIntersection(point, centerPoint, topRight, bottomRight)) {\n    return ['left', topRight, bottomRight];\n  }\n  return null;\n};\n\n/**\n * Part of the code is ported from https://github.com/floating-ui/floating-ui/blob/master/packages/react/src/safePolygon.ts\n * Licensed under MIT.\n */\nexport const safeTriangle = ({\n  zIndex = 10000,\n  buffer = 2,\n  idleTimeout = 40,\n  debug = false,\n}: Partial<SafeTriangleOptions> = {}): HoverMiddleware => {\n  let abortController = new AbortController();\n  return async ({ event, referenceElement, floatingElement }) => {\n    abortController.abort();\n    const newAbortController = new AbortController();\n    abortController = newAbortController;\n\n    const isLeave = event.type === 'mouseleave';\n    if (!isLeave || event.target !== referenceElement) return true;\n    if (!(event instanceof MouseEvent)) {\n      console.warn('Unknown event type in hover middleware', event);\n      return true;\n    }\n    if (!floatingElement) return true;\n\n    const mouseX = event.x;\n    const mouseY = event.y;\n    const refRect = referenceElement.getBoundingClientRect();\n    const rect = floatingElement.getBoundingClientRect();\n\n    // If the mouse leaves from inside the referenceElement element,\n    // we should ignore the event.\n    const leaveFromInside = isInside({ x: mouseX, y: mouseY }, refRect);\n    if (leaveFromInside) return true;\n\n    // what side is the floating element on\n    const floatingData = getNearestSide({ x: mouseX, y: mouseY }, rect);\n    if (!floatingData) return true;\n    const floatingSide = floatingData[0];\n    // If the pointer is leaving from the opposite side, no need to show the triangle.\n    // A constant of 1 handles floating point rounding errors.\n    if (\n      (floatingSide === 'top' && mouseY >= refRect.bottom - 1) ||\n      (floatingSide === 'bottom' && mouseY <= refRect.top + 1) ||\n      (floatingSide === 'left' && mouseX >= refRect.right - 1) ||\n      (floatingSide === 'right' && mouseX <= refRect.left + 1)\n    ) {\n      return true;\n    }\n\n    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n    const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n    const updateSafeTriangle = (mouseX: number, mouseY: number) => {\n      if (newAbortController.signal.aborted) return;\n      // If the mouse is inside the floating element, we should ignore the event.\n      if (\n        mouseX >= rect.left &&\n        mouseX <= rect.right &&\n        mouseY >= rect.top &&\n        mouseY <= rect.bottom\n      )\n        newAbortController.abort();\n      const p1 = { x: mouseX, y: mouseY };\n      // Assume the floating element is still in the same position.\n      const p2 = floatingData[1];\n      const p3 = floatingData[2];\n      // The base point is the top left corner of the three points.\n      const basePoint = {\n        x: Math.min(p1.x, p2.x, p3.x) - buffer,\n        y: Math.min(p1.y, p2.y, p3.y) - buffer,\n      };\n      const areaHeight = Math.max(\n        Math.abs(p1.y - p2.y),\n        Math.abs(p1.y - p3.y),\n        Math.abs(p2.y - p3.y)\n      );\n      const areaWidth = Math.max(\n        Math.abs(p1.x - p2.x),\n        Math.abs(p1.x - p3.x),\n        Math.abs(p2.x - p3.x)\n      );\n      Object.assign(svg.style, {\n        position: 'fixed',\n        pointerEvents: 'none',\n        width: areaWidth + buffer * 2,\n        height: areaHeight + buffer * 2,\n        zIndex,\n        top: 0,\n        left: 0,\n        transform: `translate(${basePoint.x}px, ${basePoint.y}px)`,\n      });\n      path.setAttributeNS(\n        null,\n        'd',\n        `M${p1.x - basePoint.x} ${p1.y - basePoint.y} ${p2.x - basePoint.x} ${\n          p2.y - basePoint.y\n        } ${p3.x - basePoint.x} ${p3.y - basePoint.y} z`\n      );\n    };\n    path.setAttributeNS(null, 'pointer-events', 'auto');\n    path.setAttributeNS(null, 'fill', 'transparent');\n    path.setAttributeNS(null, 'stroke-width', buffer.toString());\n    path.setAttributeNS(null, 'stroke', 'transparent');\n    if (debug) {\n      path.setAttributeNS(null, 'stroke', 'red');\n    }\n    updateSafeTriangle(mouseX, mouseY);\n    svg.append(path);\n    document.body.append(svg);\n    abortController.signal.addEventListener('abort', () => svg.remove());\n    let frameId = 0;\n    let idleId = window.setTimeout(\n      () => newAbortController.abort(),\n      idleTimeout\n    );\n    svg.addEventListener(\n      'mousemove',\n      e => {\n        clearTimeout(idleId);\n        idleId = window.setTimeout(\n          () => newAbortController.abort(),\n          idleTimeout\n        );\n        cancelAnimationFrame(frameId);\n        // prevent unexpected mouseleave\n        frameId = requestAnimationFrame(() =>\n          updateSafeTriangle(e.clientX, e.clientY)\n        );\n      },\n      { signal: newAbortController.signal }\n    );\n\n    await new Promise<void>(res => {\n      if (newAbortController.signal.aborted) res();\n      newAbortController.signal.addEventListener('abort', () => res());\n      svg.addEventListener('mouseleave', () => newAbortController.abort(), {\n        signal: newAbortController.signal,\n      });\n    });\n\n    return true;\n  };\n};\n\nexport type SafeBridgeOptions = { debug: boolean; idleTimeout: number };\n\n/**\n * Create a virtual rectangular bridge between the reference element and the floating element.\n *\n * Part of the code is ported from https://github.com/floating-ui/floating-ui/blob/master/packages/react/src/safePolygon.ts\n * Licensed under MIT.\n */\nexport const safeBridge = ({\n  debug = false,\n  idleTimeout = 500,\n}: Partial<SafeBridgeOptions> = {}): HoverMiddleware => {\n  let abortController = new AbortController();\n  return async ({ event, referenceElement, floatingElement }) => {\n    abortController.abort();\n    const newAbortController = new AbortController();\n    abortController = newAbortController;\n\n    const isLeave = event.type === 'mouseleave';\n    if (!isLeave || event.target !== referenceElement) return true;\n    if (!(event instanceof MouseEvent)) {\n      console.warn('Unknown event type in hover middleware', event);\n      return true;\n    }\n    if (!floatingElement) return true;\n    const checkInside = (mouseX: number, mouseY: number) => {\n      if (newAbortController.signal.aborted) return false;\n      const point = { x: mouseX, y: mouseY };\n      const refRect = referenceElement.getBoundingClientRect();\n      const rect = floatingElement.getBoundingClientRect();\n      // what side is the floating element on\n      const floatingData = getNearestSide(point, rect);\n      if (!floatingData) return false;\n      const floatingSide = floatingData[0];\n      // If the pointer is leaving from the other side, no need to show the bridge.\n      // A constant of 1 handles floating point rounding errors.\n      if (\n        (floatingSide === 'top' && mouseY > refRect.top + 1) ||\n        (floatingSide === 'bottom' && mouseY < refRect.bottom - 1) ||\n        (floatingSide === 'left' && mouseX > refRect.left + 1) ||\n        (floatingSide === 'right' && mouseX < refRect.right - 1)\n      )\n        return false;\n      let rectRect: DOMRect;\n      switch (floatingSide) {\n        case 'top': {\n          rectRect = new DOMRect(\n            Math.max(rect.left, refRect.left),\n            rect.bottom,\n            Math.min(rect.right, refRect.right) -\n              Math.max(rect.left, refRect.left),\n            refRect.top - rect.bottom\n          );\n          break;\n        }\n        case 'bottom': {\n          rectRect = new DOMRect(\n            Math.max(rect.left, refRect.left),\n            refRect.bottom,\n            Math.min(rect.right, refRect.right) -\n              Math.max(rect.left, refRect.left),\n            rect.top - refRect.bottom\n          );\n          break;\n        }\n        case 'left': {\n          rectRect = new DOMRect(\n            rect.right,\n            Math.max(rect.top, refRect.top),\n            refRect.left - rect.right,\n            Math.min(rect.bottom, refRect.bottom) -\n              Math.max(rect.top, refRect.top)\n          );\n          break;\n        }\n        case 'right': {\n          rectRect = new DOMRect(\n            refRect.right,\n            Math.max(rect.top, refRect.top),\n            rect.left - refRect.right,\n            Math.min(rect.bottom, refRect.bottom) -\n              Math.max(rect.top, refRect.top)\n          );\n          break;\n        }\n        default:\n          return false;\n      }\n\n      const inside = isInside(point, rectRect, 1);\n      if (inside && debug) {\n        const debugId = 'debug-rectangle-bridge-rect';\n        const rectDom =\n          document.querySelector<HTMLDivElement>(`#${debugId}`) ??\n          document.createElement('div');\n        rectDom.id = debugId;\n        Object.assign(rectDom.style, {\n          position: 'fixed',\n          pointerEvents: 'none',\n          background: 'aqua',\n          opacity: '0.3',\n          top: rectRect.top + 'px',\n          left: rectRect.left + 'px',\n          width: rectRect.width + 'px',\n          height: rectRect.height + 'px',\n        });\n        document.body.append(rectDom);\n        newAbortController.signal.addEventListener('abort', () =>\n          rectDom.remove()\n        );\n      }\n      return inside;\n    };\n    if (!checkInside(event.x, event.y)) return true;\n    await new Promise<void>(res => {\n      if (newAbortController.signal.aborted) res();\n      newAbortController.signal.addEventListener('abort', () => res());\n      let idleId = window.setTimeout(\n        () => newAbortController.abort(),\n        idleTimeout\n      );\n      document.addEventListener(\n        'mousemove',\n        e => {\n          clearTimeout(idleId);\n          idleId = window.setTimeout(\n            () => newAbortController.abort(),\n            idleTimeout\n          );\n          if (!checkInside(e.clientX, e.clientY)) newAbortController.abort();\n        },\n        {\n          signal: newAbortController.signal,\n        }\n      );\n    });\n    return true;\n  };\n};\n"]}