{"version":3,"file":"filter-group.js","sourceRoot":"","sources":["../../../src/widget-presets/filter/filter-group.ts"],"names":[],"mappings":"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","sourcesContent":["import type { TemplateResult } from 'lit';\n\nimport { popFilterableSimpleMenu } from '@lumensuite/affine-components/context-menu';\nimport { ShadowlessElement, WithDisposable } from '@lumensuite/block-std';\nimport {\n  ArrowDownSmallIcon,\n  ConvertIcon,\n  DeleteIcon,\n  DuplicateIcon,\n  MoreHorizontalIcon,\n  PlusIcon,\n} from '@blocksuite/icons/lit';\nimport { css, html, nothing } from 'lit';\nimport { customElement, property, state } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { repeat } from 'lit/directives/repeat.js';\n\nimport {\n  type Filter,\n  type FilterGroup,\n  firstFilter,\n  type Variable,\n} from '../../core/common/ast.js';\nimport { popAddNewFilter } from './condition.js';\n\n@customElement('filter-group-view')\nexport class FilterGroupView extends WithDisposable(ShadowlessElement) {\n  static override styles = css`\n    filter-group-view {\n      border-radius: 4px;\n      padding: 8px 4px 4px;\n      display: flex;\n      flex-direction: column;\n      user-select: none;\n    }\n\n    .filter-group-op {\n      width: 60px;\n      display: flex;\n      justify-content: end;\n      padding: 4px;\n      height: 34px;\n      align-items: center;\n      font-size: 14px;\n      font-style: normal;\n      font-weight: 400;\n      line-height: 22px;\n      color: var(--affine-text-primary-color);\n    }\n\n    .filter-group-op-clickable {\n      border-radius: 4px;\n      cursor: pointer;\n    }\n\n    .filter-group-op-clickable:hover {\n      background-color: var(--affine-hover-color);\n    }\n\n    .filter-group-container {\n      display: flex;\n      flex-direction: column;\n      gap: 2px;\n    }\n\n    .filter-group-button {\n      padding: 8px 12px;\n      display: flex;\n      align-items: center;\n      gap: 6px;\n      font-size: 14px;\n      line-height: 22px;\n      border-radius: 4px;\n      cursor: pointer;\n      color: var(--affine-text-secondary-color);\n    }\n\n    .filter-group-button svg {\n      fill: var(--affine-text-secondary-color);\n      color: var(--affine-text-secondary-color);\n      width: 20px;\n      height: 20px;\n    }\n\n    .filter-group-button:hover {\n      background-color: var(--affine-hover-color);\n      color: var(--affine-text-primary-color);\n    }\n\n    .filter-group-button:hover svg {\n      fill: var(--affine-text-primary-color);\n      color: var(--affine-text-primary-color);\n    }\n\n    .filter-group-item {\n      padding: 4px 0;\n      display: flex;\n      align-items: start;\n      gap: 8px;\n    }\n\n    .filter-group-item-ops {\n      margin-top: 4px;\n      padding: 4px;\n      border-radius: 4px;\n      height: max-content;\n      display: flex;\n      cursor: pointer;\n    }\n\n    .filter-group-item-ops:hover {\n      background-color: var(--affine-hover-color);\n    }\n\n    .filter-group-item-ops svg {\n      fill: var(--affine-text-secondary-color);\n      color: var(--affine-text-secondary-color);\n      width: 18px;\n      height: 18px;\n    }\n\n    .filter-group-item-ops:hover svg {\n      fill: var(--affine-text-primary-color);\n      color: var(--affine-text-primary-color);\n    }\n\n    .delete-style {\n      background-color: var(--affine-background-error-color);\n    }\n\n    .filter-group-border {\n      border: 1px dashed var(--affine-border-color);\n    }\n\n    .filter-group-bg-1 {\n      background-color: var(--affine-background-secondary-color);\n      border: 1px solid var(--affine-border-color);\n    }\n\n    .filter-group-bg-2 {\n      background-color: var(--affine-background-tertiary-color);\n      border: 1px solid var(--affine-border-color);\n    }\n    .hover-style {\n      background-color: var(--affine-hover-color);\n    }\n\n    .delete-style {\n      background-color: var(--affine-background-error-color);\n    }\n  `;\n\n  private _addNew = (e: MouseEvent) => {\n    if (this.isMaxDepth) {\n      this.setData({\n        ...this.data,\n        conditions: [...this.data.conditions, firstFilter(this.vars)],\n      });\n      return;\n    }\n    popAddNewFilter(e.target as HTMLElement, {\n      value: this.data,\n      onChange: this.setData,\n      vars: this.vars,\n    });\n  };\n\n  private _selectOp = (event: MouseEvent) => {\n    popFilterableSimpleMenu(event.target as HTMLElement, [\n      {\n        type: 'action',\n        name: 'And',\n        select: () => {\n          this.setData({\n            ...this.data,\n            op: 'and',\n          });\n        },\n      },\n      {\n        type: 'action',\n        name: 'Or',\n        select: () => {\n          this.setData({\n            ...this.data,\n            op: 'or',\n          });\n        },\n      },\n    ]);\n  };\n\n  private _setFilter = (index: number, filter: Filter) => {\n    this.setData({\n      ...this.data,\n      conditions: this.data.conditions.map((v, i) =>\n        index === i ? filter : v\n      ),\n    });\n  };\n\n  private opMap = {\n    and: 'And',\n    or: 'Or',\n  };\n\n  private get isMaxDepth() {\n    return this.depth === 3;\n  }\n\n  private _clickConditionOps(target: HTMLElement, i: number) {\n    const filter = this.data.conditions[i];\n    popFilterableSimpleMenu(target, [\n      {\n        type: 'action',\n        name: filter.type === 'filter' ? 'Turn into group' : 'Wrap in group',\n        icon: ConvertIcon(),\n        onHover: hover => {\n          this.containerClass = hover\n            ? { index: i, class: 'hover-style' }\n            : undefined;\n        },\n        hide: () => this.depth + getDepth(filter) > 3,\n        select: () => {\n          this.setData({ type: 'group', op: 'and', conditions: [this.data] });\n        },\n      },\n      {\n        type: 'action',\n        name: 'Duplicate',\n        icon: DuplicateIcon(),\n        onHover: hover => {\n          this.containerClass = hover\n            ? { index: i, class: 'hover-style' }\n            : undefined;\n        },\n        select: () => {\n          const conditions = [...this.data.conditions];\n          conditions.splice(\n            i + 1,\n            0,\n            JSON.parse(JSON.stringify(conditions[i]))\n          );\n          this.setData({ ...this.data, conditions: conditions });\n        },\n      },\n      {\n        type: 'group',\n        name: '',\n        children: () => [\n          {\n            type: 'action',\n            name: 'Delete',\n            icon: DeleteIcon(),\n            class: 'delete-item',\n            onHover: hover => {\n              this.containerClass = hover\n                ? { index: i, class: 'delete-style' }\n                : undefined;\n            },\n            select: () => {\n              const conditions = [...this.data.conditions];\n              conditions.splice(i, 1);\n              this.setData({\n                ...this.data,\n                conditions,\n              });\n            },\n          },\n        ],\n      },\n    ]);\n  }\n\n  override render() {\n    const data = this.data;\n    return html`\n      <div class=\"filter-group-container\">\n        ${repeat(data.conditions, (filter, i) => {\n          const clickOps = (e: MouseEvent) => {\n            e.stopPropagation();\n            e.preventDefault();\n            this._clickConditionOps(e.target as HTMLElement, i);\n          };\n          let op: TemplateResult;\n          if (i === 0) {\n            op = html` <div class=\"filter-group-op\">Where</div>`;\n          } else {\n            op = html`\n              <div\n                class=\"filter-group-op filter-group-op-clickable\"\n                @click=\"${this._selectOp}\"\n              >\n                ${this.opMap[data.op]}\n              </div>\n            `;\n          }\n          const classList = classMap({\n            'filter-root-item': true,\n            'filter-exactly-hover-container': true,\n            'dv-pd-4 dv-round-4': true,\n            [this.containerClass?.class ?? '']:\n              this.containerClass?.index === i,\n          });\n          const groupClassList = classMap({\n            [`filter-group-bg-${this.depth}`]: filter.type !== 'filter',\n          });\n          return html` <div class=\"${classList}\" @contextmenu=\"${clickOps}\">\n            ${op}\n            <div\n              style=\"flex:1;display:flex;align-items:start;justify-content: space-between;gap: 8px;\"\n            >\n              ${filter.type === 'filter'\n                ? html`\n                    <filter-condition-view\n                      .setData=\"${(v: Filter) => this._setFilter(i, v)}\"\n                      .vars=\"${this.vars}\"\n                      .data=\"${filter}\"\n                    ></filter-condition-view>\n                  `\n                : html`\n                    <filter-group-view\n                      class=\"${groupClassList}\"\n                      style=\"width: 100%;\"\n                      .depth=\"${this.depth + 1}\"\n                      .setData=\"${(v: Filter) => this._setFilter(i, v)}\"\n                      .vars=\"${this.vars}\"\n                      .data=\"${filter}\"\n                    ></filter-group-view>\n                  `}\n              <div class=\"filter-group-item-ops\" @click=\"${clickOps}\">\n                ${MoreHorizontalIcon()}\n              </div>\n            </div>\n          </div>`;\n        })}\n      </div>\n      <div class=\"filter-group-button\" @click=\"${this._addNew}\">\n        ${PlusIcon()} Add ${this.isMaxDepth ? nothing : ArrowDownSmallIcon()}\n      </div>\n    `;\n  }\n\n  @state()\n  accessor containerClass:\n    | {\n        index: number;\n        class: string;\n      }\n    | undefined = undefined;\n\n  @property({ attribute: false })\n  accessor data!: FilterGroup;\n\n  @property({ attribute: false })\n  accessor depth = 1;\n\n  @property({ attribute: false })\n  accessor setData!: (filter: FilterGroup) => void;\n\n  @property({ attribute: false })\n  accessor vars!: Variable[];\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'filter-group-view': FilterGroupView;\n  }\n}\nexport const getDepth = (filter: Filter): number => {\n  if (filter.type === 'filter') {\n    return 1;\n  }\n  return Math.max(...filter.conditions.map(getDepth)) + 1;\n};\n"]}