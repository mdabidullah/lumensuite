{"version":3,"file":"define.js","sourceRoot":"","sources":["../../../../src/core/common/group-by/define.ts"],"names":[],"mappings":"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","sourcesContent":["import { tBoolean, tNumber, tString, tTag } from '../../logical/data-type.js';\nimport { isTArray, tArray } from '../../logical/typesystem.js';\nimport { createUniComponentFromWebComponent } from '../../utils/uni-component/uni-component.js';\nimport { groupByMatcher } from './matcher.js';\nimport { BooleanGroupView } from './renderer/boolean-group.js';\nimport { NumberGroupView } from './renderer/number-group.js';\nimport { SelectGroupView } from './renderer/select-group.js';\nimport { StringGroupView } from './renderer/string-group.js';\n\nconst ungroups = {\n  key: 'Ungroups',\n  value: null,\n};\ngroupByMatcher.register(tTag.create(), {\n  name: 'select',\n  groupName: (type, value) => {\n    if (tTag.is(type) && type.data) {\n      return type.data.tags.find(v => v.id === value)?.value ?? '';\n    }\n    return '';\n  },\n  defaultKeys: type => {\n    if (tTag.is(type) && type.data) {\n      return [\n        ungroups,\n        ...type.data.tags.map(v => ({\n          key: v.id,\n          value: v.id,\n        })),\n      ];\n    }\n    return [ungroups];\n  },\n  valuesGroup: (value, _type) => {\n    if (value == null) {\n      return [ungroups];\n    }\n    return [\n      {\n        key: `${value}`,\n        value,\n      },\n    ];\n  },\n  view: createUniComponentFromWebComponent(SelectGroupView),\n});\ngroupByMatcher.register(tArray(tTag.create()), {\n  name: 'multi-select',\n  groupName: (type, value) => {\n    if (tTag.is(type) && type.data) {\n      return type.data.tags.find(v => v.id === value)?.value ?? '';\n    }\n    return '';\n  },\n  defaultKeys: type => {\n    if (isTArray(type) && tTag.is(type.ele) && type.ele.data) {\n      return [\n        ungroups,\n        ...type.ele.data.tags.map(v => ({\n          key: v.id,\n          value: v.id,\n        })),\n      ];\n    }\n    return [ungroups];\n  },\n  valuesGroup: (value, _type) => {\n    if (value == null) {\n      return [ungroups];\n    }\n    if (Array.isArray(value)) {\n      if (value.length) {\n        return value.map(id => ({\n          key: `${id}`,\n          value: id,\n        }));\n      }\n    }\n    return [ungroups];\n  },\n  addToGroup: (value, old) => {\n    if (value == null) {\n      return old;\n    }\n    return Array.isArray(old) ? [...old, value] : [value];\n  },\n  removeFromGroup: (value, old) => {\n    if (Array.isArray(old)) {\n      return old.filter(v => v !== value);\n    }\n    return old;\n  },\n  view: createUniComponentFromWebComponent(SelectGroupView),\n});\ngroupByMatcher.register(tString.create(), {\n  name: 'text',\n  groupName: (_type, value) => {\n    return `${value ?? ''}`;\n  },\n  defaultKeys: _type => {\n    return [ungroups];\n  },\n  valuesGroup: (value, _type) => {\n    if (!value) {\n      return [ungroups];\n    }\n    return [\n      {\n        key: `g:${value}`,\n        value,\n      },\n    ];\n  },\n  view: createUniComponentFromWebComponent(StringGroupView),\n});\ngroupByMatcher.register(tNumber.create(), {\n  name: 'number',\n  groupName: (_type, value) => {\n    return `${value ?? ''}`;\n  },\n  defaultKeys: _type => {\n    return [ungroups];\n  },\n  valuesGroup: (value, _type) => {\n    if (typeof value !== 'number') {\n      return [ungroups];\n    }\n    return [\n      {\n        key: `g:${Math.floor(value / 10)}`,\n        value: Math.floor(value / 10),\n      },\n    ];\n  },\n  addToGroup: value => (typeof value === 'number' ? value * 10 : undefined),\n  view: createUniComponentFromWebComponent(NumberGroupView),\n});\n\ngroupByMatcher.register(tBoolean.create(), {\n  name: 'boolean',\n  groupName: (_type, value) => {\n    return `${value?.toString() ?? ''}`;\n  },\n  defaultKeys: _type => {\n    return [\n      { key: 'true', value: true },\n      { key: 'false', value: false },\n    ];\n  },\n  valuesGroup: (value, _type) => {\n    if (typeof value !== 'boolean') {\n      return [\n        {\n          key: 'false',\n          value: false,\n        },\n      ];\n    }\n    return [\n      {\n        key: value.toString(),\n        value: value,\n      },\n    ];\n  },\n  view: createUniComponentFromWebComponent(BooleanGroupView),\n});\n"]}