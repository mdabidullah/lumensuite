{"version":3,"file":"base-cell.js","sourceRoot":"","sources":["../../../src/core/column/base-cell.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,EACL,iBAAiB,EACjB,aAAa,EACb,cAAc,GACf,MAAM,uBAAuB,CAAC;AAC/B,OAAO,EAAE,QAAQ,EAAE,MAAM,0BAA0B,CAAC;AACpD,OAAO,EAAE,QAAQ,EAAE,MAAM,mBAAmB,CAAC;IAKvB,gBAAgB;sBAI5B,aAAa,CAAC,cAAc,CAAC,iBAAiB,CAAC,CAAC;;;;;;;;;;iBAJpC,gBAIpB,SAAQ,WAAgD;;;gCA6FvD,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;qCAG9B,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;6CAG9B,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;YAL/B,iKAAS,IAAI,6BAAJ,IAAI,mFAAqB;YAGlC,gLAAS,SAAS,6BAAT,SAAS,6FAAW;YAG7B,wMAAS,iBAAiB,6BAAjB,iBAAiB,6GAA8B;;;QAzFxD,IAAI,MAAM;YACR,OAAO,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;QAC1B,CAAC;QAED,IAAI,QAAQ;YACV,OAAO,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC;QAC9B,CAAC;QAED,IAAI,GAAG;YACL,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC;QACvB,CAAC;QAED,IAAI,KAAK;YACP,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;QAC3B,CAAC;QAED,IAAI,IAAI;YACN,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC;QACxB,CAAC;QAED,mBAAmB;YACjB,OAAO,IAAI,CAAC;QACd,CAAC;QAED,QAAQ;YACN,OAAO,IAAI,CAAC;QACd,CAAC;QAEQ,iBAAiB;YACxB,KAAK,CAAC,iBAAiB,EAAE,CAAC;YAC1B,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC;YAC1B,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC,EAAE;gBAChD,IAAI,IAAI,CAAC,SAAS,EAAE,CAAC;oBACnB,CAAC,CAAC,eAAe,EAAE,CAAC;gBACtB,CAAC;YACH,CAAC,CAAC,CAAC;YAEH,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC,EAAE;gBAC/C,IAAI,CAAC,IAAI,CAAC,SAAS;oBAAE,OAAO;gBAC5B,CAAC,CAAC,eAAe,EAAE,CAAC;gBACpB,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;YACjB,CAAC,CAAC,CAAC;YAEH,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,IAAI,EAAE,KAAK,EAAE,CAAC,CAAC,EAAE;gBAC9C,IAAI,CAAC,IAAI,CAAC,SAAS;oBAAE,OAAO;gBAC5B,CAAC,CAAC,eAAe,EAAE,CAAC;gBACpB,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YAChB,CAAC,CAAC,CAAC;YAEH,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC,EAAE;gBAChD,IAAI,CAAC,IAAI,CAAC,SAAS;oBAAE,OAAO;gBAC5B,CAAC,CAAC,eAAe,EAAE,CAAC;gBACpB,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;YAClB,CAAC,CAAC,CAAC;QACL,CAAC;QAED,SAAS;YACP,OAAO,IAAI,CAAC;QACd,CAAC;QAED,WAAW;YACT,IAAI,CAAC,aAAa,EAAE,CAAC;QACvB,CAAC;QAED,QAAQ,CAAC,KAAwB;YAC/B,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;QAC5B,CAAC;QAED,MAAM,CAAC,EAAkB,IAAG,CAAC;QAE7B,KAAK,CAAC,EAAkB,IAAG,CAAC;QAE5B,eAAe;YACb,aAAa;QACf,CAAC;QAED,cAAc;YACZ,aAAa;QACf,CAAC;QAED,OAAO,CAAC,EAAkB,IAAG,CAAC;QAG9B,uBAAkC;QAAlC,IAAS,IAAI,0CAAqB;QAAlC,IAAS,IAAI,gDAAqB;QAGlC,4BAA6B;QAA7B,IAAS,SAAS,+CAAW;QAA7B,IAAS,SAAS,qDAAW;QAG7B,oCAAwD;QAAxD,IAAS,iBAAiB,uDAA8B;QAAxD,IAAS,iBAAiB,6DAA8B;;;YAjGxD,cAAS,GAAG,QAAQ,CAAC,GAAG,EAAE;gBACxB,OAAO,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC;YAC1C,CAAC,CAAC,CAAC;YAEH,WAAM,GAAG,QAAQ,CAAC,GAAG,EAAE;gBACrB,OAAO,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;YAChC,CAAC,CAAC,CAAC;YAqFM,kFAAyB;YAGzB,gJAAoB;YAGpB,qKAA+C;;;;;SAxGpC,gBAAgB","sourcesContent":["import {\n  ShadowlessElement,\n  SignalWatcher,\n  WithDisposable,\n} from '@blocksuite/block-std';\nimport { computed } from '@lit-labs/preact-signals';\nimport { property } from 'lit/decorators.js';\n\nimport type { Cell } from '../view-manager/cell.js';\nimport type { CellRenderProps, DataViewCellLifeCycle } from './manager.js';\n\nexport abstract class BaseCellRenderer<\n    Value,\n    Data extends Record<string, unknown> = Record<string, unknown>,\n  >\n  extends SignalWatcher(WithDisposable(ShadowlessElement))\n  implements DataViewCellLifeCycle, CellRenderProps<Data, Value>\n{\n  readonly$ = computed(() => {\n    return this.cell.column.readonly$.value;\n  });\n\n  value$ = computed(() => {\n    return this.cell.value$.value;\n  });\n\n  get column() {\n    return this.cell.column;\n  }\n\n  get readonly() {\n    return this.readonly$.value;\n  }\n\n  get row() {\n    return this.cell.row;\n  }\n\n  get value() {\n    return this.value$.value;\n  }\n\n  get view() {\n    return this.cell.view;\n  }\n\n  beforeEnterEditMode(): boolean {\n    return true;\n  }\n\n  blurCell() {\n    return true;\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n    this.style.width = '100%';\n    this._disposables.addFromEvent(this, 'click', e => {\n      if (this.isEditing) {\n        e.stopPropagation();\n      }\n    });\n\n    this._disposables.addFromEvent(this, 'copy', e => {\n      if (!this.isEditing) return;\n      e.stopPropagation();\n      this.onCopy(e);\n    });\n\n    this._disposables.addFromEvent(this, 'cut', e => {\n      if (!this.isEditing) return;\n      e.stopPropagation();\n      this.onCut(e);\n    });\n\n    this._disposables.addFromEvent(this, 'paste', e => {\n      if (!this.isEditing) return;\n      e.stopPropagation();\n      this.onPaste(e);\n    });\n  }\n\n  focusCell() {\n    return true;\n  }\n\n  forceUpdate(): void {\n    this.requestUpdate();\n  }\n\n  onChange(value: Value | undefined): void {\n    this.cell.setValue(value);\n  }\n\n  onCopy(_e: ClipboardEvent) {}\n\n  onCut(_e: ClipboardEvent) {}\n\n  onEnterEditMode(): void {\n    // do nothing\n  }\n\n  onExitEditMode() {\n    // do nothing\n  }\n\n  onPaste(_e: ClipboardEvent) {}\n\n  @property({ attribute: false })\n  accessor cell!: Cell<Value, Data>;\n\n  @property({ attribute: false })\n  accessor isEditing!: boolean;\n\n  @property({ attribute: false })\n  accessor selectCurrentCell!: (editing: boolean) => void;\n}\n"]}