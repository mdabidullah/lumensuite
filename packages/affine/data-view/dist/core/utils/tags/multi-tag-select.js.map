{"version":3,"file":"multi-tag-select.js","sourceRoot":"","sources":["../../../../src/core/utils/tags/multi-tag-select.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  createPopup,\n  popMenu,\n} from '@blocksuite/affine-components/context-menu';\nimport { rangeWrap } from '@blocksuite/affine-shared/utils';\nimport { ShadowlessElement, WithDisposable } from '@blocksuite/block-std';\nimport {\n  CloseIcon,\n  DeleteIcon,\n  MoreHorizontalIcon,\n  PlusIcon,\n} from '@blocksuite/icons/lit';\nimport { nanoid } from '@blocksuite/store';\nimport { autoPlacement, flip, offset } from '@floating-ui/dom';\nimport { customElement, property, query, state } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { repeat } from 'lit/directives/repeat.js';\nimport { styleMap } from 'lit/directives/style-map.js';\nimport { html } from 'lit/static-html.js';\n\nimport { stopPropagation } from '../event.js';\nimport { getTagColor, selectOptionColors } from './colors.js';\nimport { styles } from './styles.js';\n\nexport type SelectTag = {\n  id: string;\n  color: string;\n  value: string;\n  parentId?: string;\n};\n\ntype RenderOption = {\n  value: string;\n  id: string;\n  color: string;\n  isCreate: boolean;\n  group: SelectTag[];\n  select: () => void;\n};\n\n@customElement('affine-multi-tag-select')\nexport class MultiTagSelect extends WithDisposable(ShadowlessElement) {\n  static override styles = styles;\n\n  private _clickItemOption = (e: MouseEvent, id: string) => {\n    e.stopPropagation();\n    const option = this.options.find(v => v.id === id);\n    if (!option) {\n      return;\n    }\n    popMenu(e.target as HTMLElement, {\n      options: {\n        input: {\n          initValue: option.value,\n          onComplete: text => {\n            this.changeTag({\n              ...option,\n              value: text,\n            });\n          },\n        },\n        items: [\n          {\n            type: 'action',\n            name: 'Delete',\n            icon: DeleteIcon(),\n            class: 'delete-item',\n            select: () => {\n              this.deleteTag(id);\n            },\n          },\n          {\n            type: 'group',\n            name: 'color',\n            children: () =>\n              selectOptionColors.map(item => {\n                const styles = styleMap({\n                  backgroundColor: item.color,\n                  borderRadius: '50%',\n                  width: '20px',\n                  height: '20px',\n                });\n                return {\n                  type: 'action',\n                  name: item.name,\n                  icon: html` <div style=${styles}></div>`,\n                  isSelected: option.color === item.color,\n                  select: () => {\n                    this.changeTag({\n                      ...option,\n                      color: item.color,\n                    });\n                  },\n                };\n              }),\n          },\n        ],\n      },\n      middleware: [autoPlacement()],\n    });\n  };\n\n  private _createOption = () => {\n    const value = this.text.trim();\n    if (value === '') return;\n    const groupInfo = this.getGroupInfoByFullName(value);\n    if (!groupInfo) {\n      return;\n    }\n    const name = groupInfo.name;\n    const tagColor = this.color;\n    this.clearColor();\n    const newSelect: SelectTag = {\n      id: nanoid(),\n      value: name,\n      color: tagColor,\n      parentId: groupInfo.parent?.id,\n    };\n    this.newTags([newSelect]);\n    const newValue = this.isSingleMode\n      ? [newSelect.id]\n      : [...this.value, newSelect.id];\n    this.onChange(newValue);\n    this.text = '';\n    if (this.isSingleMode) {\n      this.editComplete();\n    }\n  };\n\n  private _currentColor: string | undefined = undefined;\n\n  private _onDeleteSelected = (selectedValue: string[], value: string) => {\n    const filteredValue = selectedValue.filter(item => item !== value);\n    this.onChange(filteredValue);\n  };\n\n  private _onInput = (event: KeyboardEvent) => {\n    this.text = (event.target as HTMLInputElement).value;\n  };\n\n  private _onInputKeydown = (event: KeyboardEvent) => {\n    event.stopPropagation();\n    const inputValue = this.text.trim();\n    if (event.key === 'Backspace' && inputValue === '') {\n      this._onDeleteSelected(this.value, this.value[this.value.length - 1]);\n    } else if (event.key === 'Enter' && !event.isComposing) {\n      this.selectedTag?.select();\n    } else if (event.key === 'ArrowUp') {\n      event.preventDefault();\n      this.setSelectedOption(this.selectedIndex - 1);\n    } else if (event.key === 'ArrowDown') {\n      event.preventDefault();\n      this.setSelectedOption(this.selectedIndex + 1);\n    } else if (event.key === 'Escape') {\n      this.editComplete();\n    } else if (event.key === 'Tab') {\n      event.preventDefault();\n      const selectTag = this.selectedTag;\n      if (selectTag) {\n        this.text = this.getTagFullName(selectTag, selectTag.group);\n      }\n    }\n  };\n\n  private _onSelect = (id: string) => {\n    const isExist = this.value.some(item => item === id);\n    if (isExist) {\n      // this.editComplete();\n      return;\n    }\n\n    const isSelected = this.value.indexOf(id) > -1;\n    if (!isSelected) {\n      const newValue = this.isSingleMode ? [id] : [...this.value, id];\n      this.onChange(newValue);\n      if (this.isSingleMode) {\n        setTimeout(() => {\n          this.editComplete();\n        }, 4);\n      }\n    }\n    this.text = '';\n  };\n\n  private filteredOptions: Array<RenderOption> = [];\n\n  changeTag = (tag: SelectTag) => {\n    this.onOptionsChange(this.options.map(v => (v.id === tag.id ? tag : v)));\n  };\n\n  deleteTag = (id: string) => {\n    this.onOptionsChange(\n      this.options\n        .filter(v => v.id !== id)\n        .map(v => ({\n          ...v,\n          parentId: v.parentId === id ? undefined : v.parentId,\n        }))\n    );\n  };\n\n  newTags = (tags: SelectTag[]) => {\n    this.onOptionsChange([...tags, ...this.options]);\n  };\n\n  private get color() {\n    if (!this._currentColor) {\n      this._currentColor = getTagColor();\n    }\n    return this._currentColor;\n  }\n\n  get isSingleMode() {\n    return this.mode === 'single';\n  }\n\n  private get selectedTag() {\n    return this.filteredOptions[this.selectedIndex];\n  }\n\n  private _filterOptions() {\n    const map = this.optionsIdMap();\n    let matched = false;\n    const options: RenderOption[] = this.options\n      .map(v => ({\n        ...v,\n        group: this.getTagGroup(v, map),\n      }))\n      .filter(item => {\n        if (!this.text) {\n          return true;\n        }\n        return this.getTagFullName(item, item.group)\n          .toLocaleLowerCase()\n          .includes(this.text.toLocaleLowerCase());\n      })\n      .map(v => {\n        const fullName = this.getTagFullName(v, v.group);\n        if (fullName === this.text) {\n          matched = true;\n        }\n        return {\n          ...v,\n          isCreate: false,\n          select: () => this._onSelect(v.id),\n        };\n      });\n    if (this.text && !matched) {\n      options.push({\n        id: 'create',\n        color: this.color,\n        value: this.text,\n        isCreate: true,\n        group: [],\n        select: this._createOption,\n      });\n    }\n    return options;\n  }\n\n  private clearColor() {\n    this._currentColor = undefined;\n  }\n\n  private getGroupInfoByFullName(name: string) {\n    const strings = name.split('/');\n    const names = strings.slice(0, -1);\n    const result: SelectTag[] = [];\n    for (const text of names) {\n      const parent = result[result.length - 1];\n      const tag = this.options.find(\n        v => v.parentId === parent?.id && v.value === text\n      );\n      if (!tag) {\n        return;\n      }\n      result.push(tag);\n    }\n    return {\n      name: strings[strings.length - 1],\n      group: result,\n      parent: result[result.length - 1],\n    };\n  }\n\n  private getTagFullName(tag: SelectTag, group: SelectTag[]) {\n    return [...group, tag].map(v => v.value).join('/');\n  }\n\n  private getTagGroup(tag: SelectTag, map = this.optionsIdMap()): SelectTag[] {\n    const result = [];\n    let parentId = tag.parentId;\n    while (parentId) {\n      const parent = map[parentId];\n      result.unshift(parent);\n      parentId = parent.parentId;\n    }\n    return result;\n  }\n\n  private optionsIdMap() {\n    return Object.fromEntries(this.options.map(v => [v.id, v]));\n  }\n\n  private setSelectedOption(index: number) {\n    this.selectedIndex = rangeWrap(index, 0, this.filteredOptions.length);\n  }\n\n  protected override firstUpdated() {\n    requestAnimationFrame(() => {\n      this._selectInput.focus();\n    });\n    this._disposables.addFromEvent(this, 'click', () => {\n      this._selectInput.focus();\n    });\n\n    this._disposables.addFromEvent(this._selectInput, 'copy', e => {\n      e.stopPropagation();\n    });\n    this._disposables.addFromEvent(this._selectInput, 'cut', e => {\n      e.stopPropagation();\n    });\n  }\n\n  override render() {\n    this.filteredOptions = this._filterOptions();\n    this.setSelectedOption(this.selectedIndex);\n    const selectedTag = this.value;\n    const map = new Map<string, SelectTag>(this.options.map(v => [v.id, v]));\n    return html`\n      <div class=\"affine-select-cell-select\">\n        <div class=\"select-input-container\">\n          ${selectedTag.map(id => {\n            const option = map.get(id);\n            if (!option) {\n              return;\n            }\n            const style = styleMap({\n              backgroundColor: option.color,\n            });\n            return html` <div class=\"select-selected\" style=${style}>\n              <div class=\"select-selected-text\">${option.value}</div>\n              <span\n                class=\"close-icon\"\n                @click=\"${() => this._onDeleteSelected(selectedTag, id)}\"\n                >${CloseIcon()}</span\n              >\n            </div>`;\n          })}\n          <input\n            class=\"select-input\"\n            placeholder=\"Type here...\"\n            .value=\"${this.text}\"\n            @input=\"${this._onInput}\"\n            @keydown=\"${this._onInputKeydown}\"\n            @pointerdown=\"${stopPropagation}\"\n          />\n        </div>\n        <div class=\"select-option-container\">\n          <div class=\"select-option-container-header\">\n            Select tag or create one\n          </div>\n          ${repeat(\n            this.filteredOptions,\n            select => select.id,\n            (select, index) => {\n              const isSelected = index === this.selectedIndex;\n              const mouseenter = () => {\n                this.setSelectedOption(index);\n              };\n              const classes = classMap({\n                'select-option': true,\n                selected: isSelected,\n              });\n              const style = styleMap({\n                backgroundColor: select.color,\n              });\n              const clickOption = (e: MouseEvent) =>\n                this._clickItemOption(e, select.id);\n              return html`\n                <div class=\"${classes}\" @mouseenter=\"${mouseenter}\">\n                  <div\n                    class=\"select-option-text-container\"\n                    @click=\"${select.select}\"\n                  >\n                    ${select.isCreate\n                      ? html` <div class=\"select-option-new-icon\">\n                          Create ${PlusIcon()}\n                        </div>`\n                      : ''}\n                    <div style=\"display:flex;flex-direction: column\">\n                      <div\n                        style=\"display:flex;align-items:center;margin-bottom: 2px;opacity: 0.5;\"\n                      >\n                        ${select.group.map((v, i) => {\n                          const style = styleMap({\n                            backgroundColor: v.color,\n                          });\n                          return html`${i === 0\n                              ? ''\n                              : html`<span style=\"margin: 0 1px\">/</span>`}<span\n                              class=\"select-option-group-name\"\n                              style=${style}\n                              >${v.value}</span\n                            >`;\n                        })}\n                      </div>\n                      <div style=\"display:flex;\">\n                        <div style=${style} class=\"select-option-name\">\n                          ${select.value}\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                  ${!select.isCreate\n                    ? html` <div\n                        class=\"select-option-icon\"\n                        @click=\"${clickOption}\"\n                      >\n                        ${MoreHorizontalIcon()}\n                      </div>`\n                    : null}\n                </div>\n              `;\n            }\n          )}\n        </div>\n      </div>\n    `;\n  }\n\n  @query('.select-input')\n  private accessor _selectInput!: HTMLInputElement;\n\n  @property({ attribute: false })\n  accessor editComplete!: () => void;\n\n  @property()\n  accessor mode: 'multi' | 'single' = 'multi';\n\n  @property({ attribute: false })\n  accessor onChange!: (value: string[]) => void;\n\n  @property({ attribute: false })\n  accessor onOptionsChange!: (options: SelectTag[]) => void;\n\n  @property({ attribute: false })\n  accessor options: SelectTag[] = [];\n\n  @state()\n  private accessor selectedIndex = 0;\n\n  @state()\n  private accessor text = '';\n\n  @property({ attribute: false })\n  accessor value: string[] = [];\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'affine-multi-tag-select': MultiTagSelect;\n  }\n}\n\nexport const popTagSelect = (\n  target: HTMLElement,\n  ops: {\n    mode?: 'single' | 'multi';\n    value: string[];\n    onChange: (value: string[]) => void;\n    options: SelectTag[];\n    onOptionsChange: (options: SelectTag[]) => void;\n    onComplete?: () => void;\n    minWidth?: number;\n    container?: HTMLElement;\n  }\n) => {\n  const component = new MultiTagSelect();\n  if (ops.mode) {\n    component.mode = ops.mode;\n  }\n  component.style.width = `${Math.max(\n    ops.minWidth ?? target.offsetWidth,\n    target.offsetWidth\n  )}px`;\n  component.value = ops.value;\n  component.onChange = tags => {\n    ops.onChange(tags);\n    component.value = tags;\n  };\n  component.options = ops.options;\n  component.onOptionsChange = options => {\n    ops.onOptionsChange(options);\n    component.options = options;\n  };\n  component.editComplete = () => {\n    ops.onComplete?.();\n    remove();\n  };\n  const remove = createPopup(target, component, {\n    onClose: ops.onComplete,\n    middleware: [flip(), offset({ mainAxis: -28, crossAxis: 112 })],\n    container: ops.container,\n  });\n  return remove;\n};\n"]}