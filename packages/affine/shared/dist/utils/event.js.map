{"version":3,"file":"event.js","sourceRoot":"","sources":["../../src/utils/event.ts"],"names":[],"mappings":"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","sourcesContent":["import { IS_IOS, IS_MAC } from '@lumensuite/global/env';\n\nexport function isTouchPadPinchEvent(e: WheelEvent) {\n  // two finger pinches on touch pad, ctrlKey is always true.\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=397027\n  if (IS_IOS || IS_MAC) {\n    return e.ctrlKey || e.metaKey;\n  }\n  return e.ctrlKey;\n}\n\n// See https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/buttons\nexport enum MOUSE_BUTTONS {\n  AUXILIARY = 4,\n  FIFTH = 16,\n  FORTH = 8,\n  NO_BUTTON = 0,\n  PRIMARY = 1,\n  SECONDARY = 2,\n}\n\nexport enum MOUSE_BUTTON {\n  AUXILIARY = 1,\n  FIFTH = 4,\n  FORTH = 3,\n  MAIN = 0,\n  SECONDARY = 2,\n}\n\nexport function isMiddleButtonPressed(e: MouseEvent) {\n  return (MOUSE_BUTTONS.AUXILIARY & e.buttons) === MOUSE_BUTTONS.AUXILIARY;\n}\n\nexport function isRightButtonPressed(e: MouseEvent) {\n  return (MOUSE_BUTTONS.SECONDARY & e.buttons) === MOUSE_BUTTONS.SECONDARY;\n}\n\nexport function stopPropagation(event: Event) {\n  event.stopPropagation();\n}\n\nexport function isControlledKeyboardEvent(e: KeyboardEvent) {\n  return e.ctrlKey || e.metaKey || e.altKey;\n}\n\nexport function on<\n  T extends HTMLElement,\n  K extends keyof M,\n  M = HTMLElementEventMap,\n>(\n  element: T,\n  event: K,\n  handler: (ev: M[K]) => void,\n  options?: boolean | AddEventListenerOptions\n): () => void;\nexport function on<T extends HTMLElement>(\n  element: T,\n  event: string,\n  handler: (ev: Event) => void,\n  options?: boolean | AddEventListenerOptions\n): () => void;\nexport function on<T extends Document, K extends keyof M, M = DocumentEventMap>(\n  element: T,\n  event: K,\n  handler: (ev: M[K]) => void,\n  options?: boolean | AddEventListenerOptions\n): () => void;\nexport function on<\n  T extends HTMLElement | Document,\n  K extends keyof HTMLElementEventMap,\n>(\n  element: T,\n  event: K,\n  handler: (ev: HTMLElementEventMap[K]) => void,\n  options?: boolean | AddEventListenerOptions\n) {\n  const dispose = () => {\n    element.removeEventListener(\n      event as string,\n      handler as unknown as EventListenerObject,\n      options\n    );\n  };\n\n  element.addEventListener(\n    event as string,\n    handler as unknown as EventListenerObject,\n    options\n  );\n\n  return dispose;\n}\n\nexport function once<\n  T extends HTMLElement,\n  K extends keyof M,\n  M = HTMLElementEventMap,\n>(\n  element: T,\n  event: K,\n  handler: (ev: M[K]) => void,\n  options?: boolean | AddEventListenerOptions\n): () => void;\nexport function once<T extends HTMLElement>(\n  element: T,\n  event: string,\n  handler: (ev: Event) => void,\n  options?: boolean | AddEventListenerOptions\n): () => void;\nexport function once<\n  T extends Document,\n  K extends keyof M,\n  M = DocumentEventMap,\n>(\n  element: T,\n  event: K,\n  handler: (ev: M[K]) => void,\n  options?: boolean | AddEventListenerOptions\n): () => void;\nexport function once<\n  T extends HTMLElement,\n  K extends keyof HTMLElementEventMap,\n>(\n  element: T,\n  event: K,\n  handler: (ev: HTMLElementEventMap[K]) => void,\n  options?: boolean | AddEventListenerOptions\n) {\n  const onceHandler = (e: HTMLElementEventMap[K]) => {\n    dispose();\n    handler(e);\n  };\n  const dispose = () => {\n    element.removeEventListener(event, onceHandler, options);\n  };\n\n  element.addEventListener(event, onceHandler, options);\n\n  return dispose;\n}\n\nexport function delayCallback(callback: () => void, delay: number = 0) {\n  const timeoutId = setTimeout(callback, delay);\n\n  return () => clearTimeout(timeoutId);\n}\n\n/**\n * A wrapper around `requestAnimationFrame` that only calls the callback if the\n * element is still connected to the DOM.\n */\nexport function requestConnectedFrame(\n  callback: () => void,\n  element?: HTMLElement\n) {\n  return requestAnimationFrame(() => {\n    // If element is not provided, fallback to `requestAnimationFrame`\n    if (element === undefined) {\n      callback();\n      return;\n    }\n\n    // Only calls callback if element is still connected to the DOM\n    if (element.isConnected) callback();\n  });\n}\n\n/**\n * A wrapper around `requestConnectedFrame` that only calls at most once in one frame\n */\nexport function requestThrottledConnectedFrame<\n  T extends (...args: unknown[]) => void,\n>(func: T, element?: HTMLElement): T {\n  let raqId: number | undefined = undefined;\n  let latestArgs: unknown[] = [];\n\n  return ((...args: unknown[]) => {\n    latestArgs = args;\n\n    raqId && cancelAnimationFrame(raqId);\n\n    raqId = requestConnectedFrame(() => {\n      raqId = undefined;\n      func(...latestArgs);\n    }, element);\n  }) as T;\n}\n"]}