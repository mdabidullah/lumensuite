{"version":3,"file":"get-block-index.js","sourceRoot":"","sources":["../../../src/commands/block-crud/get-block-index.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,YAAY,EAAE,MAAM,0BAA0B,CAAC;AAExD,MAAM,CAAC,MAAM,oBAAoB,GAM7B,CAAC,GAAG,EAAE,IAAI,EAAE,EAAE;IAChB,MAAM,IAAI,GAAG,GAAG,CAAC,IAAI,IAAI,GAAG,CAAC,oBAAoB,CAAC;IAClD,YAAY,CACV,IAAI,EACJ,oGAAoG,CACrG,CAAC;IAEF,MAAM,WAAW,GAAG,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;IAChD,IAAI,CAAC,WAAW;QAAE,OAAO;IAEzB,MAAM,MAAM,GAAG,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;IACrD,IAAI,CAAC,MAAM;QAAE,OAAO;IAEpB,MAAM,KAAK,GAAG,MAAM,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE;QAC7C,OAAO,CAAC,CAAC,OAAO,KAAK,IAAI,CAAC;IAC5B,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC;QACH,UAAU,EAAE,KAAK;QACjB,WAAW,EAAE,MAAwB;KACtC,CAAC,CAAC;AACL,CAAC,CAAC","sourcesContent":["import type { BlockComponent, Command } from '@blocksuite/block-std';\n\nimport { assertExists } from '@blocksuite/global/utils';\n\nexport const getBlockIndexCommand: Command<\n  'currentSelectionPath',\n  'blockIndex' | 'parentBlock',\n  {\n    path?: string;\n  }\n> = (ctx, next) => {\n  const path = ctx.path ?? ctx.currentSelectionPath;\n  assertExists(\n    path,\n    '`path` is required, you need to pass it in args or ctx before adding this command to the pipeline.'\n  );\n\n  const parentModel = ctx.std.doc.getParent(path);\n  if (!parentModel) return;\n\n  const parent = ctx.std.view.getBlock(parentModel.id);\n  if (!parent) return;\n\n  const index = parent.childBlocks.findIndex(x => {\n    return x.blockId === path;\n  });\n\n  next({\n    blockIndex: index,\n    parentBlock: parent as BlockComponent,\n  });\n};\n\ndeclare global {\n  namespace BlockSuite {\n    interface CommandContext {\n      blockIndex?: number;\n      parentBlock?: BlockComponent;\n    }\n\n    interface Commands {\n      getBlockIndex: typeof getBlockIndexCommand;\n    }\n  }\n}\n"]}