{"version":3,"file":"middleware.js","sourceRoot":"","sources":["../../src/transformer/middleware.ts"],"names":[],"mappings":"","sourcesContent":["import type { Slot } from '@lumensuite/global/utils';\n\nimport type { Doc, DocCollection } from '../store/index.js';\nimport type { AssetsManager } from './assets.js';\nimport type { DraftModel } from './draft.js';\nimport type { Slice } from './slice.js';\nimport type {\n  BlockSnapshot,\n  CollectionInfoSnapshot,\n  DocSnapshot,\n  SliceSnapshot,\n} from './type.js';\n\nexport type BeforeImportPayload =\n  | {\n      snapshot: BlockSnapshot;\n      type: 'block';\n      parent?: string;\n      index?: number;\n    }\n  | {\n      snapshot: SliceSnapshot;\n      type: 'slice';\n    }\n  | {\n      snapshot: DocSnapshot;\n      type: 'page';\n    }\n  | {\n      snapshot: CollectionInfoSnapshot;\n      type: 'info';\n    };\n\nexport type BeforeExportPayload =\n  | {\n      model: DraftModel;\n      type: 'block';\n    }\n  | {\n      page: Doc;\n      type: 'page';\n    }\n  | {\n      slice: Slice;\n      type: 'slice';\n    }\n  | {\n      type: 'info';\n    };\n\nexport type FinalPayload =\n  | {\n      snapshot: BlockSnapshot;\n      type: 'block';\n      model: DraftModel;\n      parent?: string;\n      index?: number;\n    }\n  | {\n      snapshot: DocSnapshot;\n      type: 'page';\n      page: Doc;\n    }\n  | {\n      snapshot: SliceSnapshot;\n      type: 'slice';\n      slice: Slice;\n    }\n  | {\n      snapshot: CollectionInfoSnapshot;\n      type: 'info';\n    };\n\nexport type JobSlots = {\n  beforeImport: Slot<BeforeImportPayload>;\n  afterImport: Slot<FinalPayload>;\n  beforeExport: Slot<BeforeExportPayload>;\n  afterExport: Slot<FinalPayload>;\n};\n\ntype JobMiddlewareOptions = {\n  collection: DocCollection;\n  assetsManager: AssetsManager;\n  slots: JobSlots;\n  adapterConfigs: Map<string, string>;\n};\n\nexport type JobMiddleware = (options: JobMiddlewareOptions) => void;\n"]}