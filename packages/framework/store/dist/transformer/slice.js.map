{"version":3,"file":"slice.js","sourceRoot":"","sources":["../../src/transformer/slice.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,eAAe,EAAE,SAAS,EAAE,MAAM,+BAA+B,CAAC;AAa3E,MAAM,OAAO,KAAK;IAChB,IAAI,OAAO;QACT,OAAO,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;IAC3B,CAAC;IAED,IAAI,KAAK;QACP,OAAO,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;IAC1B,CAAC;IAED,IAAI,WAAW;QACb,OAAO,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC;IAC/B,CAAC;IAED,IAAI,WAAW;QACb,OAAO,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC;IAC/B,CAAC;IAED,IAAI,gBAAgB;QAClB,OAAO,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC;IACpC,CAAC;IAED,YAAqB,IAAe;QAAf,SAAI,GAAJ,IAAI,CAAW;IAAG,CAAC;IAExC,MAAM,CAAC,UAAU,CAAC,GAAQ,EAAE,MAAoB;QAC9C,MAAM,IAAI,GAAG,GAAG,CAAC,UAAU,CAAC,IAAI,CAAC;QACjC,MAAM,EAAE,WAAW,EAAE,gBAAgB,EAAE,GAAG,IAAI,CAAC;QAC/C,IAAI,CAAC,WAAW,IAAI,CAAC,gBAAgB,EAAE,CAAC;YACtC,MAAM,IAAI,eAAe,CACvB,SAAS,CAAC,cAAc,EACxB,+DAA+D,CAChE,CAAC;QACJ,CAAC;QACD,OAAO,IAAI,KAAK,CAAC;YACf,OAAO,EAAE,MAAM;YACf,WAAW,EAAE,GAAG,CAAC,UAAU,CAAC,EAAE;YAC9B,MAAM,EAAE,GAAG,CAAC,EAAE;YACd,WAAW;YACX,gBAAgB;SACjB,CAAC,CAAC;IACL,CAAC;CACF","sourcesContent":["import { LumenSuiteError, ErrorCode } from '@lumensuite/global/exceptions';\n\nimport type { Doc } from '../store/index.js';\nimport type { DraftModel } from './draft.js';\n\ntype SliceData = {\n  content: DraftModel[];\n  workspaceId: string;\n  pageId: string;\n  pageVersion: number;\n  workspaceVersion: number;\n};\n\nexport class Slice {\n  get content() {\n    return this.data.content;\n  }\n\n  get docId() {\n    return this.data.pageId;\n  }\n\n  get pageVersion() {\n    return this.data.pageVersion;\n  }\n\n  get workspaceId() {\n    return this.data.workspaceId;\n  }\n\n  get workspaceVersion() {\n    return this.data.workspaceVersion;\n  }\n\n  constructor(readonly data: SliceData) {}\n\n  static fromModels(doc: Doc, models: DraftModel[]) {\n    const meta = doc.collection.meta;\n    const { pageVersion, workspaceVersion } = meta;\n    if (!pageVersion || !workspaceVersion) {\n      throw new LumenSuiteError(\n        ErrorCode.ModelCRUDError,\n        'pageVersion or workspaceVersion not found when creating slice'\n      );\n    }\n    return new Slice({\n      content: models,\n      workspaceId: doc.collection.id,\n      pageId: doc.id,\n      pageVersion,\n      workspaceVersion,\n    });\n  }\n}\n"]}