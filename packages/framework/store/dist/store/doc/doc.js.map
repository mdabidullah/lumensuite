{"version":3,"file":"doc.js","sourceRoot":"","sources":["../../../src/store/doc/doc.ts"],"names":[],"mappings":"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","sourcesContent":["import { BlockSuiteError, ErrorCode } from '@blocksuite/global/exceptions';\nimport { type Disposable, Slot } from '@blocksuite/global/utils';\nimport { signal } from '@preact/signals-core';\n\nimport type { BlockModel, Schema } from '../../schema/index.js';\nimport type { BlockOptions } from './block/index.js';\nimport type { BlockCollection, BlockProps } from './block-collection.js';\nimport type { DocCRUD } from './crud.js';\n\nimport { syncBlockProps } from '../../utils/utils.js';\nimport { Block } from './block/index.js';\nimport { type Query, runQuery } from './query.js';\n\ntype DocOptions = {\n  schema: Schema;\n  blockCollection: BlockCollection;\n  crud: DocCRUD;\n  readonly?: boolean;\n  query?: Query;\n};\n\nexport class Doc {\n  private _runQuery = (block: Block) => {\n    runQuery(this._query, block);\n  };\n\n  protected readonly _blockCollection: BlockCollection;\n\n  protected readonly _blocks = signal<Record<string, Block>>({});\n\n  protected readonly _crud: DocCRUD;\n\n  protected readonly _disposeBlockUpdated: Disposable;\n\n  protected readonly _query: Query = {\n    match: [],\n    mode: 'loose',\n  };\n\n  protected readonly _readonly?: boolean;\n\n  protected readonly _schema: Schema;\n\n  readonly slots: BlockCollection['slots'] & {\n    /** This is always triggered after `doc.load` is called. */\n    ready: Slot;\n    /**\n     * This fires when the root block is added via API call or has just been initialized from existing ydoc.\n     * useful for internal block UI components to start subscribing following up events.\n     * Note that at this moment, the whole block tree may not be fully initialized yet.\n     */\n    rootAdded: Slot<string>;\n    rootDeleted: Slot<string>;\n    blockUpdated: Slot<\n      | {\n          type: 'add';\n          id: string;\n          init: boolean;\n          flavour: string;\n          model: BlockModel;\n        }\n      | {\n          type: 'delete';\n          id: string;\n          flavour: string;\n          parent: string;\n          model: BlockModel;\n        }\n      | {\n          type: 'update';\n          id: string;\n          flavour: string;\n          props: { key: string };\n        }\n    >;\n  };\n\n  private get _yBlocks() {\n    return this._blockCollection.yBlocks;\n  }\n\n  get awarenessStore() {\n    return this._blockCollection.awarenessStore;\n  }\n\n  get awarenessSync() {\n    return this.collection.awarenessSync;\n  }\n\n  get blobSync() {\n    return this.collection.blobSync;\n  }\n\n  get blockCollection() {\n    return this._blockCollection;\n  }\n\n  get blocks() {\n    return this._blocks;\n  }\n\n  get blockSize() {\n    return Object.values(this._blocks.peek()).length;\n  }\n\n  get canRedo() {\n    return this._blockCollection.canRedo;\n  }\n\n  get canUndo() {\n    return this._blockCollection.canUndo;\n  }\n\n  get captureSync() {\n    return this._blockCollection.captureSync.bind(this._blockCollection);\n  }\n\n  get clear() {\n    return this._blockCollection.clear.bind(this._blockCollection);\n  }\n\n  get collection() {\n    return this._blockCollection.collection;\n  }\n\n  get docSync() {\n    return this.collection.docSync;\n  }\n\n  get generateBlockId() {\n    return this._blockCollection.generateBlockId.bind(this._blockCollection);\n  }\n\n  get history() {\n    return this._blockCollection.history;\n  }\n\n  get id() {\n    return this._blockCollection.id;\n  }\n\n  get isEmpty() {\n    return Object.values(this._blocks.peek()).length === 0;\n  }\n\n  get loaded() {\n    return this._blockCollection.loaded;\n  }\n\n  get meta() {\n    return this._blockCollection.meta;\n  }\n\n  get readonly() {\n    if (this._blockCollection.readonly) {\n      return true;\n    }\n    return this._readonly === true;\n  }\n\n  get ready() {\n    return this._blockCollection.ready;\n  }\n\n  get redo() {\n    return this._blockCollection.redo.bind(this._blockCollection);\n  }\n\n  get resetHistory() {\n    return this._blockCollection.resetHistory.bind(this._blockCollection);\n  }\n\n  get root() {\n    const rootId = this._crud.root;\n    if (!rootId) return null;\n    return this.getBlock(rootId)?.model ?? null;\n  }\n\n  get rootDoc() {\n    return this._blockCollection.rootDoc;\n  }\n\n  get schema() {\n    return this._schema;\n  }\n\n  get spaceDoc() {\n    return this._blockCollection.spaceDoc;\n  }\n\n  get Text() {\n    return this._blockCollection.Text;\n  }\n\n  get transact() {\n    return this._blockCollection.transact.bind(this._blockCollection);\n  }\n\n  get undo() {\n    return this._blockCollection.undo.bind(this._blockCollection);\n  }\n\n  get withoutTransact() {\n    return this._blockCollection.withoutTransact.bind(this._blockCollection);\n  }\n\n  constructor({ schema, blockCollection, crud, readonly, query }: DocOptions) {\n    this._blockCollection = blockCollection;\n\n    this.slots = {\n      ready: new Slot(),\n      rootAdded: new Slot(),\n      rootDeleted: new Slot(),\n      blockUpdated: new Slot(),\n      historyUpdated: this._blockCollection.slots.historyUpdated,\n      yBlockUpdated: this._blockCollection.slots.yBlockUpdated,\n    };\n\n    this._crud = crud;\n    this._schema = schema;\n    this._readonly = readonly;\n    if (query) {\n      this._query = query;\n    }\n\n    this._yBlocks.forEach((_, id) => {\n      if (id in this._blocks.peek()) {\n        return;\n      }\n      this._onBlockAdded(id, true);\n    });\n\n    this._disposeBlockUpdated = this._blockCollection.slots.yBlockUpdated.on(\n      ({ type, id }) => {\n        switch (type) {\n          case 'add': {\n            this._onBlockAdded(id);\n            return;\n          }\n          case 'delete': {\n            this._onBlockRemoved(id);\n            return;\n          }\n        }\n      }\n    );\n  }\n\n  private _getSiblings<T>(\n    block: BlockModel | string,\n    fn: (parent: BlockModel, index: number) => T\n  ) {\n    const parent = this.getParent(block);\n    if (!parent) return null;\n\n    const blockModel =\n      typeof block === 'string' ? this.getBlock(block)?.model : block;\n    if (!blockModel) return null;\n\n    const index = parent.children.indexOf(blockModel);\n    if (index === -1) return null;\n\n    return fn(parent, index);\n  }\n\n  private _onBlockAdded(id: string, init = false) {\n    try {\n      if (id in this._blocks.peek()) {\n        return;\n      }\n      const yBlock = this._yBlocks.get(id);\n      if (!yBlock) {\n        console.warn(`Could not find block with id ${id}`);\n        return;\n      }\n\n      const options: BlockOptions = {\n        onChange: (block, key) => {\n          if (key) {\n            block.model.propsUpdated.emit({ key });\n          }\n\n          this.slots.blockUpdated.emit({\n            type: 'update',\n            id,\n            flavour: block.flavour,\n            props: { key },\n          });\n        },\n      };\n\n      const block = new Block(this._schema, yBlock, this, options);\n      this._runQuery(block);\n\n      this._blocks.value = {\n        ...this._blocks.value,\n        [id]: block,\n      };\n      block.model.created.emit();\n\n      if (block.model.role === 'root') {\n        this.slots.rootAdded.emit(id);\n      }\n\n      this.slots.blockUpdated.emit({\n        type: 'add',\n        id,\n        init,\n        flavour: block.model.flavour,\n        model: block.model,\n      });\n    } catch (e) {\n      console.error('An error occurred while adding block:');\n      console.error(e);\n    }\n  }\n\n  private _onBlockRemoved(id: string) {\n    try {\n      const block = this.getBlock(id);\n      if (!block) return;\n\n      if (block.model.role === 'root') {\n        this.slots.rootDeleted.emit(id);\n      }\n\n      this.slots.blockUpdated.emit({\n        type: 'delete',\n        id,\n        flavour: block.model.flavour,\n        parent: this.getParent(block.model)?.id ?? '',\n        model: block.model,\n      });\n\n      const { [id]: _, ...blocks } = this._blocks.peek();\n      this._blocks.value = blocks;\n\n      block.model.deleted.emit();\n      block.model.dispose();\n    } catch (e) {\n      console.error('An error occurred while removing block:');\n      console.error(e);\n    }\n  }\n\n  addBlock<Key extends BlockSuite.Flavour>(\n    flavour: Key,\n    blockProps?: BlockSuite.ModelProps<BlockSuite.BlockModels[Key]>,\n    parent?: BlockModel | string | null,\n    parentIndex?: number\n  ): string;\n\n  addBlock(\n    flavour: never,\n    blockProps?: Partial<BlockProps & Omit<BlockProps, 'flavour'>>,\n    parent?: BlockModel | string | null,\n    parentIndex?: number\n  ): string;\n\n  addBlock(\n    flavour: string,\n    blockProps: Partial<BlockProps & Omit<BlockProps, 'flavour'>> = {},\n    parent?: BlockModel | string | null,\n    parentIndex?: number\n  ): string {\n    if (this.readonly) {\n      throw new BlockSuiteError(\n        ErrorCode.ModelCRUDError,\n        'cannot modify data in readonly mode'\n      );\n    }\n\n    const id = blockProps.id ?? this._blockCollection.generateBlockId();\n\n    this.transact(() => {\n      this._crud.addBlock(\n        id,\n        flavour,\n        { ...blockProps },\n        typeof parent === 'string' ? parent : parent?.id,\n        parentIndex\n      );\n    });\n\n    return id;\n  }\n\n  addBlocks(\n    blocks: Array<{\n      flavour: string;\n      blockProps?: Partial<BlockProps & Omit<BlockProps, 'flavour' | 'id'>>;\n    }>,\n    parent?: BlockModel | string | null,\n    parentIndex?: number\n  ): string[] {\n    const ids: string[] = [];\n    blocks.forEach(block => {\n      const id = this.addBlock(\n        block.flavour as never,\n        block.blockProps ?? {},\n        parent,\n        parentIndex\n      );\n      ids.push(id);\n      typeof parentIndex === 'number' && parentIndex++;\n    });\n\n    return ids;\n  }\n\n  addSiblingBlocks(\n    targetModel: BlockModel,\n    props: Array<Partial<BlockProps>>,\n    place: 'after' | 'before' = 'after'\n  ): string[] {\n    if (!props.length) return [];\n    const parent = this.getParent(targetModel);\n    if (!parent) return [];\n\n    const targetIndex =\n      parent.children.findIndex(({ id }) => id === targetModel.id) ?? 0;\n    const insertIndex = place === 'before' ? targetIndex : targetIndex + 1;\n\n    if (props.length <= 1) {\n      if (!props[0]?.flavour) return [];\n      const { flavour, ...blockProps } = props[0];\n      const id = this.addBlock(\n        flavour as never,\n        blockProps,\n        parent.id,\n        insertIndex\n      );\n      return [id];\n    }\n\n    const blocks: Array<{\n      flavour: string;\n      blockProps: Partial<BlockProps>;\n    }> = [];\n    props.forEach(prop => {\n      const { flavour, ...blockProps } = prop;\n      if (!flavour) return;\n      blocks.push({ flavour, blockProps });\n    });\n    return this.addBlocks(blocks, parent.id, insertIndex);\n  }\n\n  deleteBlock(\n    model: BlockModel,\n    options: {\n      bringChildrenTo?: BlockModel;\n      deleteChildren?: boolean;\n    } = {\n      deleteChildren: true,\n    }\n  ) {\n    if (this.readonly) {\n      console.error('cannot modify data in readonly mode');\n      return;\n    }\n\n    const opts = (\n      options && options.bringChildrenTo\n        ? {\n            ...options,\n            bringChildrenTo: options.bringChildrenTo.id,\n          }\n        : options\n    ) as {\n      bringChildrenTo?: string;\n      deleteChildren?: boolean;\n    };\n\n    this.transact(() => {\n      this._crud.deleteBlock(model.id, opts);\n    });\n  }\n\n  dispose() {\n    this._disposeBlockUpdated.dispose();\n    this.slots.ready.dispose();\n    this.slots.blockUpdated.dispose();\n    this.slots.rootAdded.dispose();\n    this.slots.rootDeleted.dispose();\n  }\n\n  getBlock(id: string): Block | undefined {\n    return this._blocks.peek()[id];\n  }\n\n  getBlock$(id: string): Block | undefined {\n    return this._blocks.value[id];\n  }\n\n  /**\n   * @deprecated\n   * Use `getBlocksByFlavour` instead.\n   */\n  getBlockByFlavour(blockFlavour: string | string[]) {\n    return this.getBlocksByFlavour(blockFlavour).map(x => x.model);\n  }\n\n  /**\n   * @deprecated\n   * Use `getBlock` instead.\n   */\n  getBlockById<Model extends BlockModel = BlockModel>(\n    id: string\n  ): Model | null {\n    return (this.getBlock(id)?.model ?? null) as Model | null;\n  }\n\n  getBlocks() {\n    return Object.values(this._blocks.peek()).map(block => block.model);\n  }\n\n  getBlocksByFlavour(blockFlavour: string | string[]) {\n    const flavours =\n      typeof blockFlavour === 'string' ? [blockFlavour] : blockFlavour;\n\n    return Object.values(this._blocks.peek()).filter(({ flavour }) =>\n      flavours.includes(flavour)\n    );\n  }\n\n  getNext(block: BlockModel | string) {\n    return this._getSiblings(\n      block,\n      (parent, index) => parent.children[index + 1] ?? null\n    );\n  }\n\n  getNexts(block: BlockModel | string) {\n    return (\n      this._getSiblings(block, (parent, index) =>\n        parent.children.slice(index + 1)\n      ) ?? []\n    );\n  }\n\n  getParent(target: BlockModel | string): BlockModel | null {\n    const targetId = typeof target === 'string' ? target : target.id;\n    const parentId = this._crud.getParent(targetId);\n    if (!parentId) return null;\n\n    const parent = this._blocks.peek()[parentId];\n    if (!parent) return null;\n\n    return parent.model;\n  }\n\n  getPrev(block: BlockModel | string) {\n    return this._getSiblings(\n      block,\n      (parent, index) => parent.children[index - 1] ?? null\n    );\n  }\n\n  getPrevs(block: BlockModel | string) {\n    return (\n      this._getSiblings(block, (parent, index) =>\n        parent.children.slice(0, index)\n      ) ?? []\n    );\n  }\n\n  getSchemaByFlavour(flavour: BlockSuite.Flavour) {\n    return this._schema.flavourSchemaMap.get(flavour);\n  }\n\n  hasBlock(id: string) {\n    return id in this._blocks.peek();\n  }\n\n  /**\n   * @deprecated\n   * Use `hasBlock` instead.\n   */\n  hasBlockById(id: string) {\n    return this.hasBlock(id);\n  }\n\n  load(initFn?: () => void) {\n    this._blockCollection.load(initFn);\n    this.slots.ready.emit();\n    return this;\n  }\n\n  moveBlocks(\n    blocksToMove: BlockModel[],\n    newParent: BlockModel,\n    targetSibling: BlockModel | null = null,\n    shouldInsertBeforeSibling = true\n  ) {\n    if (this.readonly) {\n      console.error('Cannot modify data in read-only mode');\n      return;\n    }\n\n    this.transact(() => {\n      this._crud.moveBlocks(\n        blocksToMove.map(model => model.id),\n        newParent.id,\n        targetSibling?.id ?? null,\n        shouldInsertBeforeSibling\n      );\n    });\n  }\n\n  updateBlock<T extends Partial<BlockProps>>(model: BlockModel, props: T): void;\n\n  updateBlock(model: BlockModel, callback: () => void): void;\n\n  updateBlock(\n    model: BlockModel,\n    callBackOrProps: (() => void) | Partial<BlockProps>\n  ): void {\n    if (this.readonly) {\n      console.error('cannot modify data in readonly mode');\n      return;\n    }\n\n    const isCallback = typeof callBackOrProps === 'function';\n\n    if (!isCallback) {\n      const parent = this.getParent(model);\n      this.schema.validate(\n        model.flavour,\n        parent?.flavour,\n        callBackOrProps.children?.map(child => child.flavour)\n      );\n    }\n\n    const yBlock = this._yBlocks.get(model.id);\n    if (!yBlock) {\n      throw new BlockSuiteError(\n        ErrorCode.ModelCRUDError,\n        `updating block: ${model.id} not found`\n      );\n    }\n\n    const block = this.getBlock(model.id);\n    if (!block) return;\n\n    this.transact(() => {\n      if (isCallback) {\n        callBackOrProps();\n        this._runQuery(block);\n        return;\n      }\n\n      if (callBackOrProps.children) {\n        this._crud.updateBlockChildren(\n          model.id,\n          callBackOrProps.children.map(child => child.id)\n        );\n      }\n\n      const schema = this.schema.flavourSchemaMap.get(model.flavour);\n      if (!schema) {\n        throw new BlockSuiteError(\n          ErrorCode.ModelCRUDError,\n          `schema for flavour: ${model.flavour} not found`\n        );\n      }\n      syncBlockProps(schema, model, yBlock, callBackOrProps);\n      this._runQuery(block);\n      return;\n    });\n  }\n}\n"]}