{"version":3,"file":"v-element.js","sourceRoot":"","sources":["../../src/components/v-element.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,EAAE,eAAe,EAAE,SAAS,EAAE,MAAM,+BAA+B,CAAC;AAC3E,OAAO,EAAE,IAAI,EAAE,UAAU,EAAE,OAAO,EAAE,MAAM,KAAK,CAAC;AAChD,OAAO,EAAE,aAAa,EAAE,QAAQ,EAAE,MAAM,mBAAmB,CAAC;AAC5D,OAAO,EAAE,QAAQ,EAAE,MAAM,6BAA6B,CAAC;AAKvD,OAAO,EAAE,gBAAgB,EAAE,MAAM,cAAc,CAAC;AAChD,OAAO,EAAE,yBAAyB,EAAE,MAAM,mBAAmB,CAAC;IAGjD,QAAQ;4BADpB,aAAa,CAAC,WAAW,CAAC;;;;sBAGjB,UAAU;;;;;;;;;;;;;;;;wBAAlB,SAAQ,WAAU;;;;iCAgDjB,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;qCAK1B,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;qCAG9B,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;oCAG9B,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;uCAG9B,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;YAb/B,oKAAS,KAAK,6BAAL,KAAK,qFAEZ;YAGF,gLAAS,SAAS,6BAAT,SAAS,6FAAU;YAG5B,gLAAS,SAAS,6BAAT,SAAS,6FAAU;YAG5B,6KAAS,QAAQ,6BAAR,QAAQ,2FAAkB;YAGnC,sLAAS,WAAW,6BAAX,WAAW,iGAAU;YAjEhC,6KAkEC;;;YAlEY,uDAAQ;;QAGV,gBAAgB;YACvB,OAAO,IAAI,CAAC;QACd,CAAC;QAEQ,MAAM;YACb,MAAM,YAAY,GAAG,yBAAyB,CAAC,IAAI,CAAC,CAAC;YACrD,IAAI,CAAC,YAAY,EAAE,CAAC;gBAClB,OAAO,OAAO,CAAC;YACjB,CAAC;YACD,MAAM,iBAAiB,GAAG,YAAY,CAAC,gBAAgB,CAAC,iBAAiB,CAAC;YAC1E,MAAM,WAAW,GAA4C;gBAC3D,KAAK,EAAE,IAAI,CAAC,KAAK;gBACjB,QAAQ,EAAE,IAAI,CAAC,QAAQ;gBACvB,WAAW,EAAE,IAAI,CAAC,WAAW;gBAC7B,SAAS,EAAE,IAAI,CAAC,SAAS;gBACzB,SAAS,EAAE,IAAI,CAAC,SAAS;gBACzB,MAAM,EAAE,YAAY;aACrB,CAAC;YAEF,MAAM,OAAO,GAAG,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACjD,IAAI,OAAO,EAAE,CAAC;gBACZ,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;oBACnC,MAAM,IAAI,eAAe,CACvB,SAAS,CAAC,iBAAiB,EAC3B;;;wBAGc,CACf,CAAC;gBACJ,CAAC;gBAED,OAAO,IAAI,CAAA;;;;gBAID,QAAQ,CAAC,EAAE,UAAU,EAAE,MAAM,EAAE,CAAC;WACrC,iBAAiB,CAAC,WAAW,CAAC;QACjC,CAAC;YACL,CAAC;YAED,8EAA8E;YAC9E,6BAA6B;YAC7B,OAAO,IAAI,CAAA;SACN,iBAAiB,CAAC,WAAW,CAAC;MACjC,CAAC;QACL,CAAC;QAGD,uEAAiC;YAC/B,MAAM,EAAE,gBAAgB;SACzB,EAAC;QAFF,IAAS,KAAK,2CAEZ;QAFF,IAAS,KAAK,iDAEZ;QAGF,4IAA4B;QAA5B,IAAS,SAAS,+CAAU;QAA5B,IAAS,SAAS,qDAAU;QAG5B,gJAA4B;QAA5B,IAAS,SAAS,+CAAU;QAA5B,IAAS,SAAS,qDAAU;QAG5B,qIAA6B,KAAK,GAAC;QAAnC,IAAS,QAAQ,8CAAkB;QAAnC,IAAS,QAAQ,oDAAkB;QAGnC,mJAA8B;QAA9B,IAAS,WAAW,iDAAU;QAA9B,IAAS,WAAW,uDAAU;;;;;;;;SAjEnB,QAAQ","sourcesContent":["import { BlockSuiteError, ErrorCode } from '@blocksuite/global/exceptions';\nimport { html, LitElement, nothing } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\nimport { styleMap } from 'lit/directives/style-map.js';\n\nimport type { DeltaInsert } from '../types.js';\nimport type { BaseTextAttributes } from '../utils/base-attributes.js';\n\nimport { ZERO_WIDTH_SPACE } from '../consts.js';\nimport { getInlineEditorInsideRoot } from '../utils/query.js';\n\n@customElement('v-element')\nexport class VElement<\n  T extends BaseTextAttributes = BaseTextAttributes,\n> extends LitElement {\n  override createRenderRoot() {\n    return this;\n  }\n\n  override render() {\n    const inlineEditor = getInlineEditorInsideRoot(this);\n    if (!inlineEditor) {\n      return nothing;\n    }\n    const attributeRenderer = inlineEditor.attributeService.attributeRenderer;\n    const renderProps: Parameters<typeof attributeRenderer>[0] = {\n      delta: this.delta,\n      selected: this.selected,\n      startOffset: this.startOffset,\n      endOffset: this.endOffset,\n      lineIndex: this.lineIndex,\n      editor: inlineEditor,\n    };\n\n    const isEmbed = inlineEditor.isEmbed(this.delta);\n    if (isEmbed) {\n      if (this.delta.insert.length !== 1) {\n        throw new BlockSuiteError(\n          ErrorCode.InlineEditorError,\n          `The length of embed node should only be 1.\n          This seems to be an internal issue with inline editor.\n          Please go to https://github.com/toeverything/blocksuite/issues\n          to report it.`\n        );\n      }\n\n      return html`<span\n        data-v-embed=\"true\"\n        data-v-element=\"true\"\n        contenteditable=\"false\"\n        style=${styleMap({ userSelect: 'none' })}\n        >${attributeRenderer(renderProps)}</span\n      >`;\n    }\n\n    // we need to avoid \\n appearing before and after the span element, which will\n    // cause the unexpected space\n    return html`<span data-v-element=\"true\"\n      >${attributeRenderer(renderProps)}</span\n    >`;\n  }\n\n  @property({ type: Object })\n  accessor delta: DeltaInsert<T> = {\n    insert: ZERO_WIDTH_SPACE,\n  };\n\n  @property({ attribute: false })\n  accessor endOffset!: number;\n\n  @property({ attribute: false })\n  accessor lineIndex!: number;\n\n  @property({ attribute: false })\n  accessor selected: boolean = false;\n\n  @property({ attribute: false })\n  accessor startOffset!: number;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'v-element': VElement;\n  }\n}\n"]}