{"version":3,"file":"gfx.js","sourceRoot":"","sources":["../../src/utils/gfx.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,MAAM,EAAE,MAAM,0BAA0B,CAAC;AAElD,OAAO,EAAE,iBAAiB,EAAE,MAAM,iCAAiC,CAAC;AAEpE,MAAM,UAAU,cAAc,CAC5B,GAAQ,EACR,QAAmD;IAEnD,IAAI,KAAK,GAAG,KAAK,CAAC;IAClB,IAAI,OAAO,GAAG,EAAE,CAAC;IAEjB,MAAM,OAAO,GAAG,MAAM,CAAC,GAAG,EAAE;QAC1B,2DAA2D;QAC3D,IAAI,KAAK,IAAI,GAAG,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC;YACnC,OAAO;QACT,CAAC;QAED,KAAK,MAAM,KAAK,IAAI,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE,CAAC;YACpD,IAAI,KAAK,CAAC,KAAK,YAAY,iBAAiB,EAAE,CAAC;gBAC7C,QAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;gBACtB,KAAK,GAAG,IAAI,CAAC;gBACb,OAAO,GAAG,KAAK,CAAC,EAAE,CAAC;gBACnB,OAAO;YACT,CAAC;QACH,CAAC;QAED,QAAQ,CAAC,IAAI,CAAC,CAAC;IACjB,CAAC,CAAC,CAAC;IAEH,OAAO,OAAO,CAAC;AACjB,CAAC","sourcesContent":["import type { Doc } from '@blocksuite/store';\n\nimport { effect } from '@lit-labs/preact-signals';\n\nimport { SurfaceBlockModel } from '../gfx/surface/surface-model.js';\n\nexport function onSurfaceAdded(\n  doc: Doc,\n  callback: (model: SurfaceBlockModel | null) => void\n) {\n  let found = false;\n  let foundId = '';\n\n  const dispose = effect(() => {\n    // if the surface is already found, no need to search again\n    if (found && doc.getBlock(foundId)) {\n      return;\n    }\n\n    for (const block of Object.values(doc.blocks.value)) {\n      if (block.model instanceof SurfaceBlockModel) {\n        callback(block.model);\n        found = true;\n        foundId = block.id;\n        return;\n      }\n    }\n\n    callback(null);\n  });\n\n  return dispose;\n}\n"]}